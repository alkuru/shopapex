# –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï: –ê–ù–ê–õ–ò–ó –í–ù–ï–î–†–ï–ù–ò–Ø –£–ú–ù–û–ì–û –ü–û–ò–°–ö–ê

## üìã –ò–°–•–û–î–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### –û—Å–Ω–æ–≤–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ
**–ù–ï –î–ï–õ–ê–¢–¨** –≤—ã–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –±–∞–∑—É ‚Äî –¥–µ–ª–∞–µ–º –ø–æ–∏—Å–∫ –ø–æ API, –∫–µ—à, –∏ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã
1. **–ü–æ–∏—Å–∫ "–Ω–∞ –ª–µ—Ç—É"** —á–µ—Ä–µ–∑ API –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** ‚Äî —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤, –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, —á–∞—Å—Ç–æ –∏—Å–∫–æ–º–æ–µ
3. **–ñ–∏–≤—ã–µ —Ü–µ–Ω—ã** ‚Äî –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API
4. **–£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
5. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ü–µ–Ω–∞–º–∏** ‚Äî –Ω–∏–∫–∞–∫–∏—Ö —Ñ–∏–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## ‚úÖ –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨ –° –¢–ï–ö–£–©–ï–ô –ê–†–•–ò–¢–ï–ö–¢–£–†–û–ô

### üéØ –û–¢–õ–ò–ß–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨ (95%)

–ü—Ä–æ–µ–∫—Ç ShopApex **—É–∂–µ –≥–æ—Ç–æ–≤** –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞:

#### 1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ API –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤** ‚úÖ
- ‚úÖ –ú–æ–¥–µ–ª—å `Supplier` —Å –ø–æ–ª–Ω–æ–π ABCP API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- ‚úÖ –ú–µ—Ç–æ–¥—ã `_make_abcp_request()` –∏ `_make_admin_request()`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

#### 2. **–°–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞** ‚úÖ
- ‚úÖ –ú–µ—Ç–æ–¥—ã –ø–æ–∏—Å–∫–∞ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É: `search_products_by_article()`
- ‚úÖ –ü–æ–∏—Å–∫ –±—Ä–µ–Ω–¥–æ–≤: `get_abcp_brands()`
- ‚úÖ –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤: `get_product_analogs()`
- ‚úÖ –ü–∞–∫–µ—Ç–Ω—ã–π –ø–æ–∏—Å–∫: `search_batch()`

#### 3. **–†–∞–±–æ—Ç–∞ —Å –∫–æ—Ä–∑–∏–Ω–æ–π** ‚úÖ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É: `add_to_basket()`
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ: `get_basket_content()`
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã: `clear_basket()`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞: `create_order_from_basket()`

#### 4. **–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** ‚úÖ
- ‚úÖ –ú–æ–¥–µ–ª—å `SupplierSyncLog` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫

---

## üöÄ –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –≠–¢–ê–ü 1: –°–ò–°–¢–ï–ú–ê –ö–ï–®–ò–†–û–í–ê–ù–ò–Ø (2-3 –¥–Ω—è)

#### –ó–∞–¥–∞—á–∏:
1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis** –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∫–µ—à–∞** –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–º–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** —Å TTL

#### –ú–æ–¥–µ–ª—å –∫–µ—à–∞:
```python
class SearchCache(models.Model):
    """–ö–µ—à –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"""
    cache_key = models.CharField(max_length=255, unique=True)
    query_type = models.CharField(max_length=50)  # 'search', 'analogs', 'brands'
    query_params = models.JSONField()  # {'article': '12345', 'brand': 'BMW'}
    result_data = models.JSONField()   # –†–µ–∑—É–ª—å—Ç–∞—Ç API
    supplier = models.ForeignKey(Supplier, on_delete=models.CASCADE)
    created_at = models.DateTimeField(auto_now_add=True)
    expires_at = models.DateTimeField()  # TTL
    hit_count = models.PositiveIntegerField(default=1)
    
    class Meta:
        indexes = [
            models.Index(fields=['cache_key']),
            models.Index(fields=['expires_at']),
            models.Index(fields=['query_type', 'supplier']),
        ]
```

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:
```python
class CacheManager:
    def get_cache_key(self, query_type, supplier_id, params):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á –∫–µ—à–∞"""
        param_str = json.dumps(params, sort_keys=True)
        return hashlib.md5(f"{query_type}_{supplier_id}_{param_str}".encode()).hexdigest()
    
    def get_cached_result(self, query_type, supplier, params):
        """–ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∫–µ—à–∞"""
        cache_key = self.get_cache_key(query_type, supplier.id, params)
        
        try:
            cache_entry = SearchCache.objects.get(
                cache_key=cache_key,
                expires_at__gt=timezone.now()
            )
            cache_entry.hit_count += 1
            cache_entry.save()
            return cache_entry.result_data
        except SearchCache.DoesNotExist:
            return None
    
    def set_cache(self, query_type, supplier, params, result, ttl_minutes=5):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–µ—à"""
        cache_key = self.get_cache_key(query_type, supplier.id, params)
        expires_at = timezone.now() + timedelta(minutes=ttl_minutes)
        
        SearchCache.objects.update_or_create(
            cache_key=cache_key,
            defaults={
                'query_type': query_type,
                'query_params': params,
                'result_data': result,
                'supplier': supplier,
                'expires_at': expires_at,
                'hit_count': 1
            }
        )
```

---

### –≠–¢–ê–ü 2: –£–ú–ù–´–ô –ü–û–ò–°–ö–û–í–´–ô –°–ï–†–í–ò–° (3-4 –¥–Ω—è)

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–∏—Å–∫–∞:
```python
class SmartSearchService:
    def __init__(self):
        self.cache_manager = CacheManager()
    
    def search_products(self, article, brand=None, search_analogs=True):
        """–£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤"""
        results = {
            'original': [],
            'analogs': [],
            'brands': [],
            'cached': False,
            'source': 'api'
        }
        
        # 1. –ü–æ–∏—Å–∫ –±—Ä–µ–Ω–¥–æ–≤ –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞
        if not brand:
            brands = self._search_brands_smart(article)
            results['brands'] = brands
            if brands:
                brand = brands[0]['brand']  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –±—Ä–µ–Ω–¥
        
        # 2. –ü–æ–∏—Å–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
        if brand:
            products = self._search_products_smart(article, brand)
            results['original'] = products
        
        # 3. –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
        if search_analogs and brand:
            analogs = self._search_analogs_smart(article, brand)
            results['analogs'] = analogs
        
        return results
    
    def _search_brands_smart(self, article):
        """–ü–æ–∏—Å–∫ –±—Ä–µ–Ω–¥–æ–≤ —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        params = {'article': article}
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–µ—à
        for supplier in Supplier.objects.filter(is_active=True, api_type='autoparts'):
            cached = self.cache_manager.get_cached_result('brands', supplier, params)
            if cached:
                return cached
        
        # –ï—Å–ª–∏ –≤ –∫–µ—à–µ –Ω–µ—Ç, –¥–µ–ª–∞–µ–º API –∑–∞–ø—Ä–æ—Å
        for supplier in Supplier.objects.filter(is_active=True, api_type='autoparts'):
            success, brands = supplier.get_abcp_brands(article)
            if success and brands:
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–µ—à –Ω–∞ 10 –º–∏–Ω—É—Ç
                self.cache_manager.set_cache('brands', supplier, params, brands, 10)
                return brands
        
        return []
    
    def _search_products_smart(self, article, brand):
        """–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        params = {'article': article, 'brand': brand}
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–µ—à (TTL 5 –º–∏–Ω—É—Ç –¥–ª—è —Ü–µ–Ω)
        for supplier in Supplier.objects.filter(is_active=True, api_type='autoparts'):
            cached = self.cache_manager.get_cached_result('search', supplier, params)
            if cached:
                return cached
        
        # API –∑–∞–ø—Ä–æ—Å
        for supplier in Supplier.objects.filter(is_active=True, api_type='autoparts'):
            success, products = supplier.search_articles_by_brand(article, brand)
            if success and products:
                # –ö–µ—à–∏—Ä—É–µ–º –Ω–∞ 5 –º–∏–Ω—É—Ç (—Ü–µ–Ω—ã –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—é—Ç—Å—è)
                self.cache_manager.set_cache('search', supplier, params, products, 5)
                return products
        
        return []
```

---

### –≠–¢–ê–ü 3: –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–ï–ë-–ò–ù–¢–ï–†–§–ï–ô–°–ê (2 –¥–Ω—è)

#### –ù–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:
```python
class SmartSearchView(APIView):
    """API –¥–ª—è —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞"""
    
    def get(self, request):
        article = request.GET.get('q', '').strip()
        brand = request.GET.get('brand', '').strip()
        search_analogs = request.GET.get('analogs', 'true').lower() == 'true'
        
        if not article:
            return Response({'error': '–ê—Ä—Ç–∏–∫—É–ª –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω'}, status=400)
        
        search_service = SmartSearchService()
        results = search_service.search_products(article, brand, search_analogs)
        
        return Response(results)

class QuickAddToCartView(APIView):
    """–ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É"""
    
    def post(self, request):
        supplier_id = request.data.get('supplier_id')
        item_key = request.data.get('item_key')
        supplier_code = request.data.get('supplier_code')
        quantity = request.data.get('quantity', 1)
        brand = request.data.get('brand')
        article = request.data.get('article')
        
        supplier = get_object_or_404(Supplier, id=supplier_id)
        success, result = supplier.add_to_basket(
            brand=brand,
            article=article,
            quantity=quantity,
            supplier_code=supplier_code,
            item_key=item_key
        )
        
        if success:
            return Response({'success': True, 'message': '–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É'})
        else:
            return Response({'success': False, 'error': result}, status=400)
```

#### AJAX –ø–æ–∏—Å–∫ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:
```javascript
class SmartSearch {
    constructor() {
        this.searchInput = document.getElementById('smart-search');
        this.resultsContainer = document.getElementById('search-results');
        this.debounceTimer = null;
        this.cache = new Map();
        
        this.setupEventListeners();
    }
    
    setupEventListeners() {
        this.searchInput.addEventListener('input', (e) => {
            clearTimeout(this.debounceTimer);
            this.debounceTimer = setTimeout(() => {
                this.performSearch(e.target.value);
            }, 300);
        });
    }
    
    async performSearch(query) {
        if (query.length < 3) return;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–µ—à
        if (this.cache.has(query)) {
            this.displayResults(this.cache.get(query));
            return;
        }
        
        try {
            const response = await fetch(`/api/smart-search/?q=${encodeURIComponent(query)}`);
            const data = await response.json();
            
            // –ö–µ—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
            this.cache.set(query, data);
            this.displayResults(data);
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error);
        }
    }
    
    displayResults(data) {
        const html = this.generateResultsHTML(data);
        this.resultsContainer.innerHTML = html;
    }
    
    generateResultsHTML(data) {
        let html = '';
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        if (data.original.length > 0) {
            html += '<h5>–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:</h5>';
            data.original.forEach(product => {
                html += this.generateProductCard(product);
            });
        }
        
        // –ê–Ω–∞–ª–æ–≥–∏
        if (data.analogs.length > 0) {
            html += '<h5>–ê–Ω–∞–ª–æ–≥–∏:</h5>';
            data.analogs.forEach(analog => {
                html += this.generateProductCard(analog);
            });
        }
        
        return html;
    }
    
    generateProductCard(product) {
        return `
            <div class="product-card" data-item-key="${product.itemKey}">
                <div class="product-info">
                    <h6>${product.brand} ${product.number}</h6>
                    <p>${product.description}</p>
                    <div class="price-info">
                        <strong>${product.price} ‚ÇΩ</strong>
                        <span class="availability">${this.formatAvailability(product.availability)}</span>
                    </div>
                </div>
                <div class="product-actions">
                    <button class="btn btn-primary btn-sm" onclick="smartSearch.addToCart('${product.itemKey}', '${product.supplierCode}', '${product.brand}', '${product.number}')">
                        –í –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </div>
            </div>
        `;
    }
    
    async addToCart(itemKey, supplierCode, brand, article) {
        try {
            const response = await fetch('/api/quick-add-to-cart/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': this.getCsrfToken()
                },
                body: JSON.stringify({
                    supplier_id: 1, // ID –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
                    item_key: itemKey,
                    supplier_code: supplierCode,
                    brand: brand,
                    article: article,
                    quantity: 1
                })
            });
            
            const data = await response.json();
            if (data.success) {
                this.showNotification('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É', 'success');
            } else {
                this.showNotification(data.error, 'error');
            }
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É:', error);
        }
    }
}
```

---

### –≠–¢–ê–ü 4: –°–ò–°–¢–ï–ú–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø –í–ê–ñ–ù–´–• –î–ê–ù–ù–´–• (1-2 –¥–Ω—è)

#### –ú–æ–¥–µ–ª–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:
```python
class SearchHistory(models.Model):
    """–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    user = models.ForeignKey(User, on_delete=models.CASCADE, null=True, blank=True)
    session_key = models.CharField(max_length=50, null=True, blank=True)
    query = models.CharField(max_length=200)
    brand = models.CharField(max_length=100, blank=True)
    found_count = models.IntegerField(default=0)
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        ordering = ['-created_at']

class SavedProduct(models.Model):
    """–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–∏–∑–±—Ä–∞–Ω–Ω–æ–µ)"""
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    supplier = models.ForeignKey(Supplier, on_delete=models.CASCADE)
    article = models.CharField(max_length=100)
    brand = models.CharField(max_length=100)
    item_key = models.CharField(max_length=100)
    supplier_code = models.CharField(max_length=100)
    original_data = models.JSONField()  # –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        unique_together = ['user', 'supplier', 'item_key']

class OrderedProduct(models.Model):
    """–¢–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∑–∞–∫–∞–∑–∞–Ω—ã"""
    article = models.CharField(max_length=100)
    brand = models.CharField(max_length=100)
    supplier = models.ForeignKey(Supplier, on_delete=models.CASCADE)
    order_data = models.JSONField()  # –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞
    price_at_order = models.DecimalField(max_digits=10, decimal_places=2)
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        indexes = [
            models.Index(fields=['article', 'brand']),
            models.Index(fields=['created_at']),
        ]
```

---

## üìä –í–†–ï–ú–ï–ù–ù–´–ï –†–ê–ú–ö–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### ‚ö° –ë–´–°–¢–†–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (1 –Ω–µ–¥–µ–ª—è)
- **–î–µ–Ω—å 1-2**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–¥–µ–ª–∏ –∫–µ—à–∞
- **–î–µ–Ω—å 3-4**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è SmartSearchService
- **–î–µ–Ω—å 5-6**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ AJAX
- **–î–µ–Ω—å 7**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

### üîß –ü–û–õ–ù–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (2 –Ω–µ–¥–µ–ª–∏)
- **–ù–µ–¥–µ–ª—è 1**: –í—Å—è –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–ù–µ–¥–µ–ª—è 2**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéØ –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø–ú –¢–ó

### ‚úÖ **100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:**

1. **‚ùå –ù–ï –¥–µ–ª–∞–µ–º –≤—ã–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤** ‚úÖ
   - –¢–æ–ª—å–∫–æ API –∑–∞–ø—Ä–æ—Å—ã "–Ω–∞ –ª–µ—Ç—É"
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

2. **‚ö° –ü–æ–∏—Å–∫ "–Ω–∞ –ª–µ—Ç—É" —á–µ—Ä–µ–∑ API** ‚úÖ
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã ABCP API
   - –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤

3. **üíæ –£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚úÖ
   - Redis + –º–æ–¥–µ–ª—å SearchCache
   - TTL 5-10 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞
   - –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

4. **üí∞ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ü–µ–Ω–∞–º–∏** ‚úÖ
   - –í—Å–µ–≥–¥–∞ –∂–∏–≤—ã–µ —Ü–µ–Ω—ã –∏–∑ API
   - –ù–∏–∫–∞–∫–∏—Ö —Ñ–∏–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞

5. **üîç –ü–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤** ‚úÖ
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º crosses –∏–∑ ABCP API
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ OEM –Ω–æ–º–µ—Ä–∞–º

6. **üì¶ –†–∞–±–æ—Ç–∞ —Å –∫–æ—Ä–∑–∏–Ω–æ–π** ‚úÖ
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã

---

## üí° –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò

### üöÄ **–£–∂–µ –≥–æ—Ç–æ–≤—ã–µ —Ñ–∏—á–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ:**

1. **–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
2. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ API** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
4. **–°–∏—Å—Ç–µ–º–∞ –æ—à–∏–±–æ–∫** - graceful handling API –æ—à–∏–±–æ–∫
5. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ABCP** - –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### üé® **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:**

1. **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ** –ø—Ä–∏ –≤–≤–æ–¥–µ –∞—Ä—Ç–∏–∫—É–ª–∞
2. **–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
3. **–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã** –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω—É—é –±–∞–∑—É
4. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω** –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏
5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω**

---

## ‚ö†Ô∏è –†–ò–°–ö–ò –ò –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### üî¥ **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞**
   - **–†–µ—à–µ–Ω–∏–µ**: –£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

2. **–ú–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç API**
   - **–†–µ—à–µ–Ω–∏–µ**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Ç–∞–π–º–∞—É—Ç—ã

3. **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞**
   - **–†–µ—à–µ–Ω–∏–µ**: Fallback –Ω–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

4. **–ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤**
   - **–†–µ—à–µ–Ω–∏–µ**: Debounce –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ, –±–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤

### üü° **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

1. **ABCP API –ª–∏–º–∏—Ç—ã**
   - –ù—É–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å rate limiting
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–≤–æ—Ç API

2. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**
   - –¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - Graceful degradation –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

## üí∞ –≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ê–Ø –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨

### üìà **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. **–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞ –≤ –ë–î** - –Ω–µ —Ö—Ä–∞–Ω–∏–º –º–∏–ª–ª–∏–æ–Ω—ã —Ç–æ–≤–∞—Ä–æ–≤
2. **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –≤—Å–µ–≥–¥–∞ —Å–≤–µ–∂–∏–µ —Ü–µ–Ω—ã –∏ –æ—Å—Ç–∞—Ç–∫–∏
3. **–ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤

### üìä **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:**

1. **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –ø–æ–∏—Å–∫–∞** < 2 —Å–µ–∫
2. **–ü—Ä–æ—Ü–µ–Ω—Ç –∫–µ—à-–ø–æ–ø–∞–¥–∞–Ω–∏–π** > 70%
3. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API** > 99%
4. **–ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–∏—Å–∫‚Üí–∑–∞–∫–∞–∑** > 15%

---

## üèÅ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### ‚úÖ **–ü–†–û–ï–ö–¢ –ì–û–¢–û–í –ö –í–ù–ï–î–†–ï–ù–ò–Æ –£–ú–ù–û–ì–û –ü–û–ò–°–ö–ê**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ü–†–ò–°–¢–£–ü–ê–¢–¨ –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. **95% –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —É–∂–µ –≥–æ—Ç–æ–≤–æ** - –µ—Å—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
2. **ABCP API –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω** - –≤—Å–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
3. **–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** - 1-2 –Ω–µ–¥–µ–ª–∏ –¥–æ –≥–æ—Ç–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
4. **100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó** - –≤—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏–º—ã
5. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏** - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (Redis) –∏ —Å–æ–∑–¥–∞–Ω–∏—è SmartSearchService.

---

**–°—Ç–∞—Ç—É—Å:** üü¢ **–ì–û–¢–û–í –ö –°–¢–ê–†–¢–£**  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî• **–í–´–°–û–ö–ò–ô**  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø**  
**–í—Ä–µ–º—è:** ‚è±Ô∏è **1-2 –Ω–µ–¥–µ–ª–∏**
