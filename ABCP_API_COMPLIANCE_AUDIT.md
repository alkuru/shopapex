# –ü–û–õ–ù–´–ô –ê–£–î–ò–¢ –°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø ABCP API

## üîç –ê–ù–ê–õ–ò–ó –°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò

**–î–∞—Ç–∞:** 9 –∏—é–ª—è 2025 –≥.  
**–ü—Ä–æ–µ–∫—Ç:** ShopApex - Django –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∞–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–µ–π  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** ABCP.API.txt –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## ‚úÖ –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –û–°–ù–û–í–ù–´–• –ú–ï–¢–û–î–û–í API

### 1. –ü–æ–∏—Å–∫ –±—Ä–µ–Ω–¥–æ–≤ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É
**API –º–µ—Ç–æ–¥:** `search/brands`  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚úÖ –ü–û–õ–ù–û–ï –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï  

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –º–æ–¥–µ–ª–∏ Supplier:**
```python
def get_abcp_brands(self, number=None):
    brands_url = f"{self.api_url.rstrip('/')}/search/brands"
    params = {
        'userlogin': self.api_login,
        'userpsw': password_hash,
        'number': number.strip()  # –ê—Ä—Ç–∏–∫—É–ª
    }
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- ‚úÖ `userlogin` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `userpsw` - md5-—Ö—ç—à –ø–∞—Ä–æ–ª—è  
- ‚úÖ `number` - –∏—Å–∫–æ–º—ã–π –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏
- ‚ö†Ô∏è `useOnlineStocks` - —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ö†Ô∏è `officeId` - —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ùå `locale` - –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù

### 2. –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É –∏ –±—Ä–µ–Ω–¥—É
**API –º–µ—Ç–æ–¥:** `search/articles`  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚úÖ –•–û–†–û–®–ï–ï –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –º–æ–¥–µ–ª–∏ Supplier:**
```python
def _search_articles_by_brand(self, article, brand):
    search_url = f"{self.api_url.rstrip('/')}/search/articles"
    params = {
        'userlogin': self.api_login,
        'userpsw': password_hash,
        'number': article.strip(),
        'brand': brand.strip()
    }
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- ‚úÖ `userlogin` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `userpsw` - md5-—Ö—ç—à –ø–∞—Ä–æ–ª—è
- ‚úÖ `number` - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏
- ‚úÖ `brand` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—é
- ‚ö†Ô∏è `useOnlineStocks` - —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ùå `disableOnlineFiltering` - –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù
- ‚ùå `disableFiltering` - –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù
- ‚ùå `withOutAnalogs` - –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù
- ‚ùå `profileId` - –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù
- ‚ö†Ô∏è `officeId` - —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–´ –ò –ù–ï–°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø

### 1. –ú–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤
**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:** –í ProductAnalogsView –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ API

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
success, result = supplier.get_product_analogs(
    article=article,
    brand=brand,
    limit=limit
)
```

**–ü–†–û–ë–õ–ï–ú–ê:** –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ABCP API –ù–ï–¢ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤!

**–†–ï–®–ï–ù–ò–ï:** –ê–Ω–∞–ª–æ–≥–∏ –ø–æ–ª—É—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–∏—Å–∫ `search/articles` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `withOutAnalogs=0` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤
**–¢–µ–∫—É—â–∏–π –º–µ—Ç–æ–¥ `get_product_analogs`:**
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `search/brands` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ API
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API

**–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `search/articles` —Å `withOutAnalogs=0`
2. –û–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –ø–æ–ª—É—á–∞—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–æ–≤–∞—Ä–∞ –≤–∫–ª—é—á–∞—è –∞–Ω–∞–ª–æ–≥–∏
3. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:**
- `withOutAnalogs` - –∫–ª—é—á–µ–≤–æ–π –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤
- `disableFiltering` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `profileId` - –¥–ª—è —Ü–µ–Ω–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏
- `locale` - –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ API
**–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–ª—è –æ—Ç–≤–µ—Ç–∞ `search/articles`:**
```json
{
    "brand": "Febi",
    "articleCode": "01089",           // –ù–ï "article"!
    "articleCodeFix": "01089",        // –ù–ï "article_fix"!
    "articleId": "37367",
    "description": "–ê–Ω—Ç–∏—Ñ—Ä–∏–∑ 1.5 –ª —Å–∏–Ω–∏–π",
    "availability": "1943",
    "deliveryPeriod": 3,
    "price": 233,
    "weight": "1.76"
}
```

**–ü–†–û–ë–õ–ï–ú–ê –≤ –∫–æ–¥–µ:**
```python
analog = {
    'article': product.get('articleCode', article_code),      # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
    'article_fix': product.get('articleCodeFix', article_code), # ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–õ–ï
    'brand': product.get('brand', brand_name),                # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
    'name': product.get('description', ''),                  # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
    'price': product.get('price', 0),                        # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
}
```

---

## üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤
```python
def get_product_analogs(self, article, brand=None, limit=20):
    """–ü–†–ê–í–ò–õ–¨–ù–ê–Ø —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ search/articles"""
    
    params = {
        'userlogin': self.api_login,
        'userpsw': password_hash,
        'number': article.strip(),
        'withOutAnalogs': 0,  # –í–ö–õ–Æ–ß–ò–¢–¨ –ø–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤
        'disableFiltering': 1,  # –ü–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        'useOnlineStocks': 1 if self.use_online_stocks else 0
    }
    
    if brand:
        params['brand'] = brand.strip()
    
    # –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö
    response = requests.get(f"{self.api_url}/search/articles", params=params)
```

### 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å ProductAnalogsView
```python
class ProductAnalogsView(APIView):
    def get(self, request, article):
        # –£–ë–†–ê–¢–¨ –≤—ã–∑–æ–≤ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–µ—Ç–æ–¥–∞ get_product_analogs
        # –ó–ê–ú–ï–ù–ò–¢–¨ –Ω–∞ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ search_products_by_article
        
        for supplier in suppliers:
            success, result = supplier.search_products_by_article(
                article=article,
                brand=brand
                # withOutAnalogs –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ = 0 (–∞–Ω–∞–ª–æ–≥–∏ –≤–∫–ª—é—á–µ–Ω—ã)
            )
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```python
# –í –º–æ–¥–µ–ª—å Supplier –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è:
class Supplier(models.Model):
    # ...existing fields...
    locale = models.CharField(max_length=10, default='ru_RU', verbose_name='–õ–æ–∫–∞–ª—å')
    disable_filtering = models.BooleanField(default=False, verbose_name='–û—Ç–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é')
    profile_id = models.CharField(max_length=50, blank=True, verbose_name='ID –ø—Ä–æ—Ñ–∏–ª—è')
```

---

## üìä –û–¶–ï–ù–ö–ê –¢–ï–ö–£–©–ï–ì–û –°–û–°–¢–û–Ø–ù–ò–Ø

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. –ë–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (userlogin, userpsw —Å md5)
2. –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã search/brands –∏ search/articles
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
4. MD5 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
5. Timeout –∏ exception handling

### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏:
1. –ú–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤ (–∫—Ä–∏—Ç–∏—á–Ω–æ)
2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã API
3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞
4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:
1. **–ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π API –º–µ—Ç–æ–¥ –∞–Ω–∞–ª–æ–≥–æ–≤** - –º–µ—Ç–æ–¥ `get_product_analogs` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
2. **ProductAnalogsView –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω** - –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
3. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ API –∑–∞–ø—Ä–æ—Å—ã** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û):
1. ‚ùó –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –º–µ—Ç–æ–¥ `get_product_analogs` —Å–æ–≥–ª–∞—Å–Ω–æ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. ‚ùó –ò—Å–ø—Ä–∞–≤–∏—Ç—å `ProductAnalogsView` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
3. ‚ùó –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `withOutAnalogs=0` –≤ –ø–æ–∏—Å–∫

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û):
1. –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `disableFiltering`, `profileId`, `locale`
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ API –∑–∞–ø—Ä–æ—Å–æ–≤
3. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û):
1. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ API
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å batch-–∑–∞–ø—Ä–æ—Å—ã
3. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üö® –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–°–¢–ê–¢–£–°:** ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –°–û–í–ú–ï–°–¢–ò–ú  
**–ö–†–ò–¢–ò–ß–ù–û–°–¢–¨:** üî¥ –í–´–°–û–ö–ê–Ø

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ **–ø–æ–∏—Å–∫ –∞–Ω–∞–ª–æ–≥–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ABCP API. –¢—Ä–µ–±—É—é—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –∞–Ω–∞–ª–æ–≥–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ABCP API.
