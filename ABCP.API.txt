API:Docs
Статья Обсуждение
Главная > API:Docs
vertical-align:middle;
Внимание!
Данная статья предназначена для технических специалистов, обладающих, как минимум, начальными знаниями о принципах работы протокола HTTPS. Консультации по вопросам относящимся к стандартам HTTPS осуществляться не будут.
Содержание
Общая информация
Веб-сервис - это "шлюз", через который одна программа может обращаться к другой для получения (или передачи) нужной информации. Веб-сервис включает в себя список функций, посредством которых можно отправлять запросы (набор таких функций обычно называют термином API (application programming interface). Удобство веб-сервиса в том, что он доступен в интернете.

Как можно это использовать? Например, один сайт может обращаться к другому для получения информации о наличии товаров. Или программа 1С может обратиться к веб-сервису с таким же запросом. Или же 1С (или интернет-магазин) может обратиться к веб-сервису поставщику с целью автоматической отправки заказа поставщику.

Доступ к публичному API осуществляется посредством HTTPS-запросов и реализован с использованием принципов REST.

URL для веб-службы (адрес хоста) следует уточнять у менеджеров
Обмен осуществляется в кодировке UTF-8.

Для отладки вы можете воспользоваться расширением Advanced REST Client для обозревателя Google Chrome.

Запрос
Запросы на получение и запись данных осуществляются с помощью HTTPS-методов GET и POST соответственно. В структуре сервиса имеется понятие операции. Операция указывается в качестве пути в URL. Параметры передаются как строка запроса HTTPS (GET) или данными POST. Большая часть операций исполняется от имени конкретного пользователя и требует идентификации с помощью параметров userlogin (имя пользователя в системе) и userpsw (md5-хэш пароля пользователя). Md5-хэш можно сгенерировать выполнением функции (большая часть языков программирования имеет данную функцию в своем арсенале), либо воспользоваться online-генератором (например, md5-online.ru).

Внимание! При включенной опции "Франчайзи: разрешить одинаковые логины у разных франчайзи" могут присутствовать клиенты с одинаковым email и номером мобильного телефона. В этом случае в качестве имени нужно использовать код клиента (id).

Параметр shipmentAddress становится обязательным для заполнения. Получить идентификатор адреса доставки можно с помощью операции basket/shipmentAddresses, если она не возвращает никаких значений, то shipmentAddress - является необязательным параметром. Если не используете доставку на адрес, а пользуетесь самовывозом, то необходимо передать shipmentAddress=0.

Каждая операция может иметь список дополнительных параметров, определяемых контекстом операции. Например, вызов операции "Поиск детали по номеру" может выглядеть следующим образом:

https://demo.public.api.abcp.ru/search/articles/?userlogin=username&userpsw=md5pass&number=01089&brand=Febi
При использовании метода POST в HTTPS-заголовке Content-Type необходимо передать медиа-тип данных запроса application/x-www-form-urlencoded и соответственно с данным типом сформировать тело HTTPS-запроса.

В HTTPS-заголовке Accept необходимо передать ожидаемый тип данных ответа. В настоящее время реализован только тип JSON, и, в любом случае, будет возвращен он. Тем не менее, при разработке клиента, необходимо учитывать указанную особенность и передавать заголовок Accept со значением application/json.

Ответ
В случае успешного исполнения операции, веб-служба вернет ответ с HTTPS-кодом 200 и телом ответа в виде JSON. Формат ответа определяется каждой операцией. Пример результата успешного выполнения запроса:

[
	{
		"brand": "Hepu",
		"articleCode": "P999",
		"articleCodeFix": "P999",
		"articleId": "2854918",
		"description": "Антифриз [синий] 1,5л.",
		"availability": "-1",
		"deliveryPeriod": 3,
		"price": 231,
		"weight": "0"
	},
	{
		"brand": "Febi",
		"articleCode": "01089",
		"articleCodeFix": "01089",
		"articleId": "37367",
		"description": "Антифриз 1.5 л синий",
		"availability": "1943",
		"deliveryPeriod": 3,
		"price": 233,
		"weight": "1.76"
	},
	{
		"brand": "Vaico Vemo",
		"articleCode": "V600020",
		"articleCodeFix": "V600020",
		"articleId": "4144961",
		"description": "Антифриз g-11 1.5л. концентрат",
		"availability": "-2",
		"deliveryPeriod": 3,
		"price": 235,
		"weight": "0"
	}
]
Любой ответ с HTTPS-кодом 400 и более является ошибочным, в теле содержит код ошибки и, как правило, текстовое сообщение описывающее причины возникшей ошибки также в виде JSON. Пример сообщения об ошибке:

{
	"errorCode": 102,
	"errorMessage": "User Authentication Error"
}
Типы ошибок
Код	Описание
1	Ошибка синтаксиса запроса
2	Не найден обязательный параметр запроса
3	Неизвестная операция
4	Ошибка в параметре запроса
13	Неизвестная ошибка
102	Ошибка аутентификации пользователя
103	Доступ запрещен
104	Ошибка аутентификации сайта
201	Ошибка данных
202	Нарушение требования уникальности данных
301	Объект не найден
302	Ошибка кэша
303	Ресурс заблокирован
Методы API
API-методы можно логически, структурно и функционально разделить на несколько категорий:

API ABCP - Общий интерфейс
API ABCP - Административный интерфейс
API TS - Общий интерфейс
API TS - Административный интерфейс
API VINQU
API TecDoc
API Автосервис (CarCareModule)



API.ABCP.Client
Статья Обсуждение
Главная > API.ABCP.Client
Содержание
API ABCP - Общий интерфейс
Поиск
Искать бренд по артикулу
Операция: search/brands

Метод: GET

Осуществляет поиск по номеру детали и возвращает массив найденных брендов, имеющих деталь с искомым номером. Аналог этапа выбора бренда на сайте.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
number	Искомый номер детали
useOnlineStocks	Флаг "использовать online-склады". Может принимать значения 0 или 1 (не использовать и использовать соответственно; по умолчанию - 0). Если выключено, то в выдачу не будут попадать детали с online-складов, что позволит увеличить скорость ответа.
officeId	Id офиса.
Работает параметр только, если операция совершается под API-администратором. При заданном officeId в ответе возвращаются товары, такие же как на сайте у сотрудника, привязанного к офису и с включенной настройкой в его карточке "Отображение в результатах поиска только тех поставщиков, которые подключены к тому же офису, что и этот сотрудник".

locale	Локаль. Задается в формате language[_territory], например, ru_RU. По умолчанию используется локаль сайта.
Пример запроса

https://demo.public.api.abcp.ru/search/brands/?userlogin=username&userpsw=md5pass&number=01089
Поля ответа

Поле	Описание
brand	Имя производителя.
number	Код детали.
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
description	Описание детали.
availability	Флаг "Имеется ли в наличии".
Искать товар по артикулу и бренду
Операция: search/articles

Метод: GET

Осуществляет поиск по номеру детали и бренду. Возвращает массив найденных деталей. Так как один и тот же производитель может иметь несколько общепринятых наименований (например, GM и General Motors), система постарается это учесть, используя собственную базу синонимов брендов.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
number	Искомый номер детали
brand	Фильтр по имени производителя
useOnlineStocks	Флаг "использовать online-склады". Может принимать значения 0 или 1 (не использовать и использовать соответственно; по умолчанию - 0). Если выключено, то в выдачу не будут попадать детали с online-складов, что позволит увеличить скорость ответа.
disableOnlineFiltering	Флаг "отключить фильтры online поставщиков". Может принимать значения 0 или 1 (по умолчанию - 0). Если передать 1, то в выдачу попадут все товары online поставщика, без учета фильтров: "Минимальная вероятность поставки", "Минимальное наличие", "Показывать только точное наличие", "Ограничить срок поставки, в часах". "Доверять кроссам" - при этом включается.
disableFiltering	Флаг отключения фильтрации поиска. Может принимать значения 0 или 1 (по умолчанию - 0). В значении 0 - результаты поиска сокращенные. В значении 1 - результаты поиска полные. (Как будто на сайте нажали "Показать все варианты").
withOutAnalogs	Флаг "исключить поиск по аналогам". По умолчанию - 0.
profileId	При передаче этого параметра, поисковая выдача api-администратора формируется как для клиента с переданным профилем. Работает только под API-администратором.
officeId	При передаче этого параметра, поисковая выдача api-администратора формируется как для сотрудника, закрепленного за конкретным офисом (Персонал/Сотрудники/Офис) И с активированной галочкой "Отображение в результатах поиска только тех поставщиков, которые подключены к тому же офису, что и этот сотрудник". Работает только под API-администратором.
Пример запроса

https://demo.public.api.abcp.ru/search/articles/?userlogin=username&userpsw=md5pass&number=01089&brand=Febi
Поля ответа

vertical-align:middle;
Информация
Для пользователя "API-администратор" по каждой позиции возвращается цена поставщика в поле priceIn в валюте сайта, в поле priceRate - коэффициент пересчета цены поставщика из валюты поставщика в валюту сайта, в поле price для администратора возвращается цена, по умолчанию рассчитанная для гостя. При передаче параметра profileId цены и предложения выдаются в соответствии с настройками профиля.
Поле	Описание
brand	Имя производителя.
number	Код детали.
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
description	Описание детали.
availability	Наличие детали на складе.
Отрицательные значения -1, -2 и -3 означают "неточное" наличие, которое на сайте выглядит как "+", "++" и "+++" соответственно. Отрицательное значение -10 означает наличие "под заказ".

packing	Мин. партия для заказа (кратность).
deliveryPeriod	Срок поставки (в часах).
deliveryPeriodMax	Максимальный срок поставки (в часах).
deadlineReplace	Замена срока поставки (используется вместа срока поставки, если не заполнен максимальный срок поставки).
distributorCode	Код поставщика ("человеко-читаемый" код, который может (но не должен) установить владелец сайта для прайса/поставщика).
supplierCode	Код поставки (ID маршрута поставщика). Необходим для добавления товара в корзину.
supplierColor	Цвет поставщика (как в результатах поиска на сайте).
supplierDescription	Описание поставщика (как в результатах поиска на сайте).
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором!Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК.
price	Цена в валюте сайта.
maxPrice	Максимальная (предельная) цена реализации, передаваемая поставщиком. ПРЦ
weight	Вес одной единицы товара в килограммах.
volume	Объем одной единицы товара.
deliveryProbability	Вероятность поставки товара поставщика.
lastUpdateTime	Время последнего обновления
additionalPrice	Дополнительная цена в валюте сайта.
noReturn	Флаг "Без возврата"
isUsed	Признак б/у детали
distributorId	Идентификатор поставщика
grp	Группа поставщика
code	Внутренний код детали (присутствует только при условии что код выгружается в прайсе поставщика), используется как правило для синхронизации с 1С
nonliquid	Признак неликвидности детали (присутствует только при условии выгрузки в прайсе поставщика)
Пакетный запрос без учета аналогов
Операция: search/batch

Метод: POST

Осуществляет поиск по номеру производителя и бренду детали. Возвращает массив найденных деталей.

Внимание! Данная операция не выполняет поиск по online-складам.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
search	Набор искомых деталей в формате brand - number. Максимум 100 деталей.
profileId	При передаче этого параметра, поисковая выдача api-администратора формируется как для клиента с переданным профилем. Работает только под API-администратором.
Пример запроса

https://demo.public.api.abcp.ru/search/batch
Тело POST запроса

userlogin=username&userpsw=md5pass&search[0][number]=01089&search[0][brand]=Febi&search[1][number]=333305&search[1][brand]=Kyb
Поля ответа

vertical-align:middle;
Информация
Для пользователя "API-администратор" по каждой позиции возвращается цена поставщика в поле priceIn в валюте сайта, в поле priceRate - коэффициент пересчета цены поставщика из валюты поставщика в валюту сайта, в поле price для администратора возвращается цена, по умолчанию рассчитанная для гостя. При передаче параметра profileId цены и предложения выдаются в соответствии с настройками профиля.
Поле	Описание
brand	Имя производителя.
number	Код детали.
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
description	Описание детали.
availability	Наличие детали на складе.
Отрицательные значения -1, -2 и -3 означают "неточное" наличие, которое на сайте выглядит как "+", "++" и "+++" соответственно. Отрицательное значение -10 означает наличие "под заказ".

packing	Мин. партия для заказа (кратность).
deliveryPeriod	Срок поставки (в часах).
deliveryPeriodMax	Максимальный срок поставки (в часах).
distributorCode	Код поставщика ("человеко-читаемый" код, который может (но не должен) установить владелец сайта для прайса/поставщика).
supplierCode	Код поставки. (ID маршрута поставщика). Необходим для добавления товара в корзину.
supplierColor	Цвет поставщика (как в результатах поиска на сайте).
supplierDescription	Описание поставщика (как в результатах поиска на сайте).
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором!Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК.
price	Цена в валюте сайта.
maxPrice	Максимальная (предельная) цена реализации, передаваемая поставщиком. ПРЦ
weight	Вес одной единицы товара в килограммах.
volume	Объем одной единицы товара.
deliveryProbability	Вероятность поставки товара поставщика.
additionalPrice	Дополнительная цена в валюте сайта.
noReturn	Флаг "Без возврата"
grp	Группа поставщика
code	Внутренний код детали (присутствует только при условии что код выгружается в прайсе поставщика), используется как правило для синхронизации с 1С
Получать историю поиска
Операция: search/history

Метод: GET

Возвращает массив последних (не более 50) поисковых запросов текущего пользователя.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/search/history?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает массив объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
description	Описание детали.
datetime	Дата и время поиска в формате ГГГГММДДччммсс.
Подсказки по поиску
Операция: search/tips

Метод: GET

Возвращает по части номера массив подходящих пар бренд - номер

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
number	Номер (часть номера) детали
locale	Локаль. Задается в формате language[_territory], например, ru_RU. По умолчанию используется локаль сайта.
Пример запроса

https://demo.public.api.abcp.ru/search/tips?userlogin=username&userpsw=md5pass&number=0108
Поля ответа

Метод возвращает массив объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
description	Описание запчасти
Поиск сопутствующих товаров
Операция: advices

Метод: GET

Функция реализует механизм "с этим товаром покупают" на основе статистики покупки комплектов товаров. Типичный пример использования функции: покупатель выбрал масляный фильтр - система рекомендует остальные товары из набора для ТО. Или, покупатель выбрал левый передний амортизатор, система покажет правый передний. Осуществляет поиск сопутствующих товаров по запрашиваемой паре "Бренд-номер". Дополнительно можно передать параметр limit (рекомендуется = 5), ограничивающий выдачу рекомендаций.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
brand	Имя производителя
number	Номер детали
limit	необязательный параметр, ограничивающий выдачу
Пример запроса

https://demo.public.api.abcp.ru/advices/?userlogin=username&userpsw=md5pass&brand=MB&number=A2058350147&limit=5
Поля ответа

Метод возвращает массив объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
total	Количество заказов, в которых встречается данное сочетание товаров
Механизм "С этим товаром покупают"
Операция: advices/batch

Метод: POST

Функция реализует механизм "с этим товаром покупают" по нескольким товарам. Дополнительно можно передать параметр limit (рекомендуется = 5), ограничивающий выдачу рекомендаций. Параметры товаров передаются в виде JSON-массива articles из объектов с полями 'brand' и 'number'.

При использовании этой операции НЕОБХОДИМО! передавать заголовок Content-Type: application/json , а параметры передавать в теле запроса.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
articles	массив объектов, содержащих brand и number
limit	необязательный параметр, ограничивающий выдачу
Пример запроса

https://demo.public.api.abcp.ru/advices/batch
Тело POST запроса

userlogin=username&userpsw=md5pass&articles[0][number]=550051529&articles[0][brand]=Shell&articles[1][number]=3148675&articles[1][brand]=LUKOIL
Поля ответа

Метод возвращает массив объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
advices	Массив объектов с полями: brand - имя производителя, number - номер детали, total - количество заказов, в которых встречается данное сочетание товаров
Корзина
Получение списка корзин
Операция: basket/multibasket

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/basket/multibasket?userlogin=XXXXXX&userpsw=XXXXXXX
Поля ответа

Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор корзины
name	Название корзины
Добавлять товар в корзину. Удаление товара из корзины
Операция: basket/add

Метод: POST

Осуществляет подготовку к отправке заказа на товары по номеру производителя, бренду и коду поставки или по коду детали. Возвращает статус добавления товара в корзину по каждой позиции.

При добавлении brand - number - itemKey - supplierCode позиции, которая уже была ранее добавлена в корзину, значение quantity будет прибавлено к существующему.

Удаление позиции - при добавлении brand - number - itemKey - supplierCode позиции, которая уже была ранее добавлена в корзину, со значением quantity равным 0, позиция будет удалена из корзины. Для изменения количества рекомендуется удалять позицию и ее добавлять заново с требуемым количеством.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
positions	Набор добавляемых деталей в формате brand - number  - itemKey - supplierCode  с указанием добавляемого количества в поле quantity и комментария к позиции в поле comment
Вместо "brand - number" можно использовать "code" (code это код детали, который может быть загружен в прайс-листе, например, внутренний код детали из  1с).

basketId	Необязательный параметр - идентификатор корзины при использовании мультикорзины
Пример запроса

https://demo.public.api.abcp.ru/basket/add
Тело POST запроса

userlogin=username&userpsw=md5pass&positions[0][number]=01089&positions[0][brand]=Febi&positions[0][supplierCode]=54325&positions[0][itemKey]=HFGJKfkdjghreiHJhfdjKhjskhfk&positions[0][quantity]=15&positions[1][number]=333305&positions[1][brand]=Kyb&positions[1][supplierCode]=87654&positions[1][itemKey]=HjfdksahGHHfsfkdjslajfnmra&positions[1][quantity]=4&positions[1][comment]=срочно!!!
или
userlogin=username&userpsw=md5pass&positions[0][code]=FE01089&positions[0][quantity]=15&positions[0][itemKey]=HFGJKfkdjghreiHJhfdjKhjskhfk&positions[1][code]=KY333305&positions[1][quantity]=4&positions[1][itemKey]=HjfdksahGHHfsfkdjslajfnmra&positions[1][comment]=срочно!!!
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
status	Статус добавления пакета товаров. При возникновении ошибки добавления хотя бы в одной из позиций, параметр примет значение 0, иначе 1.
positions	Список позиций со статусом выполнения операции.
Узел positions содержит набор элементов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
code	Код детали (уникальный код на сайте).
supplierCode	Код поставки. (ID маршрута поставщика)
description	Описание детали.
quantity	Заказываемое количество
comment	Комментарий к позиции.
status	Статус добавления позиции в корзину. Принимает значение 0 - произошла ошибка или 1, если все успешно.
errorMessage	Текст сообщения об ошибке при статусе 0
Очистка корзины
Операция: basket/clear

Метод: POST

Удаляет все позиции из корзины.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
basketId	Необязательный параметр - идентификатор корзины при использовании мультикорзины
Пример запроса

https://demo.public.api.abcp.ru/basket/clear
Тело POST запроса

userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает ответ:

Поле	Описание
status	Статус очистки корзины. Принимает значение 0 - произошла ошибка или 1, если все успешно.
errorMessage	Текст сообщения об ошибке при статусе 0.
Получать список товаров в корзине
Операция: basket/content

Метод: GET

Возвращает список позиций, находящихся в корзине. Внимание! Если у вас подключена опция "Корзина: разрешать частичное оформление заказа". То в ответ веб-сервиса будут попадать только отмеченные позиции.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
basketId	Необязательный параметр - идентификатор корзины при использовании мультикорзины
Пример запроса

https://demo.public.api.abcp.ru/basket/content?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
code	Код детали (уникальный код на сайте).
supplierCode	Код поставки. (ID маршрута поставщика)
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором!Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК
description	Описание детали.
price	Цена за штуку
priceRate	Курс перевода цены в валюту сайта
priceInSiteCurrency	Цена ПРОДАЖИ в валюте сайта
quantity	Заказываемое количество
deadline	Срок поставки в часах
deadlineMax	Максимальный срок поставки в часах
comment	Комментарий к позиции.
status	Статус позиции в корзине. Принимает значение 0 - при ошибке или 1, если все успешно.
positionId	Номер позиции заказа.
packing	Мин. партия для заказа (кратность).
errorMessage	Текст сообщения об ошибке при статусе 0
Получение опций корзины
Операция: basket/options

Метод: GET

Возвращает значение некоторых опций Корзины.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/basket/options
Поля ответа

Поле options содержащее массив со списком:

Поле	Описание
disallow_new_shipment_address	Значение опции "Корзина: запрещать создание нового адреса доставки". Может пригодиться при использовании Добавление адреса доставки

1 - Да, всегда

2 - Да, для второго и последующего адреса доставки

self_shipment	Значение опции "Корзина: "Самовывоз" в адресах доставки"
Поле errors с массивом ошибок, если они возникли во время получения значений опций.

Корзина - оплата и доставка
Получение списка способов оплаты
Операция: basket/paymentMethods

Метод: GET

Возвращает список доступных способов оплаты. Идентификатор способа оплаты необходим при отправке заказа (при включенной опции "Корзина: показывать тип оплаты").

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/basket/paymentMethods?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор способа оплаты.
name	Способ оплаты.
Получение списка способов доставки
Операция: basket/shipmentMethods

Метод: GET

Возвращает список доступных способов доставки. Идентификатор способа доставки необходим при отправке заказа (при включенной опции "Корзина: показывать типы доставки").

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/basket/shipmentMethods?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор способа доставки.
name	Способ доставки.
Получение списка офисов самовывоза
Операция: basket/shipmentOffices

Метод: GET

Возвращает список доступных офисов для самовывоза. Идентификатор офиса самовывоза при отправке заказа (при включенной опции "Заказы: показывать офисы при выборе самовывоза").

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
officesType	Не обязательный параметр:
order - (используется по-умолчанию) возвращает офисы используемые для оформления заказа
registration - возвращает офисы используемые для регистрации пользователя при включенной опции "Офисы: включить привязку к клиентам"
Пример запроса

https://demo.public.api.abcp.ru/basket/shipmentOffices?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор офиса
name	Название офиса
Получение списка адресов доставки
Операция: basket/shipmentAddresses

Метод: GET

Возвращает список доступных адресов доставки. Идентификатор адреса доставки необходим при отправке заказа.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/basket/shipmentAddresses?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор адреса доставки.
name	Адрес доставки.
Получение списка дат отгрузки
Операция: basket/shipmentDates

Метод: GET

Возвращает список доступных дат отгрузки. Дата отгрузки необходима при отправке заказа при включенной опции "Корзина: показывать дату отгрузки".

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
minDeadlineTime	Минимальный срок поставки, в часах, среди всех позиций, которые вы собрались отправлять в заказ.
maxDeadlineTime	Максимальный срок поставки, в часах, среди всех позиций, которые вы собрались отправлять в заказ.
shipmentAddress	id адреса доставки. Необязательный параметр. Необходимо отправлять, если заказ будет оформлен с доставкой. Для подготовки доставки офисам может требоваться дополнительное время на сборку. При отправке параметра shipmentAddress получаем актуальные даты отгрузки с учетом времени комплектации в настройках офиса.
Пример запроса

https://demo.public.api.abcp.ru/basket/shipmentDates?userlogin=username&userpsw=md5pass&minDeadlineTime=24&maxDeadlineTime=48

Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
date	Дата отгрузки в формате ГГГГ-ММ-ДД
name	Дата отгрузки и день недели для отображения
Добавление адреса доставки
Операция: basket/shipmentAddress

Метод: POST

Для текущего покупателя добавляет "адрес доставки" и возвращает его идентификатор используемый в методе Отправка корзины в заказ

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
address	Обязательный, строка содержащая адрес.
Пример запроса

https://demo.public.api.abcp.ru/basket/shipmentAddress
Тело POST запроса

userlogin=username&userpsw=md5pass&address=Россия, г Москва, Пролетарский пр-кт
Поля ответа

Поле	Описание
shipmentAddressId	Идентификатор адреса доставки.
Заказы
Отправлять корзину в заказ
Операция: basket/order

Метод: POST

Осуществляет отправку позиций, содержащихся в корзине, в заказ. Возвращает статус операции, а так же список созданных заказов со списками позиций в каждом из них. Внимание! При отправке заказа могут возникнуть ошибки, при этом, часть позиций могут отправиться. Следовательно, независимо от статуса выполнения операции, необходимо проверять узел orders на наличие сформированных заказов.

Внимание изменения с 10 августа 2017! Параметр shipmentAddress становится обязательным для заполнения. Получить идентификатор адреса доставки можно с помощью операции basket/shipmentAddresses, если она не возвращает никаких значений, то shipmentAddress - является необязательным параметром. Если не используете доставку на адрес, а пользуетесь самовывозом, то необходимо передать shipmentAddress=0.

Внимание изменения с 09 июля 2018! Параметр shipmentDate становится обязательным, если Вы используете функционал "Дни отгрузки"(опция "Корзина: показывать дату отгрузки").

Внимание! Чтобы корректно использовать параметр positionIds, в ПУ должна быть включена опция "Корзина: разрешать частичное оформление заказа".

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
paymentMethod	Идентификатор способа оплаты.
shipmentMethod	Идентификатор способа доставки.
shipmentAddress	Идентификатор адреса доставки.
shipmentOffice	Идентификатор офиса самовывоза
shipmentDate	Дата отгрузки.
comment	Комментарий к заказу.
basketId	Необязательный параметр - идентификатор корзины при использовании мультикорзины
wholeOrderOnly	Признак - оформить заказ целиком. Принимаемые значения - 0/1. По умолчанию - 0.
positionIds	Необязательный параметр - массив с номерами позиций заказа. Номера возвращает запрос basket/content
clientOrderNumber	Необязательный параметр-номер заказа в системе учета клиента
Пример запроса

https://demo.public.api.abcp.ru/basket/order
Тело POST запроса

userlogin=username&userpsw=md5pass&paymentMethod=37&shipmentMethod=4323&shipmentAddress=788&shipmentDate=2012-12-21&comment=срочно
Поля ответа

Метод возвращает объект вида:

Поле	Описание
status	Статус отправки корзины. При возникновении ошибки, параметр примет значение 0, иначе - 1.
errorMessage	Текст сообщения об ошибке при статусе 0
clientOrderNumber	номер заказа в системе учета клиента
orders	Список созданных заказов со списком позиций.
Узел orders возвращает набор объектов вида:

Поле	Описание
number	Номер заказа в портале
status	Статус заказа
statusId	Уникальный идентификатор статус заказа
statusCode	Код статуса заказа
positionsQuantity	Количество позиций
sum	Сумма заказа
date	Дата заказа
comment	Комментарий к заказу
wholeOrderOnly	Признак - оформить заказ целиком.
positions	Список позиций заказа.
Узел positions содержит набор объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
code	Код детали (уникальный код на сайте).
supplierCode	Код поставки.(ID маршрута поставщика)
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором!Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК
description	Описание детали.
quantity	Заказываемое количество
price	Цена за единицу товара
deadline	Срок поставки в часах
deadlineMax	Максимальный срок поставки в часах
comment	Комментарий к позиции
status	Статус позиции заказа
statusId	Уникальный идентификатор статус позиции заказа
statusCode	Код статуса позиции заказа
positionId	Номер позиции заказа


vertical-align:middle;
Внимание!
Для этой операции существует ограничение на 500 позиций для одного заказа. При попытке добавить большее количество позиций, операция завершится с ошибкой
Моментальный заказ
Операция: orders/instant

Метод: POST

Объединяет в себе операции basket/add и basket/order то есть, добавляет переданный в параметрах список товаров в корзину и сразу же отправляет их в заказ. У данной операции есть важная особенность - она не учитывает позиции, которые уже лежат в корзине, в заказ они не попадут и останутся в корзине пользователя. Использование данной операции оптимально при автоматическом перезаказе у клиентов платформы ABCP.

Возвращает статус операции, а так же список созданных заказов со списками позиций в каждом из них.

Внимание! При отправке заказа могут возникнуть ошибки, при этом, часть позиций могут отправиться. Независимо от статуса выполнения операции, необходимо проверять узел orders на наличие сформированных заказов.

Внимание! Параметр shipmentAddress становится обязательным для заполнения. Получить идентификатор адреса доставки можно с помощью операции basket/shipmentAddresses, если она не возвращает никаких значений, то shipmentAddress - является необязательным параметром. Если не используете доставку на адрес, а пользуетесь самовывозом, то необходимо передать shipmentAddress=0.

Внимание Параметр shipmentDate становится обязательным, если Вы используете функционал "Дни отгрузки"(опция "Корзина: показывать дату отгрузки").

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
positions	Набор добавляемых деталей в формате brand - number - itemKey - supplierCode или code с указанием добавляемого количества в поле quantity и комментария к позиции в поле comment
paymentMethod	Идентификатор способа оплаты.
shipmentMethod	Идентификатор способа доставки.
shipmentAddress	Идентификатор адреса доставки.
shipmentOffice	Идентификатор офиса самовывоза
shipmentDate	Дата отгрузки.
comment	Комментарий к заказу.
basketId	Необязательный параметр - идентификатор корзины при использовании мультикорзины
wholeOrderOnly	Признак - оформить заказ целиком. Принимаемые значения - 0/1. По умолчанию - 0.
clientOrderNumber	Необязательный параметр - номер заказа в системе учета клиента
Пример запроса

https://demo.public.api.abcp.ru/orders/instant
Тело POST запроса

userlogin=username&userpsw=md5pass&positions[0][number]=01089&positions[0][brand]=Febi&positions[0][supplierCode]=54325&positions[0][itemKey]=HFGJKfkdjghreiHJhfdjKhjskhfk&positions[0][quantity]=15&positions[1][number]=333305&positions[1][brand]=Kyb&positions[1][supplierCode]=87654&positions[1][itemKey]=HjfdksahGHHfsfkdjslajfnmra&positions[1][quantity]=4&positions[1][comment]=срочно!!!&paymentMethod=37&shipmentMethod=4323&shipmentAddress=788&shipmentDate=2012-12-21&comment=срочно
или
userlogin=username&userpsw=md5pass&positions[0][code]=FE01089&positions[0][quantity]=15&positions[0][itemKey]=HFGJKfkdjghreiHJhfdjKhjskhfk&positions[1][code]=KY333305&positions[1][quantity]=4&positions[1][itemKey]=HjfdksahGHHfsfkdjslajfnmra&positions[1][comment]=срочно!!!&paymentMethod=37&shipmentMethod=4323&shipmentAddress=788&shipmentDate=2012-12-21&comment=срочно
Поля ответа

Метод возвращает объект вида:

Поле	Описание
status	Статус отправки корзины. При возникновении ошибки, параметр примет значение 0, иначе - 1.
errorMessage	Текст сообщения об ошибке при статусе 0
clientOrderNumber	Необязательный параметр - номер заказа в системе учета клиента
orders	Список созданных заказов со списком позиций.
Узел orders содержит набор объектов вида:

Поле	Описание
number	Номер заказа в портале
status	Статус заказа
statusId	Уникальный идентификатор статус заказа
statusCode	Код статуса заказа
positionsQuantity	Количество позиций
sum	Сумма заказа
date	Дата заказа
comment	Комментарий к заказу
wholeOrderOnly	Признак - оформить заказ целиком.
positions	Список позиций заказа.
Узел positions содержит набор объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
code	Код детали (уникальный код на сайте).
supplierCode	Код поставки.(ID маршрута поставщика)
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором!Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК
description	Описание детали.
quantity	Заказываемое количество
price	Цена за единицу товара
deadline	Срок поставки в часах
deadlineMax	Максимальный срок поставки в часах
comment	Комментарий к позиции
status	Статус позиции заказа
statusId	Уникальный идентификатор статус позиции заказа
statusCode	Код статуса позиции заказа


vertical-align:middle;
Внимание!
Для этой операции существует ограничение на 500 позиций для одного заказа. При попытке добавить большее количество позиций, операция завершится с ошибкой
Получение списка статусов
Операция: orders/statuses

Метод: GET

Осуществляет получение списка всех имеющихся статусов . Возвращает список статусов.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/orders/statuses?userlogin=username&userpsw=md5pass
Поля ответа Метод возвращает массив объектов вида:

Поле	Описание
id	id статуса
name	название статуса
color	Цвет статуса
isFinalStatus	Признак конечного статуса
Получение позиций заказов со статусами
Операция: orders/list

Метод: GET

Принимает список номеров заказов. Осуществляет получение статусов заказов и позиций внутри. Возвращает список заказов со списком позиций в каждом из них.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
orders	список номеров заказов
Пример запроса

https://demo.public.api.abcp.ru/orders/list?userlogin=username&userpsw=md5pass&orders[0]=5642365&orders[1]=8765875
Поля ответа

Метод возвращает массив объектов вида:

Поле	Описание
number	Номер заказа в портале
status	Статус заказа
statusId	Идентификатор статуса заказа уникальный в рамках всей системы
statusCode	Код статуса заказа
statusColor	Цвет статуса
positionsQuantity	Количество позиций
deliveryAddressId	Идентификатор адреса доставки
deliveryAddress	Адрес доставки
deliveryOfficeId	Идентификатор офиса самовывоза
deliveryOffice	Офис самовывоза
deliveryTypeId	Идентификатор типа доставки
deliveryType	Тип доставки
paymentTypeId	Идентификатор типа оплаты
paymentType	Тип оплаты
deliveryCost	Стоимость доставки
shipmentDate	Дата отгрузки
sum	Сумма заказа
date	Дата заказа
code	Ячейка заказа
debt	Долг по оплате заказа
comment	Комментарий к заказу
clientOrderNumber	Номер заказа в системе учета клиента
positions	Список позиций заказа.
notes	Список заметок заказа.
Узел notes содержит массив объектов описанных здесь

Узел positions содержит массив объектов вида:

Поле	Описание
positionId	ID позиции
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
code	Код детали (уникальный код на сайте).
supplierCode	Код поставки.
itemKey	Код позиции. Внимание! Не является уникальным идентификатором! Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК.
description	Описание детали.
quantityOrdered	Заказываемое количество
quantity	Итоговое количество
price	Цена за единицу товара
priceRate	Курс перевода цены в валюту сайта
priceInSiteCurrency	Цена ПРОДАЖИ в валюте сайта
deadline	Срок поставки в часах
deadlineMax	Максимальный срок поставки в часах
comment	Комментарий к позиции
commentAnswer	Ответ сотрудника на комментарий по позиции
status	Статус позиции заказа
statusId	Идентификатор статуса позиции заказа уникальный в рамках всей системы
statusCode	Код статуса позиции заказа
statusColor	Цвет статуса
statusDate	Дата установки статуса
noReturn	Признак возврата позиции
reference	Дополнительная информация
Получение списка заказов
Операция: orders

Метод: GET

Осуществляет получение списка всех заказов клиента по страницам. Сортировка по номеру заказа по убыванию, т.е. сначала передаются самые новые заказы.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
format	(необязательный) - формат вывода результата. По умолчанию отображается информация только по заказам. При значении p - к заказам добавляется информация по всем позициям.
skip	(необязательный) - кол-во заказов, которые нужно пропустить. По умолчанию - 0.
limit	(необязательный) - кол-во заказов, которые нужно отобразить за один раз. Допускается любое значение от 1 до 1000. По умолчанию - 100.
Примеры запросов

https://demo.public.api.abcp.ru/orders/?userlogin=username&userpsw=md5pass
https://demo.public.api.abcp.ru/orders/?userlogin=username&userpsw=md5pass&format=p&skip=10&limit=20
Поля ответа

Метод возвращает данные вида:

Поле	Описание
count	Кол-во всех заказов
items	Массив с заказами
Свойства заказа:

Поле	Описание
number	Номер заказа в портале
status	Статус заказа - актуально,только когда все позиции в одном статусе
statusId	Id статуса - актуально,только когда все позиции в одном статусе
statusCode	Код статуса заказа - актуально,только когда все позиции в одном статусе
statusColor	Цвет статуса - актуально,только когда все позиции в одном статусе
positionsQuantity	Количество позиций
deliveryAddressId	Идентификатор адреса доставки
deliveryAddress	Адрес доставки
deliveryOfficeId	Идентификатор офиса самовывоза
deliveryOffice	Офис самовывоза
deliveryTypeId	Идентификатор типа доставки
deliveryType	Тип доставки
paymentTypeId	Идентификатор типа оплаты
paymentType	Тип оплаты
deliveryCost	Стоимость доставки
shipmentDate	Дата отгрузки
sum	Сумма заказа
date	Дата заказа
debt	Долг по оплате заказа
comment	Комментарий к заказу
clientOrderNumber	Номер заказа в системе учета клиента
positions	Список позиций заказа (если параметр format имеет значение p)
Узел positions содержит массив объектов вида:

Поле	Описание
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
code	Код детали (уникальный код на сайте).
supplierCode	Код поставки.
itemKey	Код позиции. Внимание! Не является уникальным идентификатором! Параметр "itemKey" обязателен для передачи заказа онлайн-поставщику, а также при передаче заказа от франчайзи к ГК.
description	Описание детали.
quantityOrdered	Заказываемое количество
quantity	Итоговое количество
price	Цена за единицу товара
deadline	Срок поставки в часах
deadlineMax	Максимальный срок поставки в часах
comment	Комментарий к позиции
status	Статус позиции заказа
statusCode	Код статуса позиции заказа
statusId	Id статуса позиции
statusColor	цвет статуса позиции
statusDate	дата выставления статуса позиции
noReturn	признак возвратности позиции
commentAnswer	ответ на комментарий по позиции
priceInSiteCurrency	Цена ПРОДАЖИ в валюте сайта
priceRate	Курс перевода цены в валюту сайта
reference	служебное поле
Запрос на отмену позиции
Операция: orders/cancelPosition

Метод: POST

Выставляет позиции признак "Запрос на отмену"

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
positionId	Идентификатор позиции заказа
Метод возвращает сообщение об успешном запросе на отмену в поле message либо сообщение об ошибке

Пример запроса

 https://demo.public.api.abcp.ru/orders/cancelPosition
Тело POST запроса

userlogin=username&userpsw=md5pass&positionId=232324455
Получение версии системы заказов
Операция: orders/version

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Метод возвращает версию подсистемы заказов, используемую магазином. Доступные значения 1 и 2.

Пользователь
Регистрация пользователя
Операция: user/new

Метод: POST

Принимает параметры для регистрации пользователя. Осуществляет регистрацию нового пользователя в системе. Возвращает статус выполнения операции регистрации, учетные данные нового пользователя, а так же сообщение об ошибке в случае возникновения таковой. Регистрация через API запрещена при использовании модуля франчайзи, если выключен флаг "Разрешить ГК участвовать в продажах".

Параметры запроса

Параметр	Описание
marketType	Тип регистрации:
Розница
Опт
filialId	Код филиала (если имеются)
name	Имя
secondName	Отчество
surname	Фамилия
password	Пароль
birthDate	Дата рождения, формат YYYY-MM-DD
mobile	Номер мобильного телефона
memberOfClub	Название автоклуба
office	Идентификатор офиса
email	Адрес электронной почты
icq	ICQ UIN
skype	Skype
regionId	Код региона
city	Город
organizationName	Наименование организации
business	Тип организации. Значение от 1 до 3:
Автосервис
Автомагазин
Собственный автопарк
organizationForm	Правовая форма организации. Варианты:
ООО
ОАО
ЗАО
ТОО
АО
ЧП
ПБОЮЛ
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
ogrn	ОГРН
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
deliveryAddress	Адрес доставки
comment	Комментарий
sendRegistrationEmail	Необязательный, по-умолчанию - 0.
1 - отправлять клиенту, менеджеру письмо о регистрации 0 - не отправлять письмо

Пример запроса

https://demo.public.api.abcp.ru/user/new
Тело POST запроса

marketType=1&name=Василий&surname=Васильев&password=12345&mobile=79000000000&email=vasya@mail.ru&regionId=77&city=Москва&deliveryAddress=ул. Ленина, д.2&comment=
Поля ответа

Поле	Описание
status	Статус выполнения операции
userCode	Внутренний код пользователя. Необходим для активации.
activationCode	Код активации, если включена
errorMessage	Массив сообщений об ошибках, если статус = 0
Активация пользователя
Операция: user/activation

Метод: POST

Параметры запроса

Параметр	Описание
userCode	Внутренний код пользователя.
activationCode	Код активации
Пример запроса

https://demo.public.api.abcp.ru/user/activation
Тело POST запроса

userlogin=username&userpsw=md5pass&userCode=12345&activationCode=567ab097bcd
Метод возвращает набор узлов вида:

Поле	Описание
status	Статус активации.
errorMessage	Сообщение об ошибке при статусе = 0
Получение данных пользователя (авторизация)
Операция: user/info

Метод: GET

Возвращает данные пользователя по логину и паролю.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/user/info?userlogin=username&userpsw=md5pass
Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор пользователя в системе ABCP.
code	Код пользователя.
email	Адрес электронной почты пользователя.
name	ФИО или название организации
mobile	Мобильный телефон
organization	Наименование юридического лица
Восстановление пароля
Операция: user/restore

Метод: POST

Операция восстановление пароля пользователя.

Механизм использования

Восстановление пароля состоит из двух этапов:

Запрос восстановления пароля с указанием номера телефона или email. В результате успешного завершения будет отправлено стандартное письмо со ссылкой восстановления пароля на указанный email или код в SMS на указанный номер телефона.
Сохранение нового пароля с указанием кода подтверждения из SMS. Данный этап актуален только для восстановления по номеру телефона, так как в случае с email, в письме придет ссылка на форму восстановления пароля на сайте, и второй этап будет выполнен в ней.
Параметры запроса

Параметр	Описание
emailOrMobile	Email или телефон [первый этап]
passwordNew	Новый пароль [второй этап]
code	Код из смс [второй этап]
Пример запроса

https://demo.public.api.abcp.ru/user/restore
Тело POST запроса

emailOrMobile=799912345678
Метод возвращает:

при ошибке стандартный ответ с полями errorCode и errorMessage
при успешности ответ с полями status (возможные значения 1 и 2) и message c текстом сообщения о статусе выполнения операции
Гараж
Получение списка автомобилей в гараже
Операция: user/garage

Метод: GET

Возвращает список автомобилей гаража текущего пользователя

Параметры запроса

vertical-align:middle;
Информация
При выполнении данной операции от имени API-администратора, необходимо передавать параметр userId, содержащий идентификатор пользователя вашего сайта.
Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
Пример запроса

https://demo.public.api.abcp.ru/user/garage?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор автомобиля в гараже
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
manufacturer	Название марки автомобиля
modelId	Идентификатор модели автомобиля
model	Название модели автомобиля
modificationId	Идентификатор модификации автомобиля
modification	Название модификации автомобиля
vehicleRegPlate	Государственный номер автомобиля
Получение информации об автомобиле в гараже
Операция: user/garage/car

Метод: GET

Возвращает данные по одному автомобилю гаража текущего пользователя

Параметры запроса

vertical-align:middle;
Информация
При выполнении данной операции от имени API-администратора, необходимо передавать параметр userId, содержащий идентификатор пользователя вашего сайта.
Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
carId	Идентификатор автомобиля в гараже
Пример запроса

https://demo.public.api.abcp.ru/user/garage/car?userlogin=username&userpsw=md5pass&carId=14214
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор автомобиля в гараже
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
manufacturer	Название марки автомобиля
modelId	Идентификатор модели автомобиля
model	Название модели автомобиля
modificationId	Идентификатор модификации автомобиля
modification	Название модификации автомобиля
vehicleRegPlate	Государственный номер автомобиля
Добавление автомобиля в гараж
Операция: user/garage/add

Метод: POST

Добавляет автомобиль в гараж

Параметры запроса

vertical-align:middle;
Информация
Для получения индентификаторов марок/моделей/модификаций воспользуйтесь операциями из раздела "дерево автомобилей".
vertical-align:middle;
Информация
При выполнении данной операции от имени API-администратора, необходимо передавать параметр userId, содержащий идентификатор пользователя вашего сайта.


Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
modelId	Идентификатор модели автомобиля
modificationId	Идентификатор модификации автомобиля
vehicleRegPlate	Государственный номер автомобиля
Пример запроса

https://demo.public.api.abcp.ru/user/garage/add
Тело POST запроса

userlogin=username&userpsw=md5pass&name=Ауди&manufacturerId=5
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор автомобиля в гараже
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
manufacturer	Название марки автомобиля
modelId	Идентификатор модели автомобиля
model	Название модели автомобиля
modificationId	Идентификатор модификации автомобиля
vehicleRegPlate	Государственный номер автомобиля
Обновление автомобиля в гараже
Операция: user/garage/update

Метод: POST

Изменяет автомобиль в гараже. Обязательным свойством автомобиля является только carId, то есть, можно передавать только те параметры, которые необходимо изменить. Не переданные свойства изменены не будут.

Параметры запроса

vertical-align:middle;
Информация
При выполнении данной операции от имени API-администратора, необходимо передавать параметр userId, содержащий идентификатор пользователя вашего сайта.
Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
carId	Идентификатор автомобиля
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
modelId	Идентификатор модели автомобиля
modificationId	Идентификатор модификации автомобиля
vehicleRegPlate	Государственный номер автомобиля
Пример запроса

https://demo.public.api.abcp.ru/user/garage/update
Тело POST запроса

userlogin=username&userpsw=md5pass&carId=146542&name=Бумер&manufacturerId=12
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор автомобиля в гараже
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
manufacturer	Название марки автомобиля
modelId	Идентификатор модели автомобиля
model	Название модели автомобиля
modificationId	Идентификатор модификации автомобиля
modification	Название модификации автомобиля
vehicleRegPlate	Государственный номер автомобиля
Удаление автомобиля из гаража
Операция: user/garage/delete

Метод: POST

Удаляет автомобиль из гаража.

Параметры запроса

vertical-align:middle;
Информация
При выполнении данной операции от имени API-администратора, необходимо передавать параметр userId, содержащий идентификатор пользователя вашего сайта.
Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
carId	Идентификатор автомобиля
Пример запроса

https://demo.public.api.abcp.ru/user/garage/delete
Тело POST запроса

userlogin=username&userpsw=md5pass&carId=146542&name=Бумер&manufacturerId=12
Метод возвращает значение true в случае успешности удаления или сообщение об ошибке.

Дерево автомобилей
Получение списка годов дерева автомобилей
Операция: cartree/years

Метод: GET

Возвращает список доступных годов для дерева автомобилей

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
manufacturerId	Идентификатор марки для фильтрации. Необязательное.
Пример запроса

https://demo.public.api.abcp.ru/cartree/years?userlogin=username&userpsw=md5pass
Метод возвращает массив доступных годов.

Получение списка марок дерева автомобилей
Операция: cartree/manufacturers

Метод: GET

Возвращает список доступных марок для дерева автомобилей

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
year	Год для фильтрации марок. Необязательное.
Пример запроса

https://demo.public.api.abcp.ru/cartree/manufacturers?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор марки
name	Название марки
Получение списка моделей дерева автомобилей
Операция: cartree/models

Метод: GET

Возвращает список доступных моделей указанной марки для дерева автомобилей

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
manufacturerId	Идентификатор марки
year	Год для фильтрации моделей. Необязательное.
Пример запроса

https://demo.public.api.abcp.ru/cartree/models?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор модели
name	Название модели
yearFrom	Дата начала выпуска модели
yearTo	Дата окончания выпуска модели
Получение списка модификаций дерева автомобилей
Операция: cartree/modifications

Метод: GET

Возвращает список доступных модификаций указанной марки и модели для дерева автомобилей

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
manufacturerId	Идентификатор марки
modelId	Идентификатор модели
year	Год для фильтрации моделей. Необязательное.
Пример запроса

https://demo.public.api.abcp.ru/cartree/modifications?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор модификации
name	Название модификации
yearFrom	Дата начала выпуска модификации
yearTo	Дата окончания выпуска модификации
modelId	Идентификатор модели
model	Название модели
manufacturerId	Идентификатор марки
manufacturer	Название марки
fullName	Полное название модификации, включающее марку и модель
cylinderCapacityCcm	Объем
constructionType	Кузов
powerHP	Мощность в лошадиных силах
powerKW	Мощность в киловаттах
motorCodes	Код двигателя
fuelType	Тип топлива
Получение списка полей формы
Операция: form/fields

Метод: GET

Возвращает список полей формы и все параметры в соответствии с установленными настройками в панели управления на странице Внешний вид и контент / Формы. На текущий момент доступны только формы регистрации, реализованные в API-методе user/new. Метод не требует авторизации.

Параметры запроса

Параметр	Описание
name	Имя формы. Возможные значения: registration_wholesale - опт; registration_retail - розница
locale	Локаль формы (по умолчанию, ru_RU)
Пример запроса

https://demo.public.api.abcp.ru/form/fields?name=registration_retail&locale=ru_KZ
Метод возвращает массив объектов вида:

Поле	Описание
name	Имя поля. Соответствует имени поля в соответствующем API-методе.
label	Метка поля на языке локали. Название поля в форме.
isRequired	Флаг "Обязательное поле".
errorMessage	Текстовое сообщение на языке локали, которое будет показано при некорректном заполнении поля.
Справочник брендов
Получать данные справочника брендов
Операция: articles/brands

Метод: GET

Возвращает список всех брендов зарегистрированных в системе с их синонимами.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя
userpsw	md5-хэш пароля пользователя
Пример запроса

https://demo.public.api.abcp.ru/articles/brands?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
name	Имя бренда
aliases	Массив, содержащий список синонимов текущего бренда
Получение карточки товара
Операция: articles/info

Метод: GET

vertical-align:middle;
Информация
Данная операция доступна только API-администратору
Возвращает данные по указанному в параметрах товару

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя
userpsw	md5-хэш пароля пользователя
brand	Имя производителя
number	Код детали
format	Формат ответа. Допустимые значения: [b][n][p][c][h][m][t][i] - формат вывода информации (b - бренд, n - номер, p - свойства, c - кроссы, h - свойства с учетом локали, m - информация о модели, t - вывод типа кроссов с учетом направления, i - изображения запчасти).
cross_image	При передаче cross_image=1 и [i] в параметре format в ответе операции будут выводиться изображения кроссов.
source	Источник кроссов. Необязательный параметр. Через него передается массив со списком источников, в которых нужно искать кроссы.
standard - Кроссы с достоверностью 99.9 % ; common- Кроссы с достоверностью 95%; common_cat - Кроссы нескольких неоригинальных каталогов. Если параметр не передается, то в ответе выводятся все источники, подключенные в ПУ пример: &source[]=standard&source[]=common

with_original	Признак кроссирования через оригинал. Необязательный параметр. Через него передается массив со списком источников, в которых используется кроссирование через оригинал. Работает данный параметр только при ручном указании источников кроссов (source). Если его не передавать то в ответе нет кроссов через оригинал по указанным источникам.
Если указать данный параметр без указания конкретных источников - в ответе получаем текст "Для получения аналогов через оригинал обязательно указывайте источники кроссов".

пример: &with_original[]=standard&with_original[]=common

locale	Локаль. Задается в формате language[_territory], например, ru_RU. Это же значение используется по умолчанию.
Пример запроса

https://demo.public.api.abcp.ru/articles/info?userlogin=username&userpsw=md5pass&brand=Febi&number=01089&format=bnpic
Метод возвращает массив объектов вида:

Параметр	Описание
brand	Имя производителя
number	Искомый номер детали
outer_number	Номер детали, содержащий пробелы, слэши и другие символы.
short_number	Сокращённый номер детали. Нужен для идентификации в вашей поисковой выдаче одинаковых артикулов. Например, в случае двойной маркировки свечей NGK.
alt_number	Альтернативный номер детали. Нужен для идентификации в вашей поисковой выдаче одинаковых артикулов. Например, в случае коротких и полных номеров по бренду Mercedes (с буквой A и без)
properties	Массив свойств детали: описание, вес, объем и т.п. (при включенном формате p)
crosses	Массив информации об аналогах (при включенном формате c).
Пример: А - запрашиваемая деталь crossType = 1 - замена (replacement), деталь B заменяет деталь A crossType = 2 - входит в комплект (unclude), деталь B является частью детали A crossType = 3 - является частью комплекта (part of), деталь A является частью детали B crossType = 4 - односторонняя замена, деталь A заменяется на деталь B crossType = 5 - односторонняя замена, деталь A является заменой для детали B

images	Массив изображений товара (при включенном формате i). В массиве указаны имена файлов расположенных по адресу https://pubimg.4mycar.ru/images/


Каталог ТО
vertical-align:middle;
Внимание!
Каталог ТО через API - отдельная услуга, для подключения необходимо связаться с отделом продаж ABCP
Общая информация по каталогу ТО и использованию операций
ABCP разрабатывает и поддерживает каталог ТО. Каталог ТО - это дерево модификаций автомобилей (более 40 тысяч шт), к которым через применяемость привязаны артикулы запчастей для ТО в 10 товарных группах (фильтры, тормоза, свечи и т.д.). Кроме информации о применяемости деталей для ТО к конкретной модификации каталог ТО отображает информацию по шинам, дискам и щёткам стеклоочистителей. Процесс подбора в общем случае выглядит так: пользователь видит список производителей, выбирает свою марку, затем видит список моделей, после выбора модели видит список модификаций и выбирает свою модификацию. На финальном этапе пользователь видит информацию о своей модификации, рекомендации по шинам, дискам и щёткам стеклоочистителей и список деталей для ТО с артикулами. Из блоков с информацией по шинам, дискам и щёткам пользователь может перейти в каталог по соответствующей товарной группе. Из списка деталей для ТО пользователь может перейти в проценку по оригинальному бренду и номеру и выбрать в поисковой выдаче устраивающие его по цене и срокам варианты. С примерами реализации каталога ТО на сайте для клиента и с детальным описание всех операций по получению информации вы можете ознакомиться ниже.

Примеры реализации
b2b.autorus.ru
4mycar.ru
Получение списка производителей
Операция: carbase/manufacturers

Метод: GET

Метод позволяет получить список производителей, для которых в дереве модификаций присутствуют модели.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/carbase/manufacturers?userlogin=username&userpsw=md5pass
Пример ответа (сокращено для лучшего восприятия)

[
  {
    "id": "3854",
    "name": "ABARTH",
    "isPopular": "0"
  },
  {
    "id": "184",
    "name": "KIA",
    "isPopular": "1"
  }
]
Описание ответа

Возвращается массив записей о производителях автомобилей, каждый элемент массива содержит информацию:

Объект	Описание
id	Идентификатор производителя в дереве модификаций, используется в операции запроса списка моделей
name	Наименование производителя автомобиля
isPopular	Признак популярности (установлен на стороне дерева модификаций и может быть использован для отображения только популярных марок с возможностью открытия полного списка.


Получение списка моделей автомобилей одного производителя
Операция: carbase/models

Метод: GET

Метод позволяет получить список моделей, для которых в дереве модификаций присутствуют модификации.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
manufacturerId	id производителя из операции carbase/manufacturers
Пример запроса

https://demo.public.api.abcp.ru/carbase/models?userlogin=username&userpsw=md5pass&manufacturerId=184
Пример ответа (сокращено для лучшего восприятия)

{
  "CARNIVAL": [
    {
      "id": "4349",
      "name": "CARNIVAL I (UP)",
      "yearFrom": "199806",
      "yearTo": "200110",
      "imagePath": ""
    },
    {
      "id": "4844",
      "name": "CARNIVAL II (GQ)",
      "yearFrom": "199901",
      "yearTo": "200709",
      "imagePath": ""
    }
  ],
  "RIO": [
    {
      "id": "10575",
      "name": "RIO III Седан (UB)",
      "yearFrom": "201103",
      "yearTo": "201503",
      "imagePath": "084e0fb578151d308d60a82ec941f19c04.jpeg"
    },
    {
      "id": "39288",
      "name": "RIO III Седан рестайлинг (UB)",
      "yearFrom": "201504",
      "yearTo": "201709",
      "imagePath": "0921d3c06736526206984e70af55342b98.jpeg"
    },
    {
      "id": "9697",
      "name": "RIO III Хэтчбек (UB)",
      "yearFrom": "201103",
      "yearTo": "201505",
      "imagePath": "059eb548dbb279eaab41db542130db330b.jpeg"
    },
    {
      "id": "39287",
      "name": "RIO III Хэтчбек 3дв (UB)",
      "yearFrom": "201103",
      "yearTo": "201505",
      "imagePath": "0970e0a22b46eb49822ce4b776acdb23c8.jpeg"
    }
  ]
}
Описание ответа

Возвращает сгруппированный список моделей одного производителя с указанием наименования группы. То есть, все KIA RIO представлены в группе "RIO", все Mercedes-Benz GLE представлены в группе "GLE". Отображение списка моделей в сгруппированном виде не перегружает страницу с контентом и позволяет пользователю быстрее найти его модель, каждая запись в группе моделей содержит:

Объект	Описание
id	Идентификатор модели в дереве модификаций, используется в операции запроса списка модификаций конкретной модели (описана ниже)
name	Наименование модели автомобиля
yearFrom	Год и месяц начала производства для идентификации нужной пользователю модели.
yearTo	Год и месяц окончания производства для идентификации нужной пользователю модели.
imagePath	Изображение модели (может быть запрошено по адресу https://pubimg.4mycar.ru/images/imagePath, например, полная версия, превью).
Получение списка модификаций одной модели
Операция: carbase/modifications

Метод: GET

Метод позволяет получить список модификаций конкретной модели одного производителя.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
modelId	Идентификатор модели из ответа в операции carbase/models
locale	Локаль, по-умолчанию (если значение не передано) - ru_RU
Пример запроса

https://demo.public.api.abcp.ru/carbase/modifications?userlogin=username&userpsw=md5pass&modelId=10575
Пример ответа (сокращено для лучшего восприятия)

{
  "id": "10575",
  "name": "RIO III Седан (UB)",
  "groupName": "RIO",
  "yearFrom": "201103",
  "yearTo": "201503",
  "imagePath": "084e0fb578151d308d60a82ec941f19c04.jpeg",
  "modifications": [
    {
      "id": "10579",
      "modificationName": "1.4 CVVT",
      "yearFrom": "201108",
      "yearTo": "201503",
      "fuelType": "Бензин",
      "powerHP": "107",
      "powerKW": "79",
      "motorCodes": "G4FA",
      "cylinder": "4",
      "cylinderCapacityCcm": "1396"
    },
    {
      "id": "10580",
      "modificationName": "1.4 CVVT",
      "yearFrom": "201110",
      "yearTo": "0",
      "fuelType": "Бензин",
      "powerHP": "109",
      "powerKW": "80",
      "motorCodes": "G4FA",
      "cylinder": "4",
      "cylinderCapacityCcm": "1396"
    },
    {
      "id": "10581",
      "modificationName": "1.6 CVVT",
      "yearFrom": "201108",
      "yearTo": "201503",
      "fuelType": "Бензин",
      "powerHP": "123",
      "powerKW": "90",
      "motorCodes": "G4FC",
      "cylinder": "4",
      "cylinderCapacityCcm": "1591"
    }
  ]
}
Описание ответа

Возвращается информация о запрашиваемой модели и массив с информацией о модификациях, описание модификации:

Объект	Описание
id	Идентификатор модификации в дереве модификаций, используется в операции запроса информации по одной модификации
modificationName	Наименование модификации автомобиля (для отображения в списке)
yearFrom	Год и месяц начала производства для идентификации нужной пользователю модели.
yearTo	Год и месяц окончания производства для идентификации нужной пользователю модели.
fuelType	Тип топлива для отображения в списке модификаций, информация нужна для быстрой идентификации нужной пользователю модификации.
powerHP	Мощность в л.с. для отображения в списке модификаций, информация нужна для быстрой идентификации нужной пользователю модификации.
powerKW	Мощность в кВт для отображения в списке модификаций, информация нужна для быстрой идентификации нужной пользователю модификации.
motorCodes	Код(ы) двигателя(ей) для отображения в списке модификаций, информация нужна для быстрой идентификации нужной пользователю модификации.
cylinder	Количество цилиндров двигателя для отображения в списке модификаций, информация нужна для быстрой идентификации нужной пользователю модификации.
cylinderCapacityCcm	Объём двигателя в кубических сантиметрах для отображения в списке модификаций, информация нужна для быстрой идентификации нужной пользователю модификации.


Получение информации об одной модификации
Операция: carbase/modificationInfo

Метод: GET

Метод позволяет получить имеющуюся информацию по одной модификации: шины, диски, шётки, список запчастей для ТО.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
modificationId	id модификации, по которой запрашивается информация
locale	Локаль, по-умолчанию (если значение не передано) - ru_RU
Пример запроса

https://demo.public.api.abcp.ru/carbase/modificationInfo?userlogin=username&userpsw=md5pass&modificationId=10580&locale=ru_RU
Пример ответа

{
  "modification": {
    "manufacturerName": "KIA",
    "groupName": "RIO",
    "modelName": "RIO III Седан (UB)",
    "modelId": "10575",
    "modificationName": "1.4 CVVT",
    "constructionType": "Седан",
    "cylinder": "4",
    "cylinderCapacityCcm": "1396",
    "fuelType": "Бензин",
    "powerHP": "109",
    "powerKW": "80",
    "yearFrom": "201110",
    "yearTo": "0",
    "motorCodes": "G4FA",
    "imagePath": "084e0fb578151d308d60a82ec941f19c04.jpeg"
  },
  "disks": {
    "bolt": "",
    "factory": [
      {
        "diameter": 15,
        "et": 48,
        "holes": 4,
        "hubDiameter": 54.1,
        "name": "6x15/4x100 ET48 DIA54.1",
        "pcd": 100,
        "rear": null,
        "width": 6
      },
      {
        "diameter": 16,
        "et": 52,
        "holes": 4,
        "hubDiameter": 54.1,
        "name": "6x16/4x100 ET52 DIA54.1",
        "pcd": 100,
        "rear": null,
        "width": 6
      }
    ],
    "nut": "12*1,5"
  },
  "tires": {
    "factory": [
      {
        "diameter": 15,
        "height": 65,
        "name": "185/65 R15",
        "rear": null,
        "width": 185
      },
      {
        "diameter": 16,
        "height": 55,
        "name": "195/55 R16",
        "rear": null,
        "width": 195
      }
    ]
  },
  "wipers": {
    "left": {
      "length": 650,
      "mountType": {
        "descr": "крючок",
        "type": "hook"
      }
    },
    "right": {
      "length": 400,
      "mountType": {
        "descr": "крючок",
        "type": "hook"
      }
    }
  },
  "articles": [
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "2630035531",
      "goodsGroupCode": "oil_filter",
      "goodsGroupName": "масляные фильтры",
      "description": "Фильтр масляный",
      "fitAxle": null,
      "images": [
        {
          "name": "0541ea2c5fcc434f9b963d37c8abb769eaffc60002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "281131R100",
      "goodsGroupCode": "air_filter",
      "goodsGroupName": "воздушные фильтры",
      "description": "Фильтр воздушный",
      "fitAxle": null,
      "images": [
        {
          "name": "0632eda95f7db2c3dfd90f8f353335e06cb6bd0002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "971334L000",
      "goodsGroupCode": "cabin_filter",
      "goodsGroupName": "салонные фильтры",
      "description": "ФИЛЬТР САЛОНА",
      "fitAxle": null,
      "images": [
        {
          "name": "013c6463b0f56e061dcea348fd57f173d7f8780002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "311121R000",
      "goodsGroupCode": "fuel_filter",
      "goodsGroupName": "топливные фильтры",
      "description": "Фильтр топливный",
      "fitAxle": null,
      "images": [
        {
          "name": "05237f13cc871f85b31da285c8cfa17b5bd6890002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "581014LA00",
      "goodsGroupCode": "brake_pad",
      "goodsGroupName": "тормозные колодки",
      "description": "Колодки передние HYUNDAI Solaris 10-17 / KIA Rio 11-17",
      "fitAxle": "передняя ось",
      "images": [
        {
          "name": "067032b81f3f24b05516fa08c6624009b9c2dd0002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "517120U000",
      "goodsGroupCode": "brake_disk",
      "goodsGroupName": "тормозные диски",
      "description": "Диск тормозной передний HYUNDAI Solaris/KIA RIO III",
      "fitAxle": "передняя ось",
      "images": [
        {
          "name": "064555f12d8c1ec806f38f7068538b3be8d37c0002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "583021RA30",
      "goodsGroupCode": "brake_pad",
      "goodsGroupName": "тормозные колодки",
      "description": "Колодки тормозные задние",
      "fitAxle": "задняя ось",
      "images": [
        {
          "name": "057132725fadafb1b6dd94fefe8207e4b21b80002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "584110U300",
      "goodsGroupCode": "brake_disk",
      "goodsGroupName": "тормозные диски",
      "description": "Диск тормозной задний HYUNDAI Solaris 2010->/KIA Rio III",
      "fitAxle": "задняя ось",
      "images": [
        {
          "name": "014766ae0d0ccc01b9e4585765473ae42f775e0002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "584110U000",
      "goodsGroupCode": "brake_drum",
      "goodsGroupName": "тормозные барабаны",
      "description": "Тормозной барабан",
      "fitAxle": "задняя ось",
      "images": [
        {
          "name": "05cfeb6d7c7fc180275b48b3bd4ff07d898fa0002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "583503XA00",
      "goodsGroupCode": "brake_pad",
      "goodsGroupName": "тормозные колодки",
      "description": "Тормозные колодки",
      "fitAxle": null,
      "images": []
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "2151323001",
      "goodsGroupCode": "drain_plug_seal",
      "goodsGroupName": "прокладки пробки поддона двигателя",
      "description": "Прокладка сливной пробки",
      "fitAxle": null,
      "images": [
        {
          "name": "014ef63c6cf94b132dff348704b8c79ef78f480002.jpeg",
          "order": 0
        }
      ]
    },
    {
      "brandName": "Hyundai-KIA",
      "brandNumber": "1885510060",
      "goodsGroupCode": "spark_plugs",
      "goodsGroupName": "свечи зажигания",
      "description": "Свеча зажигания",
      "fitAxle": null,
      "images": [
        {
          "name": "019daa9a974c4cc7f4bf1e87e3532bffc2dd530002.jpeg",
          "order": 0
        }
      ]
    }
  ]
}
Описание ответа

Возвращается информацию о модификации (как в методе carbase/modifications), информацию по шинам, дискам и щёткам. Для шин и дисков возвращаются штатные (factory) и альтернативные размерности. Помимо привычных ТТХ шин и дисков (полный набор типоразмеров для перехода в ваш каталог шин и дисков) возвращается справочная информация о крепеже (bolt или nut, то есть для болта или гайки). Для щёток стеклоочистителей кроме длины левой/правой щётки возвращается тип крепления и текстовое описание для отображения пользователю. Эта информация тоже может быть использована для перехода в каталог щёток стеклоочистителя на вашем сайте. Массив запчастей для ТО содержит записи, в каждой записи:

Объект	Описание
brandName	Наименование бренда оригинального артикула
brandNumber	Оригинальный артикул
goodsGroupCode	Код товарной группы (может быть использован для быстрой фильтрации результатов)
goodsGroupName	Текстовое описание товарной группы
fitAxle	Ось установки (для товарных групп brake_pad/тормозные колодки, brake_disk/тормозные диски, brake_drum/тормозные барабаны, brake_pad_sensors/датчики износа тормозных колодок
description	Локализованное текстовое описание для артикула
images	Массив с изображениями артикула (может быть запрошено по адресу https://pubimg.4mycar.ru/images/image.name, например, полная версия, превью)





API.ABCP.Admin
Статья Обсуждение
Главная > API.ABCP.Admin
Содержание
API ABCP - Административный интерфейс
Все методы в данном разделе доступны ТОЛЬКО специальному пользователю со статусом API-администратор.

Данные для подключения к АПИ в роли API-администратора доступны на странице Настройки 🠊 Система 🠊 Данные для доступа к API (страница доступна только для администратора)

Заказы
Получение списка заказов
Операция: cp/orders

Метод: GET

Принимает в качестве параметров условия фильтрации заказов. Возвращает список заказов (в т.ч. список позиций заказа).

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
dateCreatedStart	Начальная дата размещения заказа в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
dateCreatedEnd	Конечная дата размещения заказа в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
dateUpdatedStart	Начальная дата последнего обновления заказа в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
dateUpdatedEnd	Конечная дата последнего обновления заказа в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
numbers	Массив номеров заказов
internalNumbers	Массив номеров заказов в учетной системе (например, в 1С). Используется только, если в параметрах запроса не задан numbers.
statusCode	Код статус позиции заказа (один или массив кодов). Будут выбраны заказы содержащие хотя бы одну позицию в данном статусе.
officeId	Идентификатор офиса (в ответе по параметру могут быть отфильтрованы заказы где этот офис выбран как самовывоз или если это офис клиента или если менеджер клиента, сделавшего заказ, относится к данному офису)
distributorOrderId	Идентификатор заказа у поставщика. В результате вернутся все заказы которые были отправлены поставщику под этим номером.
isCanceled	Флаг "Запрос на удаление позиции". 0 - запрос не был отправлен, 1 - запрос отправлен, 2 - запрос отклонен менеджером.
distributorId	Идентификатор (один или массив идентификаторов) поставщика. В результате вернутся все заказы, содержащие хотя бы одну позицию от указанного поставщика.
userId	Идентификатор клиента (покупателя). В результате вернутся все заказы, сделанные указанным клиентом.
withDeleted	Признак, возвращать ли в ответе удаленные заказы и позиции
format	Формат ответа. Доступные значения:
additional - дописывает к заказу данные клиента при гостевом заказе; к позициям добавляет значение vinQueryIds (см. ниже)
short - сокращенный вариант отображения без содержимого позиций заказов
count - возвращает только количество заказов по заданным условиям
status_only - возвращает только номер заказа, а в узле позиций: id, statusCode, brand, number, numberFix, code, quantityFinal
p - заказы содержатся в поле items, данные о количестве содержатся в поле count
limit	Количество возвращаемых записей заказов (число, по умолчанию - 1000).
Чтобы получить информацию о количестве записей используйте параметр format со значением p

skip	кол-во заказов, которые нужно пропустить. (число, по умолчанию - 0)
desc	обратное направление сортировки по ID заказа - наверху будет самый новый (булево, по умолчанию - false)
isArchive	Флаг "Архивности заказа", где 0 - активный заказ (не архивный), 1 - архивный заказ.
(По умолчанию возвращаются не архивные заказы. Если указать параметр 'isArchive=1', возвращаются заказы только из архива)

Если указан только параметр dateCreatedStart/dateUpdatedStart, будут выбраны все заказы начиная с этой даты. При указании фильтра по дате обновления, будут выбраны как новые заказы, так и обновленные, попадающие под действие фильтра.

Внимание!

По умолчанию количество возвращаемых записей ограничено 1000. Чтобы определить конкретное количество, используйте параметр format со значением p.

Если в запросе нет фильтра по дате, то, по умолчанию, ставится фильтр createdDate за последние 30 дней.

Пример запроса

https://demo.public.api.abcp.ru/cp/orders?userlogin=username&userpsw=md5pass&dateUpdatedStart=2013-08-02 00:00:00&statusCode=56233
Метод возвращает массив объектов вида:

Поле	Описание
number	Онлайн-номер заказа в портале
internalNumber	Номер заказа в учетной системе (например, в 1С)
userId	Идентификатор клиента на сайте
positionsQuantity	Количество позиций
sum	Сумма заказа
date	Дата заказа
dateUpdated	Дата обновления
comment	Комментарий к заказу
debt	Долг по оплате заказа
profileId	Идентификатор профиля клиента сделавшего заказ
paid	Признак равен 1 или true, если заказ был успешно оплачен онлайн на сайте.
deliveryAddressId	Идентификатор адреса доставки
deliveryAddress	Адрес доставки
deliveryOfficeId	Идентификатор офиса самовывоза
deliveryOffice	Офис самовывоза
deliveryTypeId	Идентификатор типа доставки
deliveryType	Тип доставки
paymentTypeId	Идентификатор типа оплаты
paymentType	Тип оплаты
deliveryCost	Стоимость доставки
shipmentDate	Дата отгрузки
userName	Имя покупателя
userFullName	Имя организации
basketId	Идентификатор корзины
basketName	Название корзины
managerId	id менеджера , если заказ был создан менеджером
userEmail	Электронная почта покупателя
userCode	Внутренний код пользователя
userMobile	Контактный телефон пользователя
wholeOrderOnly	Признак - 'Получить заказ целиком'
code	"Ячейка заказа", если подключена опция "Заказы: При обработке выводить пустую колонку для вывода дополнительной информации"
isDelete	Признак "удаленный заказ"
positions	Список позиций заказа.
notes	Список заметок заказа.
clientOrderNumber	Номер заказа во внутренней системе учета клиента
isOfficialDistributor	Признак официального дистрибьютора: true - да, false - нет. (если предоставлен поставщиком)
При использовании параметра format со значением p ответ на запрос содержит поля:

items	Cписок (массив) заказов, удовлетворяющих заданным фильтрам. Массив представляет собой список заказов, который был бы ответом запроса без использования параметра format со значением p.
count	Количество заказов, удовлетворяющих заданным фильтрам
Узел positions содержит массив объектов вида:

Поле	Описание
id	Уникальный идентификатор позиции в портале
code	Код позиции (произвольное значение)
brand	Имя производителя.
brandFix	Очищенное имя производителя
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
routeId	Идентификатор маршрута склада с которого производится заказ.
distributorId	Идентификатор поставщика с которого производится заказ.
distributorName	Имя поставщика с которого производится заказ.
distributorType	Тип поставщика: 20 -прайсовый, 22 - онлайн, 21 - дилерский прайс лист
distributorOrderId	Если был выполнен заказ по API из ПУ поставщику средствами платформы ABCP, данное поле будет содержать номер заказа у поставщика.
distributorOrderView	Если был выполнен заказ по API из ПУ поставщику средствами платформы ABCP, данное поле будет содержать закодированную информацию по отправленной позиции
supplierCode	Код поставки от Вашего поставщика, которому вы из ПУ отправляете заказ . В данном случае код поставки НЕ является ID маршрута поставщика, а содержит в себе информацию о коде поставки, который передает вам ваш поставщик. Тестирование online поставщика. Настройки поставщика. adkulan.kz (online). Поставщики - Google Chrome.jpg
dsRouteId	Маршрут поставщика
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором! Параметр из результатов search/article. Необходимо указывать при добавлении в заказ товаров от online-поставщиков для возможности дальнейшего перезаказа на сайте поставщика из ПУ.
description	Описание детали.
quantity	Заказываемое количество
quantityFinal	Итоговое заказываемое количество
isDelete	признак удаленной позиции
priceIn	Цена поставщика за единицу товара
priceOut	Цена продажи за единицу товара
oldPriceOut	Начальная цена продажи за единицу товара до ее изменения
priceRate	Курс перевода цены в валюту сайта
priceInSiteCurrency	Цена ПРОДАЖИ в валюте сайта
currencyInId	Идентификатор валюты покупки (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
currencyOutId	Идентификатор валюты продажи (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
deadline	Срок поставки в часах
deadlineMax	Гарантированный срок поставки в часах
comment	Комментарий к позиции
commentAnswer	Ответ на комментарий к позиции
status	Статус позиции заказа
statusCode	Код статуса позиции заказа
statusChangeDate	Дата выставления статуса
isCanceled	Флаг "Запрос на удаление позиции". 0 - запрос не был отправлен, 1 - запрос отправлен, 2 - запрос отклонен менеджером.
dateUpdated	Дата обновления
lineReference	Дополнительная информация (если было разделение позиции в ПУ то splitPositionId - id позиции от которой отделили текущую)
weight	Вес товара
volume	Объем товара
articleCode	Внутренний код детали (присутствует только при условии что код выгружается в прайсе поставщика), используется как правило для синхронизации с 1С
isDelete	Признак "удаленная позиция"
noReturn	признак невозвратности позици 1- нельзя вернуть, 0 - можно вернуть
locationsFullCodes	системное поле ( коды ячеек хранения в ТС)
garageCarId	Идентификатор автомобиля из гаража
vinQueryIds	Если format=additional. Содержит массив идентификаторов vin-запросов Vinqu. Если позиция добавлена в заказ по ссылке из vin-запроса.
Узел notes содержит массив объектов вида:

Поле	Описание
id	Уникальный идентификатор заметки
date	Дата создания
author	Имя автора(сотрудника) создавшего заметку
value	Текст заметки
Получение информации о заказе
Операция: cp/order

Метод: GET

Принимает в качестве параметра онлайн-номер заказа. Возвращает информацию о заказе (в т. ч. список позиций заказа).

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
number	Онлайн-номер заказа
internalNumber	Номер заказа в учетной системе (например, в 1С). Используется только, если в параметрах запроса не задан number.
withDeleted	Признак, возвращать ли в ответе удаленные заказы и позиции
format	Формат ответа. Доступные значения: additional - к заказу будет дописан массив additional, содержащий данные клиента при гостевом заказе.
Пример запроса

https://demo.public.api.abcp.ru/cp/order?userlogin=username&userpsw=md5pass&number=75892367
Метод возвращает объект вида:

Поле	Описание
number	Онлайн-номер заказа в портале
internalNumber	Номер заказа в учетной системе (например, в 1С)
userId	Идентификатор клиента на сайте
userName	Имя клиента
userFullName	Имя организации
positionsQuantity	Количество позиций
sum	Сумма заказа
date	Дата заказа
comment	Комментарий к заказу
debt	Долг по оплате заказа
paid	Признак равен 1 или true, если заказ был успешно оплачен онлайн на сайте.
dateUpdated	Дата обновления
profileId	Идентификатор профиля клиента сделавшего заказ
deliveryAddressId	Идентификатор адреса доставки
deliveryAddress	Адрес доставки
deliveryOfficeId	Идентификатор офиса самовывоза
deliveryOffice	Офис самовывоза
deliveryTypeId	Идентификатор типа доставки
deliveryType	Тип доставки
paymentTypeId	Идентификатор типа оплаты
paymentType	Тип оплаты
deliveryCost	Стоимость доставки
shipmentDate	Дата отгрузки
basketId	Идентификатор корзины
basketName	Название корзины
managerId	id менеджера , если заказ был создан менеджером
additional	Может хранить в себе инфо об id сотрудника который оформил заказ на клиента, суммарный вес, признак только весь заказ и многое другое.
Если заказ был выполнен под гостем, может содержать данные гостя, которые он указал при заказе.

userEmail	Электронная почта покупателя
userCode	Внутренний код пользователя
code	"Ячейка заказа", если подключена опция "Заказы: При обработке выводить пустую колонку для вывода дополнительной информации"
wholeOrderOnly	Признак - 'Получить заказ целиком'
isDelete	Признак "удаленный заказ"
positions	Список позиций заказа.
notes	Список заметок заказа.
clientOrderNumber	Номер заказа клиента в его внутренней системе учета
isOfficialDistributor	Признак официального дистрибьютора: true - да, false - нет. (если предоставлен поставщиком)
Узел notes содержит массив объектов описанных здесь

Узел positions содержит массив объектов вида:

Поле	Описание
id	Уникальный идентификатор позиции в портале
code	Код позиции (произвольное значение)
brand	Имя производителя.
brandFix	Очищеное имя производителя
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
routeId	Идентификатор маршрута склада с которого производится заказ.
distributorId	Идентификатор поставщика с которого производится заказ.
distributorName	Имя поставщика с которого производится заказ.
distributorType	Ти поставщика:20 - прайсовый, 21- дилерский прайс лист, 22- онлайн поставщик
distributorOrderId	Если был выполнен перезаказ у поставщика средствами платформы ABCP, данное поле будет содержать номер заказа у поставщика.
distributorOrderView	Если был выполнен заказ по API из ПУ поставщику средствами платформы ABCP, данное поле будет содержать закодированную информацию по отправленной позиции
supplierCode	Код поставки от Вашего поставщика, которому вы из ПУ отправляете заказ . В данном случае код поставки НЕ является ID маршрута поставщика, а содержит в себе информацию о коде поставки, который передает вам ваш поставщик.
Тестирование online поставщика. Настройки поставщика. adkulan.kz (online). Поставщики - Google Chrome.jpg

dsRouteId	ID маршрута поставщика
locationsFullCodes	системное поле ( коды ячеек хранения в ТС)
itemKey	Код позиции. Внимание! Не является уникальным идентификатором! Параметр из результатов search/article. Необходимо указывать при добавлении в заказ товаров от online-поставщиков для возможности дальнейшего перезаказа на сайте поставщика из ПУ.
description	Описание детали.
quantity	Заказываемое количество
quantityFinal	Итоговое количество
priceIn	Цена поставщика за единицу товара
priceOut	Цена продажи за единицу товара
oldPriceOut	Начальная цена продажи за единицу товара до внесения изменений
priceRate	Курс перевода цены в валюту сайта
priceInSiteCurrency	Цена ПРОДАЖИ в валюте сайта
currencyInId	Идентификатор валюты покупки (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
currencyOutId	Идентификатор валюты продажи (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
deadline	Срок поставки в часах
deadlineMax	Гарантированный срок поставки в часах
comment	Комментарий к позиции
commentAnswer	Ответ на комментарий к позиции
status	Статус позиции заказа
statusCode	Код статуса позиции заказа
statusChangeDate	Дата изменения статуса
isCanceled	Флаг "Запрос на удаление позиции".0 - запрос не был отправлен, 1 - запрос отправлен, 2 - запрос отклонен менеджером.
dateUpdated	Дата обновления
lineReference	Дополнительная информация (если было разделение позиции в ПУ то splitPositionId - id позиции от которой отделили текущую)
weight	Вес товара
volume	объем товара
articleCode	Внутренний код детали (присутствует только при условии что код выгружается в прайсе поставщика), используется как правило для синхронизации с 1С
garageCarId	Идентификатор автомобиля из гаража
isDelete	Признак "удаленная позиция"
noReturn	признак невозвратности позиции: 1 - нельзя вернуть, 0 - вернуть можно
vinQueryIds	Массив идентификаторов vin-запросов Vinqu. Если позиция добавлена в заказ по ссылке из vin-запроса.
Получение истории изменений статуса позиции заказа
Операция: cp/order/statusHistory

Метод: GET

Принимает в качестве параметра id позиции заказа. Возвращает информацию об истории изменений статуса позиции заказа.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
positionId	Номер позиции заказа
Пример запроса

https://demo.public.api.abcp.ru/cp/order/statusHistory?userlogin=username&userpsw=md5pass&positionId=123456789
Метод возвращает объект вида:

Поле	Описание
statusCode	Идентификационный номер статуса
status	Название статуса
datetime	Дата и время изменения статуса
managerId	Идентификационный номер автора изменения
managerName	Имя автора изменения


Пакетное получение истории изменений статусов позиций заказов
Операция: cp/orders/statusHistory

Метод: GET

Принимает в качестве параметра массив id позиций заказа. Позиции могут быть из разных заказов. Возвращает информацию об истории изменений статуса позиций заказов.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
positionsId	Массив id позиций заказа
Пример запроса

https://demo.public.api.abcp.ru/cp/orders/statusHistory?userlogin=username&userpsw=md5pass&&positionsId%5B0%5D=469961941&positionsId%5B1%5D=162283919
Метод возвращает объект вида:

positions - представляет собой узел, который содержит информацию по принятым positionsId, в которых в свою очередь содержится инфо по статусам

Поле	Описание
id	Id позиции
statusCode	Идентификационный номер статуса
status	Название статуса
datetime	Дата и время изменения статуса
managerId	Идентификационный номер автора изменения
managerName	Имя автора изменения

Достать заказ из архива

Операция: cp/orders/fromArchive

Метод: POST

Метод предназначен для извлечения заказов из архива.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
orders	Массив номеров заказов, которые нужно достать из архива
Пример запроса

https://demo.public.api.abcp.ru/cp/orders/fromArchive
Тело POST запроса

userlogin=username&userpsw=md5pass&orders[0]=123456789&orders[1]=987654321
Описание ответа

Метод возвращает статус 200 в случае успешного выполнения операции.

Иначе возвращается статус отличный от 200 и объект с полями:

Параметр	Описание
errorCode	Код ошибки
errorMessage	Текст сообщения об ошибке
Вернуть заказ в архив

Операция: cp/orders/toArchive

Метод: POST

Метод предназначен для возврата заказов в архив.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
dateTime	Перенос всех заказов в архив до указанной даты. Дата в формате ГГГГ-ММ-ДД
Пример запроса

https://demo.public.api.abcp.ru/cp/orders/toArchive
Тело POST запроса

userlogin=username&userpsw=md5pass&dateTime=2023-09-30
Описание ответа

Метод возвращает статус 200 в случае успешного выполнения операции.

Иначе возвращается статус отличный от 200 и объект с полями:

Параметр	Описание
errorCode	Код ошибки
errorMessage	Текст сообщения об ошибке
Сохранение заказа
Операция: cp/order

Метод: POST

Универсальный метод сохранения. Принимает в качестве параметра объект описывающий заказ. Для создания заказа от имени Гостя, необходимо передавать корректно заполненные параметры: guestOrderName и guestOrderMobile или guestOrderEmail, в зависимости от обязательности полей "Мобильный" или "Email" в форме создания гостевого заказа.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
order	Объект описывающий заказ
clientOrderNumber	Необязательный параметр - номер заказа в системе учета клиента
Объект описывающий заказ содержит следующие поля

Поле	Описание
number	Онлайн-номер заказа в портале
internalNumber	Внутренний номер заказа в учетной системе (например, в 1С)
userId	Идентификатор клиента на сайте, для которого создается заказ
date	Дата заказа
comment	Комментарий к заказу
deliveryTypeId	Тип доставки (изменения возможны только если нет привязок платежей)
deliveryOfficeId	Идентификатор офиса самовывоза
basketId	Необязательный параметр - идентификатор корзины при использовании мультикорзины
guestOrderName	Необязательный параметр - имя клиента для оформления заказа от имени Гостя. Для корректного оформления заказа под гостем должны быть указаны параметры guestOrderName и guestOrderMobile.
guestOrderMobile	Необязательный параметр - контактный телефон клиента для оформления заказа от имени Гостя. (в формате 70000000000). Для корректного оформления заказа под гостем должны быть указаны параметры guestOrderName и guestOrderMobile.
shipmentDate	Дата отгрузки.
deliveryCost	Стоимость доставки. Необязательный параметр
paid	Признак может иметь значение 0 или 1 (false, true). 1 = заказ оплачен онлайн. Необязательный параметр.
deliveryAddressId	Число. Идентификатор адреса доставки. Если нужно создать новый адрес, то нужно передать "-1" и в параметре deliveryAddress новый адрес доставки.
deliveryAddress	Текст. Адрес доставки, в случае, когда необходимо сразу создать новый адрес нужно в deliveryAddressId передавать "-1" + адрес доставки
managerId	id менеджера по заказу
positions	Список позиций заказа.
notes	Список заметок заказа.
clientOrderNumber	Номер заказа в системе учета клиента
Если передан онлайн-номер, заказ будет отредактирован. Если передан внутренний номер заказа в учетной системе, портал попробует найти заказ с этим номером и при наличии отредактирует его, иначе - создаст новый заказ. Если не передан ни онлайн-номер, ни внутренний номер, метод вернет ошибку. Для корректного оформления заказа на имя гостя должны быть переданы параметры guestOrderName и guestOrderMobile или guestOrderEmail. В случае редактирования, все поля кроме number или internalNumber являются необязательными - указанные будут изменены. В случае создания нового заказа, поля internalNumber, userId, date и positions являются обязательными. Параметр userId (или guestOrderName и guestOrderMobile или guestOrderEmail для гостевого заказа) будет использоваться только при создании заказа, при редактировании будет проигнорирован (сменить владельца заказа невозможно).

Узел positions содержит массив объектов вида:

Поле	Описание
id	Уникальный идентификатор позиции в портале
code	Код позиции (произвольное значение)
brand	Имя производителя.
number	Номер детали (код производителя).
description	Описание детали.
quantity	Заказываемое количество
quantityFinal	Итоговое количество
priceIn	Цена поставщика за единицу товара
priceOut	Цена продажи за единицу товара
priceRate	Курс перевода цены в валюту сайта
deadline	Срок поставки в часах
deadlineMax	Гарантированный срок поставки в часах
deadlineInfo	Текстовый срок поставки
routeId	Идентификатор маршрута склада с которого производится заказ. Значение нужно брать из поля supplierCode операции поиска search/articles
supplierCode	Код склада поставщика, которому Вы отправляете заказ (НЕ ID маршрута). Его необходимо указывать только при редактировании заказа, если вы хотите его переопределить. В иных случаях значение заполняется автоматически на основе переданного itemKey. При создании заказа параметр передавать не нужно. Если в имеющемся заказе значение будет пустым, то такую позицию нельзя будет отправить в заказ онлайн поставщику.
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором! Параметр из результатов search/article. Необходимо указывать при добавлении в заказ товаров от online-поставщиков для возможности дальнейшего перезаказа на сайте поставщика из ПУ.
comment	Комментарий к позиции
commentAnswer	Ответ на комментарий к позиции, "Ваш ответ"
statusCode	Код статуса позиции заказа
articleCode	Внутренний код детали
garageCarId	Идентификатор автомобиля из гаража
delete	если передать значение 1, позиция будет удалена, в остальных случаях устанавливать не надо.
isCanceled	Может принимать следующие значения: 0 - удаление не запрашивалось; 1 - клиентом запрошено удаление; 2 - в удалении отказано менеджером
vinQueryIds	Массив числовых идентификаторов vin-запросов Vinqu. Необязательный параметр.
Узел notes содержит массив объектов вида:

Поле	Описание
id	Идентификатор заметки
employeeId	Идентификатор сотрудника от имени которого создастся заметка. Если значение пустое или не корректное - в качестве автора будет "API администратор"
value	Текст заметки.
Заметки можно только добавить либо удалить. Для удаления - необходимо передать идентификатор заметки и пустое значение для поля value. Для добавления - необходимо указать value. employeeId - если нужно указать конкретного сотрудника а не "API администратора"

В случае редактирования заказа, могут быть указаны только позиции и поля, которые требуют изменения. В случае создания заказа, должны быть указаны все позиции со всеми полями (кроме полей comment, supplierCode и itemKey). При редактировании позиций обязательна передача параметра id. Если параметр id не передан, будет добавлена новая позиция. При добавлении позиции необходимо задать ей минимальные обязательные параметры для возможности дальнейшей работы с ней: бренд, номер, код статуса, количество, цену, код склада поставщика, идентификатор маршрута, сроки поставки. Для удаления позиции необходимо указать ей количество 0 или установить параметр delete в значение 1.



vertical-align:middle;
Внимание!
Не выполняйте данную операцию параллельно в несколько потоков при создании заказов. В данном варианте использования необходимо выполнять ее только последовательно
vertical-align:middle;
Внимание!
При большом количестве позиций настоятельно рекомендуется сохранять пакетами не более чем по 100 позиций
vertical-align:middle;
Внимание!
Для этой операции существует ограничение на 500 позиций для одного заказа. При попытке добавить большее количество позиций, операция для этих позиций завершится с ошибкой
Пример запроса

https://demo.public.api.abcp.ru/cp/order
Параметры POST

userlogin=username&userpsw=md5pass&order[number]=5623478&order[internalNumber]=786593&order[positions][0][statusCode]=15&order[positions][0][id]=653463&order[positions][0][quantity]=10&order[notes][0][value]=текст заметки
Метод возвращает объект вида:

Поле	Описание
number	Онлайн-номер заказа в портале
internalNumber	Номер заказа в учетной системе (например, в 1С)
userId	Идентификатор клиента на сайте, для которого создается заказ
positionsQuantity	Количество позиций
sum	Сумма заказа
date	Дата заказа
debt	Долг по оплате заказа
paid	Признак равен 1 или true, если заказ был успешно оплачен онлайн на сайте.
comment	Комментарий к заказу
dateUpdated	Дата обновления
profileId	Идентификатор профиля клиента сделавшего заказ
deliveryAddressId	Идентификатор адреса доставки
deliveryAddress	Адрес доставки
deliveryOfficeId	Идентификатор офиса самовывоза
deliveryOffice	Офис самовывоза
deliveryTypeId	Идентификатор типа доставки
deliveryType	Тип доставки
paymentTypeId	Идентификатор типа оплаты
paymentType	Тип оплаты
deliveryCost	Стоимость доставки
managerId	id менеджера , если заказ был создан менеджером
userCode	Внутренний код пользователя
code	"Ячейка заказа", если подключена опция "Заказы: При обработке выводить пустую колонку для вывода дополнительной информации"
positions	Список позиций заказа.
Узел positions содержит массив объектов вида:

Поле	Описание
id	Уникальный идентификатор позиции в портале
code	Код позиции (произвольное значение)
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
routeId	Идентификатор маршрута склада с которого производится заказ.
distributorId	Идентификатор поставщика с которого производится заказ.
distributorName	Имя поставщика с которого производится заказ.
supplierCode	(УСТАРЕЛО используйте для чтения значение dsRouteId) Код склада поставщика.
dsRouteId	Код склада поставщика. Если в имеющемся заказе значение будет пустым, то такую позицию нельзя будет отправить в заказ онлайн поставщику.
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором! Параметр из результатов search/article. Необходимо указывать при добавлении в заказ товаров от online-поставщиков для возможности дальнейшего перезаказа на сайте поставщика из ПУ.
description	Описание детали.
quantity	Заказываемое количество
quantityFinal	Итоговое количество
priceIn	Цена поставщика за единицу товара
priceOut	Цена продажи за единицу товара
oldPriceOut	Начальная цена продажи за единицу товара до внесения изменений
priceRate	Курс перевода цены в валюту сайта
deadline	Срок поставки в часах
deadlineMax	Гарантированный срок поставки в часах
comment	Комментарий к позиции
commentAnswer	Ответ на комментарий к позиции
status	Статус позиции заказа
statusCode	Код статуса позиции заказа
isCanceled	Флаг "Запрос на удаление позиции"
dateUpdated	Дата обновления
lineReference	Дополнительная информация (если было разделение позиции в ПУ то splitPositionId - id позиции от которой отделили текущую)
weight	Вес товара
articleCode	Внутренний код детали (присутствует только при условии что код выгружается в прайсе поставщика), используется как правило для синхронизации с 1С
garageCarId	Идентификатор автомобиля из гаража
currencyInId	Идентификатор валюты покупки (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
currencyOutId	Идентификатор валюты продажи (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
vinQueryIds	Массив числовых идентификаторов vin-запросов Vinqu. Необязательный параметр.
При возникновении ошибки в процессе сохранения заказа, помимо ответа с актуальным содержимым текущего заказа, будет возвращен узел errors, содержащий описание возникшей ошибки.



Объединение заказов
Данная операция работает только в случае использования на сайте опции Заказы: вручную объединять заказы в ПУ

Операция работает аналогично ручному объединению через ПУ, имеет лимит на объединение не более 50 позиций за раз. Статистика вызовов в этой операции относится к операции "orders". Photo 2024-04-18 18-57-46.jpg

Операция: cp/order/merge

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
orderId	Номер основного заказа, в который в итоге нужно объединить указанные позиции
positionIds	Массив ID позиций разных заказов, которые нужно объединить в один
Пример запроса

https://demo.public.api.abcp.ru/cp/order/merge
Параметры POST

userlogin=username&userpsw=md5pass&orderId=5623478&positionIds[0]=11111&positionIds[1]=222222
Метод возвращает объект вида:

Поле	Описание
number	Онлайн-номер заказа в портале
internalNumber	Номер заказа в учетной системе (например, в 1С)
userId	Идентификатор клиента на сайте, для которого создается заказ
positionsQuantity	Количество позиций
sum	Сумма заказа
date	Дата заказа
debt	Долг по оплате заказа
paid	Признак равен 1 или true, если заказ был успешно оплачен онлайн на сайте.
comment	Комментарий к заказу
dateUpdated	Дата обновления
profileId	Идентификатор профиля клиента сделавшего заказ
deliveryAddressId	Идентификатор адреса доставки
deliveryAddress	Адрес доставки
deliveryOfficeId	Идентификатор офиса самовывоза
deliveryOffice	Офис самовывоза
deliveryTypeId	Идентификатор типа доставки
deliveryType	Тип доставки
paymentTypeId	Идентификатор типа оплаты
paymentType	Тип оплаты
deliveryCost	Стоимость доставки
managerId	id менеджера , если заказ был создан менеджером
userCode	Внутренний код пользователя
code	"Ячейка заказа", если подключена опция "Заказы: При обработке выводить пустую колонку для вывода дополнительной информации"
positions	Список позиций заказа.
Узел positions содержит массив объектов вида:

Поле	Описание
id	Уникальный идентификатор позиции в портале
code	Код позиции (произвольное значение)
brand	Имя производителя.
number	Номер детали (код производителя).
numberFix	"Очищенный" код детали, содержащий только алфавитные и цифровые символы, и, иногда, знак слеша "/".
routeId	Идентификатор маршрута склада с которого производится заказ.
distributorId	Идентификатор поставщика с которого производится заказ.
distributorName	Имя поставщика с которого производится заказ.
supplierCode	(УСТАРЕЛО используйте для чтения значение dsRouteId) Код склада поставщика.
dsRouteId	Код склада поставщика. Если в имеющемся заказе значение будет пустым, то такую позицию нельзя будет отправить в заказ онлайн поставщику.
itemKey	Код позиции. Необходим для добавления товара в корзину. Внимание! Не является уникальным идентификатором! Параметр из результатов search/article. Необходимо указывать при добавлении в заказ товаров от online-поставщиков для возможности дальнейшего перезаказа на сайте поставщика из ПУ.
description	Описание детали.
quantity	Заказываемое количество
quantityFinal	Итоговое количество
priceIn	Цена поставщика за единицу товара
priceOut	Цена продажи за единицу товара
oldPriceOut	Начальная цена продажи за единицу товара до внесения изменений
priceRate	Курс перевода цены в валюту сайта
deadline	Срок поставки в часах
deadlineMax	Гарантированный срок поставки в часах
comment	Комментарий к позиции
commentAnswer	Ответ на комментарий к позиции
status	Статус позиции заказа
statusCode	Код статуса позиции заказа
isCanceled	Флаг "Запрос на удаление позиции"
dateUpdated	Дата обновления
lineReference	Дополнительная информация (если было разделение позиции в ПУ то splitPositionId - id позиции от которой отделили текущую)
weight	Вес товара
articleCode	Внутренний код детали (присутствует только при условии что код выгружается в прайсе поставщика), используется как правило для синхронизации с 1С
garageCarId	Идентификатор автомобиля из гаража
currencyInId	Идентификатор валюты покупки (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
currencyOutId	Идентификатор валюты продажи (1-Российский рубль 2- Евро 3- Доллар США 4- Гривна Украины 5- Литовский лит 6- Белорусский рубль (до 1 июля 2016) 7- Казахстанский тенге 8- Латвийский лат 9- Японская иена 10- Китайский юань 11- Армянский драм 12- Киргизский сом 13- Азербайджанский манат 14- Белорусский рубль)
vinQueryIds	Массив числовых идентификаторов vin-запросов Vinqu. Необязательный параметр.
Заказ поставщику
Получение параметров для отправки online-заказа поставщику
Операция: cp/orders/online

Метод: GET

Это вспомогательная операция, которую необходимо выполнять перед отправкой online-заказа поставщику. Если для поставщика есть дополнительные параметры заказа или позиций заказа, то в ответ вы получите набор данных. На их основании нужно составить API запрос для отправки заказа. Если вы уже определились с какими параметрами будете отправлять заказы поставщику, то эту операцию вызывать нет необходимости, можно сразу переходить к методу отправки заказа.

Идентификаторы позиций, которые необходимо передавать в запросе, должны принадлежать одному поставщику. Т.е. за один API запрос операции cp/orders/online можно отправить позиции только одного поставщика. Если вам необходимо отправить позиции для двух поставщиков, то необходимо предварительно сгруппировать идентификаторы позиций и выполнить два запроса к cp/orders/online по каждому из поставщиков.

Кол-во идентификаторов позиций в одном запросе ограничено. За один API запрос отправить в заказ можно не более 20 позиций для сторонних поставщиков. Для поставщиков работающих на платформе ABCP ограничение - 100 позиций.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
positionIds	Массив идентификаторов позиций, которые нужно отправить поставщику
orderParams[shipmentAddress]	Необязательный параметр. Идентификатор адреса доставки, если не используется самовывоз. Актуально для некоторых поставщиков, которые передают список адресов доставки в параметре shipmentAddress и используют даты отгрузки shipmentDate. В зависимости от переданного id адреса вы получите в ответ корректные даты отгрузки. Если вы не знаете идентификатор адреса доставки, то сначала выполните запрос без него, возьмите нужное значение из fieldName: shipmentAddress -> enum -> value. После этого повторно отправьте запрос уже с указанием orderParams[shipmentAddress]=ID_адреса.
Параметры ответа

Возвращает карту параметров для заказа и позиции отдельно. У всех поставщиков набор параметров разный. У некоторых поставщиков может не быть параметров заказа или позиций.

Параметр	Тип	Описание
orderParams	array	Массив объектов параметров заказа поставщика.
positionParams	array	Массив объектов параметров позиции поставщика.
Объект параметра заказа поставщику:

Параметр	Тип	Описание
fieldName	string	Название параметра, который должен быть передан в запрос для отправки заказа поставщику.
type	string	Тип параметра. Возможные варианты: enum, string, text, bool, datepicker. Описание типов:
Параметр	Описание
enum	Перечисляемый тип. Для параметра заказа этого типа передается массив enum, в котором указаны возможные значения этого параметра. Структура enum описана в таблице ниже.
string	Текстовое значение с одной строкой.
text	Текстовое значение с несколькими строками.
bool	Булевый тип. Возможные значение true/false или 1/0.
datepicker	Поле для передачи даты в формате ГГГГ-ММ-ДД.
name	string	Название параметра.
description	string	Описание параметра.
value	string	Значение параметра по умолчанию, используется для всех типов параметров, кроме enum. Доступно для некоторых поставщиков в соответствии с вашими настройками заданных в панели управления ABCP.
enum	array	Массив объектов enum параметра заказа. Для остальных типов параметров - пустой массив.
Объект enum параметра заказа поставщика:

Параметр	Тип	Описание
value	string	Значение параметра.
name	string	Название для отображения.
selected	bool	Если true, значит это значение параметра задано по умолчанию.
Объект параметра позиции поставщика:

Параметр	Тип	Описание
fieldName	string	Название параметра, который должен быть передан в запрос для отправки заказа поставщику.
type	string	Тип параметра. Возможные варианты: string, bool. Описание типов:
Параметр	Элемент формы
string	Текстовое значение с одной строкой.
bool	Булевый тип. Возможные значение true/false или 1/0.
name	string	Название параметра для отображения в интерфейсе.
description	string	Описание параметра для отображения в интерфейсе.
Пример запроса

https://demo.public.api.abcp.ru/cp/orders/online?userlogin=username&userpsw=md5pass&positionIds[]=151056634&positionIds[]=151056635
Пример ответа

{
    "orderParams": [
        {
            "fieldName": "shipmentAddress",
            "type": "enum",
            "name": "Адрес доставки",
            "description": "",
            "value": "",
            "enum": [
                {
                    "value": "0",
                    "name": "Выберите адрес доставки или укажите другой адрес ниже",
                    "selected": false
                },
                {
                    "value": "77333",
                    "name": "Москва, ул. Ленина 1",
                    "selected": false
                }
            ]
        },
        {
            "fieldName": "comment",
            "type": "text",
            "name": "Комментарий",
            "description": "",
            "value": "",
            "enum": []
        },
        {
            "fieldName": "deliveryType",
            "type": "enum",
            "name": "Тип отгрузки*",
            "description": "",
            "value": "",
            "enum": [
                {
                    "value": "3",
                    "name": "Доставка",
                    "selected": false
                },
                {
                    "value": "2",
                    "name": "Самовывоз",
                    "selected": false
                }
            ]
        },
        {
            "fieldName": "deliveryDate",
            "type": "datepicker",
            "name": "Дата доставки*",
            "description": "",
            "value": "",
            "enum": []
        },
        {
            "fieldName": "deliveryTime",
            "type": "enum",
            "name": "Время доставки*",
            "description": "",
            "value": "",
            "enum": [
                {
                    "value": "1",
                    "name": "до 15:00",
                    "selected": false
                },
                {
                    "value": "2",
                    "name": "после 15:00",
                    "selected": false
                }
            ]
        },
        {
            "fieldName": "contactName",
            "type": "string",
            "name": "Контактное лицо",
            "description": "",
            "value": "",
            "enum": []
        }
    ],
    "positionParams": [
        {
            "fieldName": "comment",
            "type": "string",
            "name": "Комментарий",
            "description": ""
        }
    ]
}
Отправка online-заказа поставщику
Операция: cp/orders/online

Метод: POST

Идентификаторы позиций, которые необходимо передавать в запросе, должны принадлежать одному поставщику. Т.е. за один API запрос операции cp/orders/online можно отправить позиции только одного поставщика. Если вам необходимо отправить позиции для двух поставщиков, то необходимо предварительно сгруппировать идентификаторы позиций и выполнить два запроса к cp/orders/online по каждому из поставщиков.

Кол-во идентификаторов позиций в одном запросе ограничено. За один API запрос отправить в заказ можно не более 20 позиций для сторонних поставщиков. Для поставщиков работающих на платформе ABCP ограничение - 100 позиций.

В ответ вы можете получить один или несколько созданных заказов.

Отправка заказа аналогична отправке из панели управления. Если заказ оформлен успешно, то результат фиксируется в панели управления, чекбокс заменятся на номер заказа поставщика и его статус (если поставщик поддерживает передачу статуса). Если настроена синхронизация статусов, она также активируется для отправленных позиций.

Внимание! При работе с API поставщика, в большинстве случаев используется общая корзина при работе с сайтом поставщика и при работе с API. При отправке заказа поставщику последовательно выполняются запросы по предварительной очистке корзины, добавлению товара в корзину, чтение и отправка её в заказ. Очень важно не допустить параллельной отправки разных позиций одному поставщику. Так же в момент отправки заказа поставщику не должна производиться отправка заказов из панели управления abcp и работа с корзиной на сайте поставщика. В противном случае вы можете получить некорректные заказы, ошибки и задвоенные заказы с одинаковыми товарами.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
orderParams	Массив параметров заказа, который нужно сформировать на основе операции "Получение параметров для отправки online-заказа поставщику". Если у поставщика нет параметров заказа, то параметр orderParams необязательный.
positions	Массив данных с позициями заказов. Структура одного элемента массива в таблице ниже.
Объект позиции заказа

Параметр	Описание
id	Идентификатор отправляемой позциии заказа.
positionParams	Массив параметров позиции, который нужно сформировать на основе операции "Получение параметров для отправки online-заказа поставщику". Если у поставщика нет параметров для позиций заказа, то параметр positionParams необязательный.
Параметры ответа

В ответе приходит массив заказов.

Объект заказа поставщика:

Параметр	Тип	Описание
number	string	Номер заказа.
status	string	Текстовое описание состояния заказа. Будет описание ошибки или что заказ оформлен успешно.
date	string	Дата создания заказа [ГГГГ-ММ-ДД ЧЧ:ММ:СС].
positions	array	Массив объектов позиций.
Объект позиции заказа поставщика:

Параметр	Тип	Описание
reference	string	В этом поле возвращается идентификатор позиции, которую вы отправляли.
id	int	Идентификатор позиции поставщика. Значение возвращается только для поставщиков работающих на платформе ABCP, для остальных будет возвращаться ноль.
brand	string	Бренд детали.
number	string	Артикул детали.
numberFix	string	Артикул детали, без спец. символов.
description	string	Описание детали.
supplierCode	string	Код маршрута поставщика.
quantity	int	Заказанное кол-во деталей.
price	float	Цена заказанной детали, в валюте сайта. Здесь может быть старая цена, по которой позиция отправлялась поставщику. Так и новая цена, которую поставщик передал, в случае её изменения. Для разных поставщиков разное поведение, поэтому цену можно использовать только в информационных целях, использовать её для финансовых расчётов недопустимо. Актуальную цену можно узнать обратившись к серверу поставщика через его API напрямую.
status	array	Массив результатов отправки позиции. Здесь могут передаваться ошибки, если они возникают в ходе отправки заказа. А также предупреждения об изменении цены и т.д.
confirmSend	bool	Если true значит позиция заказана у поставщика. Если false - значит произошла ошибка. Внимание! Даже если произошла ошибка, то заказ всё равно может быть создан на стороне поставщика. Мы опираемся на ответ, который получили или не получили от них. Если мы получили некорректный ответ или не дождались ответа от сервера поставщика, то считаем что заказ не создан. Не отправляйте запросы на отправку заказа поставщику повторно, пока не убедитесь в его отсутствии на стороне поставщика. Если сервер поставщика "завис" в момент запроса, то заказ может быть создан даже через несколько минут после отправки запроса. Не допускайте автоматизированной отправки дублей по заказам!
Пример запроса

https://demo.public.api.abcp.ru/cp/orders/online
Параметры POST Запрос сформирован на основе примера ответа операции "Получение параметров для отправки online-заказа поставщику".

orderParams[shipmentAddress]=77333&orderParams[comment]=Мой комментарий к заказу&orderParams[deliveryType]=3&orderParams[deliveryDate]=2020-06-26&orderParams[deliveryTime]=2&orderParams[contactName]=Иванов Иван&positions[0][id]=151056634&positions[0][positionParams][comment]=Мой комментарий к позиции 151056634&positions[1][id]=151056635&positions[1][positionParams][comment]=Мой комментарий к позиции 151056635
Пример ответа

[
    {
        "number": "49685780",
        "status": "Принят",
        "date": "2020-06-26 12:10:16",
        "positions": [
            {
                "reference": "151056634",
                "id": 153014210,
                "brand": "Febi",
                "number": "01089",
                "numberFix": "01089",
                "description": "Антифриз зелёно-синий 1,5L VW-Audi",
                "supplierCode": "27185",
                "quantity": 1,
                "price": 350,
                "status": [
                    "Позиция успешно добавлена в корзину",
                    "Изменение цены 370 -> 350",
                    "Позиция успешно отправлена в заказ"
                ],
                "confirmSend": true
            }
        ]
    },
    {
        "number": "с ошибкой #1",
        "status": "Статус заказа не определен",
        "date": "2020-06-26 12:10:16",
        "positions": [
            {
                "reference": "151056635",
                "id": 0,
                "brand": "Mahle/Knecht",
                "number": "OC90",
                "numberFix": "OC90",
                "description": "Фильтр масляный Opel",
                "supplierCode": "27185",
                "quantity": 10,
                "price": 92,
                "status": [
                    "Позиция успешно добавлена в корзину",
                    "Ошибка при отправке заказа: Нет нужного кол-ва"
                ],
                "confirmSend": false
            }
        ]
    }
]
Пример ответа с общей ошибкой

{
    "errorCode": 200,
    "errorMessage": "Позиция 151056635 уже была отправлена поставщику в заказ ранее."
}
Финансы
Обновление баланса клиента
Операция: cp/finance/userBalance

Метод: POST

Изменяет баланс клиента. Принимает в качестве параметра текущий баланс пользователя (float) в валюте сайта и идентификатор пользователя на сайте. Идентификатор пользователя - это уникальное значение для всей системы, которое может не совпадать со значением поля "Код клиента" в карточке клиента. Узнать его можно, либо из URL карточки клиента, например, https://cp.abcp.ru/?page=customers&customerId=353169&action=editCustomer - в данном случае идентификатор клиента это значение параметра customerId, а именно, 353169; либо, при использовании синхронизации пользователей с помощью операции GET cp/users, идентификатор пользователя возвращается в поле userId.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Идентификатор пользователя на сайте, для которого обновляется баланс.
balance	Значение баланса в валюте сайта
inStopList	Признак нахождения клиента в стоп-листе (необязательный параметр)
Пример запроса

https://demo.public.api.abcp.ru/cp/finance/userBalance
Параметры POST

userlogin=username&userpsw=md5pass&userId=5623478&balance=189.19
В случае успешного обновления баланса, метода возвращает актуальное значение баланса:

Поле	Описание
userId	Идентификатор клиента на сайте.
balance	Текущий баланс клиента.
inStopList	Признак нахождения клиента в стоп-листе
Обновление лимита кредита клиента
Операция: cp/finance/creditLimit

Метод: POST

Изменяет лимит кредита клиента. Принимает в качестве параметра текущий лимит кредита пользователя (float) в валюте сайта и идентификатор пользователя на сайте.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Идентификатор пользователя на сайте, для которого обновляется баланс.
creditLimit	Значение лимита кредита в валюте сайта
Пример запроса

https://demo.public.api.abcp.ru/cp/finance/creditLimit
Параметры POST

userlogin=username&userpsw=md5pass&userId=5623478&creditLimit=10000
В случае успешного обновления баланса, метода возвращает актуальное значение лимита кредита:

Поле	Описание
userId	Идентификатор клиента на сайте.
creditLimit	Значение лимита кредита в валюте сайта
Обновление финансовой информации клиента
Операция: cp/finance/userInfo

Метод: POST

Изменяет финансовую информацию клиента. Принимает в качестве параметров идентификатор пользователя на сайте и финансовую информацию пользователя.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Идентификатор пользователя на сайте, для которого обновляется баланс
balance	Текущий баланс клиента
creditLimit	Значение лимита кредита в валюте сайта
inStopList	Признак нахождения клиента в стоп-листе
payDelay	Отсрочка платежа(в днях)
overdueSaldo	Просроченный баланс
Обязательно наличие как минимум одного из полей (balance, creditLimit, inStopList, payDelay, overdueSaldo).

Пример запроса

https://demo.public.api.abcp.ru/cp/finance/userInfo
Параметры POST

userlogin=username&userpsw=md5pass&userId=5623478&balance=10000&creditLimit=2000&inStopList=0&payDelay=4&overdueSaldo=6500
В случае успешного обновления, метод возвращает актуальное значение финансовой информации пользователя:

Поле	Описание
userId	Идентификатор клиента на сайте
balance	Текущий баланс клиента
creditLimit	Значение лимита кредита в валюте сайта
inStopList	Признак нахождения клиента в стоп-листе
payDelay	Отсрочка платежа(в днях)
overdueSaldo	Просроченный баланс
stoplistDateTime	Дата попадания в стоп-лист
Получение информации об оплатах из финмодуля
Операция: cp/finance/payments

Метод: GET

Возвращает список оплат из финмодуля.
Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Идентификатор пользователя на сайте
paymentNumber	Номер платежа
createDateTimeStart	Начальный порог даты создания платежа формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
createDateTimeEnd	Конечный порог даты создания платежа формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
Параметры paymentNumber, userId необязательные. Если указан paymentNumber, то createDateTimeStart и createDateTimeEnd могут не указываться. Если интервал дат выбран больше года, то в ответе получаем ошибку "Сократите диапазон дат и выполните запрос снова. Диапазон не должен превышать 1 год."

Пример запроса

https://demo.public.api.abcp.ru/cp/finance/payments?userlogin=username&userpsw=md5pass&userId=5623478&paymentNumber=НАЛ00032
Метод возвращает массив объектов вида:

Поле	Описание
paymentId	Уникальный идентификатор платежа
paymentNumber	номер платежа
paymentTypeId	id типа платежа
createDateTime	дата платежа
paymentType	Тип платежа
paymentTypeCode	Код типа платежа: 0 - Безналичный, 1 - Электронный, 2 - Наличный
amount	сумма платежа
rest	остаток
editorId	id сотрудника,кем платеж был внесен/изменен.Если платеж был внесен автоматически (электронный) то значение параметра "0"
userId	Идентификатор клиента на сайте
comment	комментарий к платежу
onlinePaymentId	ID онлайн-оплаты
komtetCheckId	id чека, больше 0, если по платежу был создан чек.
Получение информации о привязках платежей из модуля Финансы
Операция: cp/finance/paymentOrderLinks

Метод: GET

Возвращает список привязок платежей из модуля Финансы.
Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
paymentNumbers	массив с номерами платежей
orderIds	массив с номерами заказов,если передать orderIds[]=0 и диапазон дат, то можно получить список возвратов за период
userId	Идентификатор пользователя на сайте
DateTimeStart	Начальный порог даты создания привязки формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
DateTimeEnd	Конечный порог даты создания привязки формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
При запросе указывать либо paymentNumbers либо orderIds либо userId с DateTimeStart и DateTimeEnd.

Пример запроса

https://demo.public.api.abcp.ru/cp/finance/paymentOrderLinks?userlogin=username&userpsw=md5pass&paymentNumbers[]=НАЛ00032
Метод возвращает массив объектов вида:

Поле	Описание
paymentLinkId	id привязки платежа
paymentId	id платежа
createDateTime	дата/время создания привязки платежа формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
orderId	номер заказа (если номер заказа "0" - значит это Возврат средств)
amount	сумма платежа
editorId	id сотрудника, добавившего привязку. Если параметр равен "0", то привязка автоматическая.
paymentNumber	номер платежа из ПУ в виде "НАЛ00010"
В запросе возможно фильтровать по paymentId или orderId с возможностью передавать массив платежей или заказов.

Получение списка online платежей
Операция: cp/onlinePayments

Метод: GET

Возвращает список online платежей. Обязательные параметры только userlogin и userpsw.
Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
filter	массив с параметрами фильтра
Допустимые параметры фильтра

Параметр	Описание
dateStart	Дата начало периода для выбора платежей. Формат: ГГГГ-ММ-ДД или ГГГГ-ММ-ДД ЧЧ:ММ:СС
dateEnd	Дата конца периода для выбора платежей. Формат: ГГГГ-ММ-ДД или ГГГГ-ММ-ДД ЧЧ:ММ:СС
customerIds	Массив идентификаторов клиентов. Не более 100 штук в одном запросе.
paymentMethodId	Идентификатор платежной системы. Получить можно из cp/users/profiles или в панели управления.
statusIds	Массив идентификаторов статусов платежей:
1 - Начата 2 - Завершена 3 - Неудача 4 - В обработке

orderIds	Массив идентификаторов заказов. Не более 100 штук в одном запросе.
Если в запросе параметры filter[dateStart] и filter[dateEnd] не переданы, то вернутся платежи за последние 7 дней.

Пример запроса

https://demo.public.api.abcp.ru/cp/onlinePayments?userlogin=username&userpsw=md5pass&filter[dateStart]=2018-10-01&filter[dateEnd]=2018-10-05&filter[customerIds][]=507186&filter[statusIds][]=1&filter[orderIds][]=22668371&filter[orderIds][]=15368959
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор платежа
dateTime	Дата и время платежа в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС
orderId	номер заказа
paymentStatusId	Идентификатор статуса платежа.
paymentStatusName	Название статуса платежа.
customerId	Идентификатор клиента.
customerName	Имя клиента или сотрудника.
paymentMethodId	Идентификатор платежной системы.
paymentMethodName	Название платежной системы.
amount	Сумма платежа.
commission	Комиссия платежа.
comment	Комментарий.
Добавление оплат
Операция: cp/finance/payments

Метод: POST

Добавляет платежи клиентам. Возвращает массив добавленных платежей.

Параметры запроса
Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
payments	Массив с оплатами
linkPayments	Параметр, отвечающий за автоматическую привязку платежей к заказам. 0 - не привязывать, 1 - привязывать
Массив оплат payments должен содержать следующие поля

Параметр	Описание
userId	Идентификатор пользователя на сайте, которому добавляется оплата
paymentNumber	Номер платежа, максимум 64 символа. Необязательный параметр. Если передан пустой, то номер генерируется автоматически по маске переданного типа платежа
createDateTime	Дата и время платежа, в формате ГГГГ-ММ-ДД чч:мм:сс (например 2018-01-01 00:00:00)
paymentTypeId	Id типа платежа
amount	Сумма платежа
comment	Комментарий к платежу (не обязательное)
editorId	Id сотрудника, которым был внесён платёж (не обязательное)
Пример запроса

https://demo.public.api.abcp.ru/cp/finance/payments
Тело POST запроса

userlogin=username&userpsw=md5pass&payments[0][userId]=1&payments[0][paymentTypeId]=1&payments[0][amount]=10&payments[0][createDateTime]=2018-11-16 16:04:00&payments[0][paymentNumber]=НАЛ00111&payments[1][userId]=1&payments[1][paymentTypeId]=2&payments[1][amount]=2&payments[1][paymentNumber]=НАЛ00002&payments[1][createDateTime]=2018-11-16 16:05:00


Метод возвращает массив содержащий информацию о добавленных платежах:

Поле	Описание
paymentNumber	Номер платежа
paymentTypeId	Id типа платежа
createDateTime	Дата платежа
paymentType	Тип платежа
paymentTypeCode	Код типа платежа: 0 - Безналичный, 1 - Электронный, 2 - Наличный
amount	Сумма платежа
rest	Остаток
editorId	Id сотрудника, которым был внесён платёж. Если платёж был внесен автоматически(электронный), то значение параметра "0"
userId	Идентификатор клиента на сайте
comment	Комментарий к платежу
onlinePaymentId	ID онлайн-оплаты
paymentId	ID созданного платежа
Удаление привязки оплаты
Операция: cp/finance/deleteLinkPayments

Метод: POST

Удаляет привязку оплаты, увеличивает долг заказу, к которому была сделана привязка, на сумму удаляемой привязки, увеличивает остаток оплаты на сумму удаляемой привязки, клиенту пересчитывает сальдо и долг по заказам.

Внимание!

С помощью одного запроса данная операция позволяет удалить только одну привязку. Массовое удаление недоступно.

Параметры запроса
Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
paymentLinkId	Id привязки, которую нужно удалить.
Пример запроса

https://demo.public.api.abcp.ru/cp/finance/deleteLinkPayments
Тело POST запроса

userlogin=username&userpsw=md5pass&paymentLinkId=Id


В случае успешного удаления привязки, метода возвращает возвращается в формате текст/plain и содержит строку:

successfully deleted {paymentLinkId}
где {paymentLinkId} — идентификатор удаленной привязки.

Операция привязки по ранее добавленному платежу
Операция: cp/finance/paymentOrderLink

Метод: POST

Позволяет осуществлять привязку ранее созданного платежа

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
paymentId	id платежа.
orderId	id заказа по которому делается привязка.
amount	Сумма привязки.
Пример запроса

https://demo.public.api.abcp.ru/cp/finance/paymentOrderLink
Тело POST запроса

userlogin=username&userpsw=md5pass&paymentId=1221&orderId=44997785&amount=1500
Метод возвращает объект вида:

Поле	Описание
paymentLinkId	id привязки платежа
paymentId	id платежа
paymentNumber	номер платежа из ПУ в виде "НАЛ00010"
createDateTime	дата/время создания привязки платежа формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
orderId	номер заказа
amount	сумма платежа
editorId	id сотрудника, добавившего привязку.
Операция возврата платежа
Операция: cp/finance/paymentRefund

Метод: POST

Позволяет осуществлять возврат ранее созданного платежа

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
refundPaymentId	id платежа
refundAmount	Сумма возврата.
Пример запроса

https://demo.public.api.abcp.ru/cp/finance/paymentRefund
Тело POST запроса

userlogin=username&userpsw=md5pass&refundPaymentId=1221&refundAmount=1500
Метод возвращает объект вида:

Поле	Описание
paymentLinkId	id привязки платежа
paymentId	id платежа
paymentNumber	номер платежа из ПУ в виде "НАЛ00010"
createDateTime	дата/время создания привязки платежа формат ГГГГ-ММ-ДД ЧЧ:ММ:СС
amount	сумма платежа
editorId	id сотрудника, добавившего привязку.
Операция удаления оплат
Операция: cp/finance/deletePayments

Метод: POST

Удаляет платежи клиентам. Уменьшает баланс/увеличивает долг. Возвращает либо статус успешного удаления либо ошибку (не удалены привязки, электронный платеж удалить нельзя).

С помощью одного запроса данная операция позволяет удалить только один платеж. Массовое удаление недоступно.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
paymentId	Id платежа, который нужно удалить
deleteLink	(необязательный) Параметр, отвечающий за автоматическое удаление привязки платежей . 0 - не удалять, 1 - удалять
По умолчанию, если не передан 0 - не удалять

Пример запроса

https://demo.public.api.abcp.ru/cp/finance/deletePayments
Тело POST запроса

userlogin=username&userpsw=md5pass&paymentId=1221


Получение списка чеков
Операция: komtet/getChecks

Метод: GET

Позволяет получить данные о чеках Комтет.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
shopId	ID магазина
queueId	ID очереди
dateCreatedStart	Начальная дата создания чека в формате ГГГГ-ММ-ДД.
dateCreatedEnd	Конечная дата создания чека в формате ГГГГ-ММ-ДД.
calculationMethod	Способ расчета: 0 - Предоплата 100%, 1 - Предоплата, 2 - Полный расчет, 3 - Аванс, 4 - Частичный расчет и кредит, 5 - Оплата кредита, 6 - Передача в кредит.
printPaperCheck	Был ли запрос печати бумажного чека: 0 - Нет, 1 - Да.
vat	Налог: 5 - Без НДС, 0 - НДС по ставке 0%, 3 - НДС чека по расчетной ставке 10/110, 4 - НДС чека по расчетной ставке 20/120.
calculationSubject	Предмет расчета: 0 -товар, 1 - работа, 2 - услуга, 3 - платеж.
paymentType	Оплата: 0 - Безналичными, 1 - Наличными, 2 - Предоплата, 3 - Постоплата, 4 - Встречное предоставление.
type	Тип чека: 0 - чек, 1- чек коррекции.
taxSystem	Система налогообложения: 0 - ОСН, 1 - УСН доход, 2 - УСН доход - расход, 3 - ЕНВД, 4 - ЕСН, 5 - Патент.
intent	Направление платежа: 0 - Приход, 1 - Расход, 2 - Возврат прихода, 3 - Возврат расхода.
fiscalization	Фискализирован: 0 - Нет, 1 - Да.
employeeId	id сотрудника, отправившего чек.
clientId	id клиента.
start	Отсчет чеков
rowsOnPage	Количество "на странице"
Пример запроса

https://demo.public.api.abcp.ru/komtet/getChecks?
userlogin=username&userpsw=md5pass&employeeId=1221
Метод возвращает объект вида:

Поле	Описание
id	id чека
resellerId	системный код сайта в системе
type	Тип чека: 0 - чек, 1- чек коррекции.
queueId	ID очереди
shopId	ID магазина
clientId	id клиента.
clientEmail	контакт клиента в чеке
taxSystem	Система налогообложения: 0 - ОСН, 1 - УСН доход, 2 - УСН доход - расход, 3 - ЕНВД, 4 - ЕСН, 5 - Патент.
vat	Налог: 5 - Без НДС, 0 - НДС по ставке 0%, 3 - НДС чека по расчетной ставке 10/110, 4 - НДС чека по расчетной ставке 20/120.
intent	Направление платежа: 0 - Приход, 1 - Расход, 2 - Возврат прихода, 3 - Возврат расхода.
calculationMethod	Способ расчета: 0 - Предоплата 100%, 1 - Предоплата, 2 - Полный расчет, 3 - Аванс, 4 - Частичный расчет и кредит, 5 - Оплата кредита, 6 - Передача в кредит.
calculationSubject	Предмет расчета: 0 -товар, 1 - работа, 2 - услуга, 3 - платеж.
printPaperCheck	Был ли запрос печати бумажного чека: 0 - Нет, 1 - Да.
paymentAmount	Сумма чека
advanceAmount	Сумма аванса
paymentType	Оплата: 0 - Безналичными, 1 - Наличными, 2 - Предоплата, 3 - Постоплата, 4 - Встречное предоставление.
cashierName	Имя кассира
cashierINN	ИНН кассира
correctionType	Тип чека коррекции: 0 - Коррекция прихода, 1 - Коррекция расхода
correctionDate	Дата
correctionNumber	Номер чека коррекции
correctionDescription	Описание коррекции
printerName	Название принтера
isSent	
fiscalization	Фискализирован: 0 - Нет, 1 - Да.
paymentId	
data	
positions	
Узел positions содержит массив объектов вида:

Поле	Описание
id	системный ID позиции чека
resellerId	системный код сайта в системе
checkId	ID чека
name	Название позиции чека
cost	Стоимость позиции чека
quantity	Количество, шт
sum	Сумма
discount	Скидка
orderPositionId	ID позиции заказа, по которой пробит чек
data	
Пользователи
Получение списка пользователей
Операция: cp/users

Метод: GET

Принимает в качестве параметров условия фильтрации клиентов. Возвращает список клиентов.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
dateRegistredStart	Начальная дата регистрации в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
dateRegistredEnd	Конечная дата регистрации в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
dateUpdatedStart	Начальная дата последнего обновления в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
dateUpdatedEnd	Конечная дата последнего обновления в формате ГГГГ-ММ-ДД ЧЧ:мм:СС
state	Состояние клиента. Значения:

-1 - отклоненный,

0 - ожидает регистрации,

1 - зарегистрированный,

2 - удаленный.

customerStatus	Идентификатор статуса покупателя, если указать 0 - будут выбраны пользователи без статуса
customersIds	Массив идентификаторов покупателей
marketType	Тип регистрации. Значение от 1 до 2:
1 - Розница 2 - Опт

phone	Номер телефона клиента
email	E-mail клиента
organizationName	Название организации контрагента. Если указано, будут выбраны все клиенты, название которых начинается с переданной строки. Минимальный размер длины параметра - 4 символа.
safeMode	"Безопасный режим" для клиентов не имеющих поддержки формата JSON. Может принимать значения 0,1 или 2. При включении (1), адреса доставки в ответе будут возвращаться в виде массива объектов с полями "id" и "name", а не как "ключ - значение". При включении (2), адреса доставки и список офисов в ответе будут возвращаться в виде массива объектов с полями "id" и "name", а не как "ключ - значение".
format	Формат ответа. Доступные значения:
p - клиенты содержатся в поле items, данные о количестве содержатся в поле count
pickupState	Признак запрета отображения Самовывоза для клиента
limit	Количество возвращаемых записей клиентов(число, по умолчанию - 1000).
Чтобы получить информацию о количестве записей используйте параметр format со значением p

skip	кол-во клиентов, которые нужно пропустить. (число, по умолчанию - 0)
desc	обратное направление сортировки (булево, по умолчанию - false)
Если указан только параметр dateRegistredStart/dateUpdatedStart, будут выбраны все пользователи, зарегистрированные начиная с этой даты. При указании фильтра по дате обновления, будут выбраны как новые пользователи, так и обновленные, попадающие под действие фильтра.

Внимание! По умолчанию количество возвращаемых записей ограничено 1000. Чтобы определить конкретное количество, используйте параметр format со значением p.

Пример запроса

https://demo.public.api.abcp.ru/cp/users?userlogin=username&userpsw=md5pass&dateUpdatedStart=2013-08-02 00:00:00&state=0
 или
https://demo.public.api.abcp.ru/cp/users?userlogin=username&userpsw=md5pass&customersIds[]=574823&customersIds[]=86954&customersIds[]=56234786
 или
https://demo.public.api.abcp.ru/cp/users?userlogin=username&userpsw=md5pass&customersIds[0]=574823&customersIds[1]=86954&customersIds[2]=56234786
Метод (кроме запуска с использованием параметра format со значением p) возвращает массив объектов вида:

Параметр	Описание
userId	Идентификатор пользователя
marketType	Тип регистрации. Значение от 1 до 2:
Розница
Опт
business	Тип организации. Значение от 1 до 6:
Автопарк
Автосервис
Автосервис + Магазин
Дистрибьютор
Интернет-магазин
Магазин
email	Адрес электронной почты
name	Имя
secondName	Отчество
surname	Фамилия
birthDate	Дата рождения, формат YYYY-MM-DD
regionId	Код региона
city	Город
countryCode	Код страны
phone	Номер телефона
enableSms	Производится ли отправка SMS клиенту
mobile	Номер мобильного телефона
memberOfClub	Название автоклуба
excludeCart	Исключить позиции корзины из расчета блокировки при достижении лимита кредита
icq	ICQ UIN
skype	Skype
state	Состояние аккаунта. Значения:

-1 - отклоненный,

0 - ожидает регистрации,

1 - зарегистрированный,

2 - удаленный.

registrationDate	Дата регистрации аккаунта.
updateTime	Дата последнего обновления аккаунта.
profileId	Идентификатор профиля
organizationName	Наименование организации
organizationForm	Правовая форма организации. Варианты:
ООО
ОАО
ЗАО
ТОО
АО
ЧП
ПБОЮЛ
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
ogrn	ОГРН
okpo	ОКПО
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
customerStatus	Идентификатор статуса покупателя
deliveryAddress	Адреса доставки (массив, где ключи - id адресов)
comment	Комментарий пользователя
employeeId	Идентификатор личного менеджера
clientServiceEmployeeId	Идентификатор личного менеджера клиентской службы (дополнительная опция)
clientServiceEmployee2Id	Второй идентификатор личного менеджера клиентской службы (дополнительная опция)
clientServiceEmployee3Id	Третий идентификатор личного менеджера клиентской службы (дополнительная опция)
clientServiceEmployee4Id	Четвертый идентификатор личного менеджера клиентской службы (дополнительная опция)
balance	Ручной баланс клиента, заполняется по API извне.
debt	Долг по заказам клиента
saldo	= (Долг по заказам) - (Непривязанные платежи)
creditLimit	Текущий лимит кредита клиента
inStopList	Флаг "В стоп-листе"
payDelay	Отсрочка платежа
overdueSaldo	Просроченный баланс
stopListDateIn	Дата попадания в стоп-лист (если inStopList = 1) в формате YYYY-MM-DD
offices	Массив офисов, к которым привязан клиент
baskets	Массив корзин (мультикорзина)
managerComment	комментарий менеджера из поля "Комментарий менеджера:" карточки клиента
businessName	тип организации из поля "Тип:" в буквенном обозначении (Автопарк, Дистрибьютор, Магазин и т.д.). карточки клиента
userCode	Внутренний код пользователя
pickupState	Признак запрета Самовывоза для клиента
items	Cписок (массив) клиентов, удовлетворяющих заданным фильтрам (поле отображается при использовании параметра format со значением p).
count	Количество клиентов, удовлетворяющих заданным фильтрам (поле отображается при использовании параметра format со значением p)
При использовании параметра format со значением p ответ на запрос содержит поля:

items	Cписок (массив) клиентов, удовлетворяющих заданным фильтрам. Массив представляет собой список пользователей, который был бы ответом запроса без использования параметра format со значением p.
count	Количество клиентов, удовлетворяющих заданным фильтрам
Создание пользователя
Операция: cp/user/new

Метод: POST

Принимает параметры для регистрации пользователя. Осуществляет регистрацию нового пользователя в системе. Возвращает статус выполнения операции регистрации, учетные данные нового пользователя, а так же сообщение об ошибке в случае возникновения таковой.


Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
marketType	Тип регистрации:
Розница
Опт
filialId	Код филиала (если имеются)
name	Имя
secondName	Отчество
surname	Фамилия
password	Пароль
birthDate	Дата рождения, формат YYYY-MM-DD
mobile	Номер мобильного телефона
memberOfClub	Название автоклуба
office	Идентификатор офиса
email	Адрес электронной почты
icq	ICQ UIN
skype	Skype
regionId	Код региона
city	Город
countryCode	Код страны
organizationName	Наименование организации
business	Тип организации. Значение от 1 до 3:
Автосервис
Автомагазин
Собственный автопарк
organizationForm	Правовая форма организации. Варианты:
ООО
ОАО
ЗАО
ТОО
АО
ЧП
ПБОЮЛ
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
ogrn	ОГРН
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
deliveryAddress	Адрес доставки
deliveryAddressZone	Массив, где ключ - идентификатор адреса доставки, а значение - идентификатор зоны адресов доставки
comment	Комментарий
profileId	Идентификатор профиля. Если не указан, будет выставлен профиль по умолчанию для соответствующего типа регистрации (опт или розница).
pickupState	Запрет самовывоза для клиента. 0 - запретить самовывоз, 1- разрешить самовывоз. Параметр актуален только если у вас на сайте включена опция: "Корзина: запрет самовывоза определенным клиентам".
Пример запроса

https://demo.public.api.abcp.ru/cp/user/new
Параметры POST

marketType=1&name=Василий&surname=Васильев&password=12345&mobile=79000000000&email=vasya@mail.ru&regionId=77&city=Москва&deliveryAddress=ул. Ленина, д.2&comment=
Поля ответа

Поле	Описание
status	Статус выполнения операции
userCode	Внутренний код пользователя. Необходим для активации.
activationCode	Код активации, если включена
errorMessage	Массив сообщений об ошибках, если статус = 0
activationEmailSend	Если используется опция "Регистрация: активация", нужно добавить в запрос этот параметр со значением "1", чтобы создаваемому клиенту пришло письмо с кодом активации.
Получение списка профилей
Операция: cp/users/profiles

Метод: GET

Возвращает список всех профилей.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
profileId	Идентификатор профиля. Необязательный параметр. По умолчанию возвращаются все профили.
skip	Кол-во профилей, которые нужно пропустить. Необязательный параметр. По умолчанию: 0.
limit	Кол-во профилей в ответе. Необязательный параметр. Допустимые значения от 1 до 100. По умолчанию возвращаются все профили.
format	Формат ответа. Необязательное значение Может принимать значения: "distributors" - выводить информацию по наценкам на поставщиков; "brands" - выводить информацию по наценкам на поставщиков и бренды.
Пример запроса

https://demo.public.api.abcp.ru/cp/users/profiles?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
profileId	Идентификатор профиля
code	Код профиля
name	Наименование профиля
comment	Комментарий
priceUp	Наценка, %
paymentMethods	Платежные системы
paymentTypes	Типы платежей
matrixPriceUps	Наценки от стоимости товара
distributorsPriceUps	Наценки по поставщикам (выводится если format установлен в значение distributors или brands)
baseProfileId	Идентификатор базового профиля (возвращается только при подключении опции Профили: использовать групповое сохранение)
Узел paymentMethods содержит массив объектов вида:

Параметр	Описание
id	Идентификатор платежной системы
name	Наименование платежной системы
isEnabled	Признак включения платежной системы для клиентов этого профиля
Узел matrixPriceUps содержит массив объектов вида:

Параметр	Описание
from	Цена от
to	Цена до
priceUp	Наценка
fixedMarkup	Фикс. надбавка
Узел distributorsPriceUps содержит массив объектов вида:

Параметр	Описание
id	Идентификатор поставщика
name	Наименование поставщика
isEnabled	Признак включения поставщика для клиентов этого профиля
priceUp	Наценка на поставщика
brandsPriceUps	Наценки на бренды поставщика (выводится, если format выставлен в значение brands)
isPricePriceupDisabled	Выкл. наценку в зависимости от цены товара (false — Нет, true — Да)
Узел brandsPriceUps содержит массив объектов вида:

Параметр	Описание
name	Название бренда
priceUp	Наценка на поставщика
Обновление профиля
Операция: cp/users/profile

Метод: POST

Изменяет профиль. Принимает в качестве параметров идентификатор профиля на сайте и всю информацию о профиле, возвращаемую операцией cp/users/profiles в формате brands. Работает только при выключенной опции Профили: использовать групповое сохранение, иначе возвращает ошибку.

Если не указать идентификатор профиля, будет создан новый. В данном случае, обязательными параметрами будут name и priceUp.

При необходимости создать профиль - сначала нужно его создать, а затем задать ему настройки, то есть выполнять 2 операции пошагово.

При создании профиля невозможно использовать имя и код существующих профилей.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
profileId	Идентификатор профиля
code	Код профиля
name	Наименование профиля
comment	Комментарий
priceUp	Наценка, %
paymentMethods	Платежные системы
paymentTypes	Типы платежей
matrixPriceUps	Наценки от стоимости товара
distributorsPriceUps	Наценки по поставщикам
Обязательно наличие как минимум одного из полей (code, name, comment, priceUp, paymentMethods, paymentTypes, matrixPriceUps, distributorsPriceUps).

Пример запроса

https://demo.public.api.abcp.ru/cp/users/profile
Тело POST запроса

userlogin=username&userpsw=md5pass&profileId=12345&priceUp=13

Узел paymentMethods содержит массив объектов вида:

Параметр	Описание
id	Идентификатор платежной системы
isEnabled	Признак включения платежной системы для клиентов этого профиля
Узел paymentTypes содержит массив объектов вида:

Параметр	Описание
id	Идентификатор типа платежа
isEnabled	Признак включения типа платежа для клиентов этого профиля (допустимые значения: 0 и 1)
Узел matrixPriceUps содержит массив объектов вида:

Параметр	Описание
from	Цена от
to	Цена до
priceUp	Наценка
fixedMarkup	Фикс. надбавка
Узел distributorsPriceUps содержит массив объектов вида:

Параметр	Описание
id	Идентификатор поставщика
name	Наименование поставщика
isEnabled	Признак включения поставщика для клиентов этого профиля (допустимые значения: 0 и 1)
priceUp	Наценка на поставщика
brandsPriceUps	Наценки на бренды поставщика
groupsPriceUps	Наценки на группу товаров по любому бренду
brandsAndGroupsPriceUps	Наценки на бренды и группу товаров одновременно
isPricePriceupDisabled	Выкл. наценку в зависимости от цены товара (0 — Нет, 1 — Да)
Узел brandsPriceUps не обязателен, если он отсутствует, то наценки по брендам не изменяются.

Внимание! Если передается узел brandsPriceUps, то все наценки по брендам удаляются и заполняются из переданных параметров.

Узел brandsPriceUps содержит массив объектов вида:

Параметр	Описание
name	Название бренда
priceUp	Наценка на поставщика
isOnlyOneUsed	Признак "Единственная применяемая наценка, true / false
В случае успешного обновления, метод возвращает актуальную информацию о профиле (формат узлов тотже):

Параметр	Описание
profileId	Идентификатор профиля
code	Код профиля
name	Наименование профиля
comment	Комментарий
priceUp	Наценка, %
paymentMethods	Платежные системы
paymentTypes	Массив подключенных к профилю id типов платежей
matrixPriceUps	Наценки от стоимости товара
distributorsPriceUps	Наценки по поставщикам
Обновление данных пользователя
Операция: cp/user

Метод: POST

Осуществляет обновление данных пользователя, присланных в запросе.

При изменении данных пользователя необязательно передавать все параметры. Используйте в запросе только те данные, которые вы собираетесь изменить.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Идентификатор изменяемого клиента
business	Тип организации. Значение от 1 до 6:
-1 физлицо 1 Автопарк 2 Автосервис 3 Автосервис + Магазин 4 Дистрибьютор 5 Интернет-магазин 6 Магазин

email	Адрес электронной почты
name	Имя
secondName	Отчество
surname	Фамилия
password	Необязательный параметр. Предназначен для изменения пароля пользователя
birthDate	Дата рождения, формат YYYY-MM-DD
city	Город
countryCode	Код страны
phone [устарел, не используется]	Номер телефона
mobile	Номер мобильного телефона
icq	ICQ UIN
skype	Skype
enableSms	Производится ли отправка SMS клиенту
state	Состояние аккаунта. Значения:

-1 - отклоненный,

0 - ожидает регистрации,

1 - зарегистрированный,

2 - удаленный.

profileId	Идентификатор профиля
organizationName	Наименование организации
organizationForm	Правовая форма организации. Варианты:
ООО
ОАО
ЗАО
ТОО
АО
ЧП
ПБОЮЛ
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
ogrn	ОГРН
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
deliveryAddress	Адреса доставки (массив, где ключи - id адресов). Если передать пустой параметр deliveryAddress, то все адреса клиента будут удалены! Если необходимо добавить новый адрес, то используйте в качестве ключа любое отрицательное число, например deliveryAddress[-1] = 'Здесь новый адрес'. Если Вы изменяете один из адресов, то необходимо передать все имеющиеся адреса клиента. Если этого не сделать, то не переданные адреса клиента будут удалены.
deliveryAddressZone	Массив, где ключи - id адресов доставки, а значения - id зон. Если параметр не передан, то ничего не меняется, если есть новый адрес доставки, то он добавляется с пустой зоной. Если параметр передан с пустым значением, то все зоны адресов клиента будут очищены (записано пустое значение). Если передаются новые адреса доставки через отрицательные индексы (deliveryAddress[-1]='Москва Пушкинская д.1'), то можно указать такой же параметр и для зоны (deliveryAddressZone[-1] = 7788. Если меняется хотя бы одна зона, то необходимо передать все имеющиеся зоны адресов клиента. Если этого не сделать, то не переданные зоны адреса клиента будут очищены.
baskets	Корзины клиента (массив, где ключи - id корзин). Если передать пустой параметр baskets, то все корзины клиента будут удалены! Если необходимо добавить новую корзину, то используйте в качестве ключа любое отрицательное число, например baskets[-1] = 'Здесь новое название корзины'. Если Вы изменяете одну из корзин, то необходимо передать все имеющиеся корзины клиента. Если этого не сделать, то не переданные корзины клиента будут удалены.
basketsDeliveryAddress	Связки корзины и адреса доставки(массив, где ключи - id корзин). Обновятся только переданные связки "корзина - Адрес доставки". Чтобы убрать привязку корзины и адреса нужно передать значение параметра = "0".
comment	Комментарий пользователя
managerComment	Комментарий менеджера
managerId	Идентификатор менеджера. Если передать managerId=0, то менеджер в карточке клиента удалится.
userCode	Внутренний код пользователя
clientServiceEmployeeId	Идентификатор личного менеджера клиентской службы (дополнительная опция). Если передать clientServiceEmployeeId=0, то менеджер клиентской службы в карточке клиента удалится.
clientServiceEmployee2Id	Второй идентификатор личного менеджера клиентской службы (дополнительная опция). Если передать clientServiceEmployee2Id=0, то менеджер клиентской службы в карточке клиента удалится.
clientServiceEmployee3Id	Третий идентификатор личного менеджера клиентской службы (дополнительная опция). Если передать clientServiceEmployee3Id=0, то менеджер клиентской службы в карточке клиента удалится.
clientServiceEmployee4Id	Четвертый идентификатор личного менеджера клиентской службы (дополнительная опция). Если передать clientServiceEmployee4Id=0, то менеджер клиентской службы в карточке клиента удалится.
office	Массив идентификаторов офисов, к которым необходимо подключить клиента. Если идентификатор офиса, к одному из которых подключен клиент, не будет передан, то он будет отключен. Передать пустой параметр office нельзя, т.к. клиент должен быть подключен минимум к одному офису. Параметр актуален только если у вас на сайте включена опция: "Офисы: включить привязку к клиентам".
defaultOffice	Идентификатор офиса по умолчанию. Переданное значение должно быть в массиве параметра office. Параметр актуален только если у вас на сайте включена опция: "Офисы: выбрать офис по умолчанию для клиента".
info	"Информация" в личном кабинете. В поле допустимо использование html-тегов. max 4000 символов. Закладка появляется только если есть данные в поле info для клиента.
safeMode	"Безопасный режим" для клиентов не имеющих поддержки формата JSON. Может принимать значения 0 или 1. При включении (1), адреса доставки в ответе будут возвращаться в виде массива объектов с полями "id" и "name", а не как "ключ - значение". При включении (2), адреса доставки и список офисов в ответе будут возвращаться в виде массива объектов с полями "id" и "name", а не как "ключ - значение".
pickupState	Запрет самовывоза для клиента. 0 - запретить самовывоз, 1- разрешить самовывоз. Параметр актуален только если у вас на сайте включена опция: "Корзина: запрет самовывоза определенным клиентам".
Пример запроса

https://demo.public.api.abcp.ru/cp/user
Параметры POST

userlogin=username&userpsw=md5pass&userId=12345&profileId=23456&managerId=34567&office[0]=45678&office[1]=56789
Метод возвращает набор узлов вида:

Поле	Описание
userId	Идентификатор пользователя в системе ABCP.
business	Тип организации. Значение от 1 до 6:
Автопарк
Автосервис
Автосервис + Магазин
Дистрибьютор
Интернет-магазин
Магазин
email	Адрес электронной почты
name	Имя
secondName	Отчество
surname	Фамилия
birthDate	Дата рождения, формат YYYY-MM-DD
city	Город
countryCode	Код страны
phone [устарел, не используется]	Номер телефона
mobile	Номер мобильного телефона
enableSms	Производится ли отправка SMS клиенту
icq	ICQ UIN
skype	Skype
state	Состояние аккаунта. Значения:

-1 - отклоненный,

0 - ожидает регистрации,

1 - зарегистрированный,

2 - удаленный.

profileId	Идентификатор профиля
organizationName	Наименование организации
organizationForm	Правовая форма организации. Варианты:
ООО
ОАО
ЗАО
ТОО
АО
ЧП
ПБОЮЛ
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
ogrn	ОГРН
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
deliveryAddress	Адреса доставки (массив, где ключи - id адресов)
comment	Комментарий пользователя
managerComment	Комментарий менеджера
managerId	Идентификатор менеджера
userCode	Внутренний код пользователя
clientServiceEmployeeId	Идентификатор личного менеджера клиентской службы (дополнительная опция)
clientServiceEmployee2Id	Второй идентификатор личного менеджера клиентской службы (дополнительная опция)
clientServiceEmployee3Id	Третий идентификатор личного менеджера клиентской службы (дополнительная опция)
clientServiceEmployee4Id	Четвертый идентификатор личного менеджера клиентской службы (дополнительная опция)
office	Массив идентификаторов офисов
defaultOffice	Идентификатор офиса по умолчанию. Параметр отображается только если у вас на сайте включена опция: "Офисы: выбрать офис по умолчанию для клиента".
baskets	Массив корзин клиента в формате "идентификатор - имя корзины"
basketsDeliveryAddress	Связки корзины и адреса доставки в формате "идентификатор корзины - идентификатор адреса доставки".
info	"Информация" в личном кабинете. В поле допустимо использование html-тегов. Закладка появляется только если есть данные в поле info для клиента.
pickupState	Запрет Самовывоза для клиента
Получение списка адресов доставки
Операция: cp/user/shipmentAddresses

Метод: GET

Возвращает список доступных адресов доставки. Идентификатор адреса доставки необходим при отправке заказа.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Идентификатор клиента
Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddresses?userlogin=username&userpsw=md5pass&userId=5427194
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор адреса доставки.
name	Адрес доставки.
zoneId	Идентификатор зоны, если указан для адреса.
zoneName	Имя зоны адресов доставки.
Получение клиентских настроек SMS
Операция: cp/user/smsSettings

Метод: GET

Возвращает настройки SMS клиента.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userIds	Идентификаторы клиентов (массив)
Пример запроса

https://demo.public.api.abcp.ru/cp/user/smsSettings?userlogin=username&userpsw=md5pass&userIds[]=25624625&userIds[]=25624789
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
userId	Системный код клиента.
enableSms	1 или 0 - доступна ли клиенту отправка sms в целом (задается менеджером в общих настройках клиента).
isCustomersNotificationEnabled	1 или 0 - активировал ли клиент отправку sms (задается клиентом при отправке заказа, и отображается в карточке клиента "Настройка сообщений").
Получение клиентских опций
Операция: cp/user/options

Метод: GET

Возвращает клиентские опции.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userIds	Системные id клиентов. Необязательный параметр. Если не передать, вернутся опции всех клиентов.
Пример запроса

https://demo.public.api.abcp.ru/cp/user/options?userlogin=username&userpsw=md5pass&userIds[]=861437&userIds[]=9973711
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
userId	Системный id клиента
availablePaymentTypeMode	0 при опции "Доступные типы платежей" = "Из профиля"
1 при опции "Доступные типы платежей" = "Заданы вручную".

enabledPaymentTypeIds	массив id типов платежей. Может быть пустым.
Редактирование клиентских опций
Операция: cp/user/options

Метод: POST

Редактирует клиентские опции.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
userId	Системный id клиента
availablePaymentTypeMode	0 для установки опции "Доступные типы платежей" = "Из профиля"
1 для установки опции "Доступные типы платежей" = "Заданы вручную"

enabledPaymentTypeIds	массив id типов платежей. Может быть пустым.
Пример запроса

https://demo.public.api.abcp.ru/cp/user/options
Тело POST запроса

userlogin=username&userpsw=md5pass&userId=861437&availablePaymentTypeMode=1&enabledPaymentTypeIds[]=1379
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
userId	Системный id клиента
availablePaymentTypeMode	0 при опции "Доступные типы платежей" = "Из профиля"
1 при опции "Доступные типы платежей" = "Заданы вручную".

enabledPaymentTypeIds	массив id типов платежей. Может быть пустым.
Зоны адресов
Получение списка зон адресов доставки
Операция: /cp/user/shipmentAddressZones

Метод: GET

Возвращает список зон адресов доставки.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddressZones?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор зоны адресов доставки.
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
Получение одной зоны адресов доставки
Операция: /cp/user/shipmentAddressZones/{id}

Метод: GET

Возвращает одну зону адресов доставки по указанному уникальному идентификатору.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Уникальный идентификатор зоны адресов доставки
Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddressZones/15?userlogin=username&userpsw=md5pass
Поля ответа

Метод возвращает узел вида:

Поле	Описание
id	Идентификатор зоны адресов доставки.
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
Сохранение зон адресов доставки
Операция: /cp/user/shipmentAddressZones

Метод: POST

Универсальный метод добавления и обновления зон адресов доставки.

ВАЖНО! Если вы изменяете одну из зон, необходимо передать данные и по всем остальным имеющимся зонам тоже. Если этого не сделать, то непереданные зоны будут удалены.
Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
zones	Массив объектов зон адресов доставки
Узел zones содержит массив объектов зон адресов доставки со следующими полями:

Параметр	Описание
id	Идентификатор изменяемой зоны адресов доставки. Если пустой или равен нулю, то создается новая запись с зоной адресов доставки. Если меняется хотя бы одна зона, то необходимо передать все имеющиеся зоны адресов клиента. Если этого не сделать, то не переданные зоны будут удалены.
name	Название зоны адресов доставки
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели в формате "23:59". 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
excludeDay[1...7]	Доступность дня недели для отгрузки 1 - пн., ... 7 - вс. принимает значения 0 или 1.
Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddressZones
Тело POST запроса

userlogin=username&userpsw=md5pass&zones[0][id]=123&zones[0][name]=Москва&zones[0][isOnDay1]=1&zones[0][stopTimeDay1]=16:30&zones[0][isOnDay2]=1&zones[0][stopTimeDay2]=15:30&zones[0][excludeDay3]=1
Поля ответа

Метод возвращает набор узлов вида:

Поле	Описание
id	Идентификатор зоны адресов доставки.
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
excludeDay[1...7]	Доступность дня недели для отгрузки 1 - пн., ... 7 - вс. принимает значения 0 или 1.
deadline	Минимальный срок доставки для зоны, в днях
Создание новой зоны адресов доставки
Операция: /cp/user/shipmentAddressZones/new

Метод: POST

Метод создания одной зоны адресов доставки.

Параметры запроса

Параметры запроса передаются в виде json-объекта в теле запроса. json-объект содержит следующие поля:

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddressZones/new
Тело POST запроса

 userlogin=username&userpsw=md5pass&name=зона1&isOnDay1=1&stopTimeDay1=7
Поля ответа

Метод возвращает узел с созданной зоной адресов доставки вида:

Поле	Описание
id	Идентификатор зоны адресов доставки.
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
Обновление зоны адресов доставки
Операция: /cp/user/shipmentAddressZones/{id}/update

Метод: POST

Метод обновления данных одной зоны адресов доставки.

Параметры запроса

Идентификатор обновляемой зоны передаётся явно в URI запроса. Параметры запроса передаются в виде json-объекта в теле запроса. json-объект содержит следующие поля:

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddressZones/400/update
Тело POST запроса

 userlogin=username&userpsw=md5pass&name=зона1&isOnDay1=1&stopTimeDay1=7&deadline=24
Поля ответа

Метод возвращает узел с обновлённой зоной адресов доставки вида:

Поле	Описание
id	Идентификатор зоны адресов доставки.
name	Название зоны адресов доставки.
isOnDay[1...7]	Признак, установлено ли крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
stopTimeDay[1...7]	Крайнее время работы в указанный день недели. 1 - пн., ... 7 - вс.
deadline	Минимальный срок доставки для зоны, в днях
Удаление зоны адресов доставки
Операция: /cp/user/shipmentAddressZones/{id}/delete

Метод: POST

Метод удаления зоны адресов доставки.

Параметры запроса

Идентификатор обновляемой зоны передаётся явно в URI запроса.

Пример запроса

https://demo.public.api.abcp.ru/cp/user/shipmentAddressZones/400/delete
Ответ

Метод возвращает статус 200, если удаление прошло успешно, и статус отличный от 200 с описанием ошибки, если при удалении зоны возникли проблемы.



Получение списка сотрудников
Операция: cp/managers

Метод: GET

Возвращает список менеджеров.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/cp/managers?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
id	Идентификатор сотрудника
resellerId	Идентификатор реселлера
typeId	Тип сотрудника
typeName	Наименование типа
firstName	Имя сотрудника
lastName	Фамилия сотрудника
email	E-mail
phone	Телефон
icq	ICQ
skype	Skype
sip	SIP номер
comment	Комментарий
contractorId	Идентификатор пользователя сотрудника
bossId	Идентификатор руководителя сотрудника
bossName	Имя руководителя сотрудника
officeName	Название офиса
officeId	Идентификатор офиса
allowLogin	Флаг разрешения входа на сайт
allowLoginToCP	Флаг разрешения входа в Панель управления
isFranchiseeLogin	Флаг франчайзи
isDelete	Флаг удаленного сотрудника
isService	Флаг сотрудника сервиса
mobile	Мобильный телефон
photo	Фотография
photoVersion	Версия фотографии
Обновление данных сотрудника
Операция: cp/manager

Метод: POST

Обновление данных сотрудника.

При изменении данных сотрудника необязательно передавать все параметры. Используйте в запросе только те данные, которые вы собираетесь изменить.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор сотрудника (обязательное поле)
typeId	Идентификатор должности сотрудника
firstName	Имя сотрудника
lastName	Фамилия сотрудника
email	Адрес ящика электронной почты
phone	Номер телефона
mobile	Номер мобильного телефона
SIP	SIP номер
comment	Комментарий
bossId	Идентификатор руководителя
officeId	Идентификатор офиса
Пример запроса

https://demo.public.api.abcp.ru/cp/manager
Тело POST запроса

userlogin=username&userpsw=md5pass&id=12345&firstName=4503
Метод возвращает массив объектов вида:

Параметр	Описание
id	Идентификатор сотрудника
resellerId	Идентификатор реселлера
typeId	Тип сотрудника
typeName	Наименование типа
firstName	Имя сотрудника
lastName	Фамилия сотрудника
email	E-mail
phone	Телефон
icq	ICQ
sip	sip номер
skype	Skype
comment	Комментарий
contractorId	Идентификатор пользователя сотрудника
bossId	Идентификатор руководителя сотрудника
bossName	Имя руководителя сотрудника
officeName	Название офиса
officeId	Идентификатор офиса
allowLogin	Флаг разрешения входа на сайт
allowLoginToCP	Флаг разрешения входа в Панель управления
isFranchiseeLogin	Флаг франчайзи
isDelete	Флаг удаленного сотрудника
isService	Флаг сотрудника сервиса
mobile	Мобильный телефон
photo	Фотография
photoVersion	Версия фотографии
Получение списка статусов
Операция: cp/statuses

Метод: GET

Возвращает список всех статусов позиций заказов.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/cp/statuses?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
id	Идентификатор статуса (он же statusCode)
name	Имя статуса
comment	Описание для клиента
notify	Флаг "Уведомить клиента"
paid	Флаг "Статус после оплаты заказа"
startDelivery	Флаг "Начальный статус доставки/списания"
delivery	Флаг "Статус доставки/списания"
placingOrder	Флаг "Статус после размещения заказа у поставщика"
color	Цвет статуса
Получение справочника брендов
Операция: cp/articles/brands

Метод: GET

Возвращает список всех брендов зарегистрированных в системе с их синонимами.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/cp/articles/brands?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
name	Имя бренда
aliases	Массив, содержащий список синонимов текущего бренда
Получение справочника групп брендов
Операция: cp/articles/brandGroups

Метод: GET

Возвращает список всех групп брендов зарегистрированных в системе.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/cp/articles/brandGroups?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
brands	Массив, содержащий список брендов, входящих в группу
name	Название группы (имя заглавного бренда)
Поставщики
Получение списка поставщиков
Операция: cp/distributors

Метод: GET

Возвращает список всех поставщиков, подключенных в ПУ/Поставщики.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
distributors4mc	При передаче "1" возвращает дополнительно поставщиков 4mycar"
Пример запроса

https://demo.public.api.abcp.ru/cp/distributors?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Параметр	Описание
id	id поставщика
name	Имя поставщика
publicName	Публичное (измененное) имя поставщика
currencyDesignation	Валюта поставщика
isEnabled	Статус поставщика
updateTime	Последнее обновление (у онлайн поставщиков не выводится)
positionsNumber	Позиций в наличии
updateRateInDays	Норма обновления в днях для поставщика
email	email поставщика
firstName	Имя
lastName	Фамилия
city	Город
phone	Телефон
mobile	Мобильный
organizationForm	Правовая форма организации.
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
description	Описание
contractor	Контрагент поставщика. Содержит поля: id - идентификатор, name - имя. Значение null - если контрагент не прикреплен.
Изменение статуса поставщика
Операция: cp/distributor/status

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
distributorId	Id поставщика
status	1 - Вкл. \ 0 - Выкл.
Пример запроса

https://demo.public.api.abcp.ru/cp/distributor/status
Тело POST запроса

userlogin=username&userpsw=md5pass&status=1
Метод возвращает объект вида:

Параметр	Описание
status	Статус выполнения операции. В случае успешного выполнения возвращает 1.
errorMessage	Сообщение об ошибке(если она есть).
Загрузка прайс-листа поставщика
Операция: cp/distributor/pricelistUpdate

Метод: POST

В ПУ, в разделе "Поставщики"/"Обн."/"Конфигурация прайс-листа" предварительно настраивается конфигурация загружаемого прайс-листа. Специальных требований к прайс-листу нет, есть только обычные: наличие колонок с ценой, брендом, каталожным номером, описанием, наличием. На вкладке "Загрузка прайс-листа" может быть выбран любой способ загрузки.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
distributorId	Id поставщика
uploadFile	файл прайс-листа переданный в multipart/form-data
fileTypeId	Необязательный параметр - идентификатор типа файла. Если не передаётся, то по умолчанию равен 1.
Список принимаемых значений:

1 - полный ассортимент

Пояснение: если загружается полный ассортимент, то вся загруженная ранее информация удаляется.

vertical-align:middle;
Внимание!
Для этой операции необходимо использовать медиа-тип multipart/form-data.
Пример запроса

curl -i -X POST -H "Content-Type: multipart/form-data" -F "userlogin=username" -F "userpsw=md5pass" -F "distributorId=369645" -F "uploadFile=@/home/user/pricelist.xlsx" https://demo.public.api.abcp.ru/cp/distributor/pricelistUpdate
Примеры скриптов для выполнения операции

Windows - СКАЧАТЬ После скачивания необходимо распаковать zip архив в любую папку. Открыть файл windows/upload.vbs для редактирования в Блокноте и указать в самом верху свои логин и пароль API администратора, а также хост для обращения к API. Сохраните и закройте его. После этого, откройте файл start_full.bat для редактирования в Блокноте. Вторым аргументом необходимо указать id поставщика для обновления, а третьим аргументом - путь к файлу прайс-листа. Путь к файлу может быть полным, например: "C:\Users\Admin\my_price.xls". Или относительным, например: ".\my_price.xls", если прайс-лист лежит в той же папке где и скрипт загрузки. Сохраните и закройте файл. Теперь вы можете запустить файл start_full.bat двойным кликом, чтобы прайс-лист был загружен.
Linux - СКАЧАТЬ После скачивания необходимо распаковать zip архив в любую папку. Отредактируйте файл posix/update_price.sh указав в блоке Config свои логин и пароль API администратора, а также хост для обращения к API. Для запуска используйте консоль:
sh /home/user/update_price.sh 369645 '/home/user/my_price.csv'
где первый аргумент: 369645 - id поставщика, второй аргумент - путь к файлу прайс-листа.

или

sh /home/user/update_price.sh 369645 '/home/user/my_price.csv'
Необходимо наличие установленной библиотеки curl.

Проект на GitHub

Метод возвращает объект вида:

Параметр	Описание
status	Статус выполнения операции. В случае успешного выполнения возвращает 1.
message	Сообщение о результатах работы.
Получение списка маршрутов поставщика
Операция: cp/routes

Метод: GET

Возвращает список всех маршрутов поставщика.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
distributorId	Идентификатор поставщика
withDisabled	Фильтр по статусу маршрутов:
• 0 — только активные (по умолчанию).

• 1 — все маршруты (активные и неактивные).

Пример запроса

https://demo.public.api.abcp.ru/cp/routes?userlogin=username&userpsw=md5pass&distributorId=12345&withDisabled=0
Метод возвращает массив объектов вида:

Параметр	Описание
id	id маршрута
deadline	Срок поставки (часов)
deadlineReplace	Текстовое значение для "Срока поставки"
isDeadlineReplaceFranchEnabled	Передавать текстовое значение для "Срока поставки" франчайзи
deadlineMax	Максимальный срок поставки (часов)
normalTimeStart	Начало рабочего времени
normalTimeEnd	Конец рабочего времени
normalDaysOfWeek	Стандартные дни недели
abnormalDeadline	Срок поставки (вне стандартного времени)
abnormalDeadlineMax	Максимальный срок поставки (вне стандартного времени)
p1	P1
p2	P2
pricePerKg	Стоимость 1КГ (в валюте поставщика)
priceUpAdded	Добавочная наценка
с1	C1
priceUpMin	Минимальная наценка
priceUpMax	Максимальная наценка
primaryPriceUpToContractor	Приоритетная (если выше) наценка для клиента
deliveryProbability	Вероятность поставки (в процентах) %
description	Краткое описание маршрута
enableColor	Выделять цветом
color	Цвет
isAbnormalColorEnabled	Выделять цветом в нерабочее время
abnormalColor	Цвет в нерабочее время
noReturn	Без возврата
distributorCode	Код поставщика ("человеко-читаемый" код, который может (но не должен) установить владелец сайта для прайса/поставщика).
supplierCodeEnabledList	Ограничить выдачу складами (массив)
supplierCodeDisabledList	Исключить позиции по складам (массив)
normalTimeDisplayOnly	Показывать только в стандартное время (false - Нет, true - Да)
disableOrderAbnormalTime	Блокировать отправку заказа в нестандартное время (false - Нет, true - Да)
notUseOnlineSupplierDeadline	Не использовать срок поставки online-поставщика (false - Нет, true - Да)
isActive	Статус маршрута (false - Неактивный , true - Активный)
offices	Массив Id офисов, которые привязаны к маршруту
Обновление данных маршрута поставщика
Операция: cp/route

Метод: POST

Осуществляет обновление данных маршрута поставщика, присланных в запросе.

При изменении данных маршрута необязательно передавать все параметры. Используйте в запросе только те данные, которые вы собираетесь изменить.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
routeId	Идентификатор маршрута поставщика
deadline	Срок поставки (часов)
deadlineReplace	Текстовое значение для "Срока поставки"
isDeadlineReplaceFranchEnabled	Передавать текстовое значение для "Срока поставки" франчайзи
deadlineMax	Максимальный срок поставки (часов)
normalTimeStart	Начало рабочего времени
normalTimeEnd	Конец рабочего времени
normalDaysOfWeek	Стандартные дни недели
abnormalDeadline	Срок поставки (вне стандартного времени)
abnormalDeadlineMax	Максимальный срок поставки (вне стандартного времени)
p1	P1
p2	P2
pricePerKg	Стоимость 1КГ (в валюте поставщика)
priceUpAdded	Добавочная наценка
с1	C1
priceUpMin	Минимальная наценка
priceUpMax	Максимальная наценка
primaryPriceUpToContractor	Приоритетная (если выше) наценка для клиента
deliveryProbability	Вероятность поставки (в процентах) %
description	Краткое описание маршрута
enableColor	Выделять цветом
color	Цвет
isAbnormalColorEnabled	Выделять цветом в нерабочее время
abnormalColor	Цвет в нерабочее время
noReturn	Без возврата
supplierCodeEnabledList	Ограничить выдачу складами (массив)
supplierCodeDisabledList	Исключить позиции по складам (массив)
normalTimeDisplayOnly	Показывать только в стандартное время (0 - Нет, 1 - Да)
disableOrderAbnormalTime	Блокировать отправку заказа в нестандартное время (0 - Нет, 1 - Да). "1" сохраняется только при normalTimeDisplayOnly=1.
notUseOnlineSupplierDeadline	Не использовать срок поставки online-поставщика (0 - Нет, 1 - Да)
offices	Массив Id офисов, которые привязаны к маршруту. Требует, чтобы была активна опция "Офисы: включить дополнительные настройки"
Пример запроса

https://demo.public.api.abcp.ru/cp/route
Тело POST запроса

userlogin=username&userpsw=md5pass&routeId=12345&deadline=48
Метод возвращает массив с измененной информацией о маршруте:

Параметр	Описание
id	id маршрута
deadline	Срок поставки (часов)
deadlineReplace	Текстовое значение для "Срока поставки"
isDeadlineReplaceFranchEnabled	Передавать текстовое значение для "Срока поставки" франчайзи
deadlineMax	Максимальный срок поставки (часов)
normalTimeStart	Начало рабочего времени
normalTimeEnd	Конец рабочего времени
normalDaysOfWeek	Стандартные дни недели
abnormalDeadline	Срок поставки (вне стандартного времени)
abnormalDeadlineMax	Максимальный срок поставки (вне стандартного времени)
p1	P1
p2	P2
pricePerKg	Стоимость 1КГ (в валюте поставщика)
priceUpAdded	Добавочная наценка
с1	C1
priceUpMin	Минимальная наценка
priceUpMax	Максимальная наценка
primaryPriceUpToContractor	Приоритетная (если выше) наценка для клиента
deliveryProbability	Вероятность поставки (в процентах) %
description	Краткое описание маршрута
enableColor	Выделять цветом
color	Цвет
isAbnormalColorEnabled	Выделять цветом в нерабочее время
abnormalColor	Цвет в нерабочее время
noReturn	Без возврата
supplierCodeEnabledList	Ограничить выдачу складами (массив)
supplierCodeDisabledList	Исключить позиции по складам (массив)
normalTimeDisplayOnly	Показывать только в стандартное время (false - Нет, true - Да)
disableOrderAbnormalTime	Блокировать отправку заказа в нестандартное время (false - Нет, true - Да)
notUseOnlineSupplierDeadline	Не использовать срок поставки online-поставщика (false - Нет, true - Да)
offices	Массив Id офисов, которые привязаны к маршруту
Изменение статуса маршрута поставщика
Операция: cp/routes/status

Метод: POST

Изменяет статус маршрута поставщика

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
routeId	Идентификатор маршрута поставщика
status	Значение нового статуса (1-вкл., 0-выкл.)
Пример запроса

https://demo.public.api.abcp.ru/cp/routes/status
Параметры POST

userlogin=username&userpsw=md5pass&routeId=12345&status=1
Поля ответа

Метод возвращает ответ:

Поле	Описание
distributorRouteActive	Статус маршрута. Принимает значение true - включён, false - выключен
В случае ошибки возвращает ответ:

Поле	Описание
errorCode	Код ошибки
errorMessage	Текст сообщения об ошибке
Удаление маршрута поставщика
Операция: cp/route/delete

Метод: POST

Удаляет маршрут поставщика.

Параметры запроса

Параметр	Описание
userlogin	Имя пользователя в системе
userpsw	md5-хэш пароля пользователя в системе
routeId	Идентификатор маршрута поставщика
Пример запроса

https://demo.public.api.abcp.ru/cp/route/delete
Тело POST запроса

userlogin=username&userpsw=md5pass&routeId=12345
Поля ответа

Метод возвращает ответ:

Поле	Описание
status	Статус удаления маршрута. Принимает значение 0 - произошла ошибка или 1, если все успешно.
errorMessage	Текст сообщения об ошибке при статусе 0.
Подключение поставщиков к офису
Операция: cp/offices

Метод: POST

Подключение/отключение поставщиков к офисам

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
officeId	Идентификатор офиса.
distributors	Массив поставщиков, если параметр не передан или содержит пустое значение - отключаются все поставщики указанного офиса.
Узел distributors - массив объектов с параметрами:

Поле	Описание
id	Идентификатор поставщика
deadline	Срок поставки (час)
При добавлении нового поставщика, необходимо также передать уже существующие привязки и для этого достаточно передать только Идентификаторы поставщиков. Сроки поставки существующих привязанных поставщиков не изменятся если не указать deadline.

Для обновления срока поставки уже существующей привязки поставщика достаточно указать новое значения для поля deadline.

Чтобы отключить поставщика(ов) от офиса, необходимо передать всех текущих, подключенных поставщиков кроме тех которых необходимо отключить.

Пример запроса

https://demo.public.api.abcp.ru/cp/offices
Тело POST запроса

userlogin=username&userpsw=md5pass&officeId=123&distributors[0][id]=456&distributors[0][deadline]=1&distributors[1][id]=1504361&distributors[1][deadline]=3
Метод возвращает объект вида:

Поле	Описание
status	Принимает значение 0 - произошла ошибка или 1, если все успешно.
errorMessage	Текст сообщения об ошибке при статусе 0.
оfficeId	Идентификатор офиса
оfficeName	Название офиса
distributors	Массив подключенных поставщиков
Узел distributors - массив объектов с параметрами:

Поле	Описание
id	Идентификатор поставщика
name	Название поставщика
deadline	Срок поставки (час)
Получение поставщиков офиса
Операция: cp/offices

Метод: GET

Возвращает информацию о подключенных поставщиках

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
officeId	Идентификатор офиса. Если параметр не указан то в ответе возвращаются данные по всем офисам
Пример запроса

https://demo.public.api.abcp.ru/cp/offices?userlogin=username&userpsw=md5pass&officeId=123
Метод возвращает объект вида:

Поле	Описание
status	Принимает значение 0 - произошла ошибка или 1, если все успешно.
errorMessage	Текст сообщения об ошибке при статусе 0.
offices	Массив объектов офисов
Узел offices - массив объектов с параметрами:

Поле	Описание
оfficeId	Идентификатор офиса
оfficeName	Название офиса
distributors	Массив подключенных поставщиков
Узел distributors - массив объектов с параметрами:

Поле	Описание
id	Идентификатор поставщика
name	Название поставщика
deadline	Срок поставки (час)
Копирование поставщика
Операция: cp/distributor/copy

Метод: POST

Cоздает нового прайсового поставщика с полностью идентичными настройками - валюта прайса, настройки колонок, конфигурация брендов, правил для артикулов и описаний в прайсах, конфигурация цен прайса, конфигурация наличия, фильтрация прайса, доп. настройки и настройки маршрутОВ на основе заданного id шаблонного прайсового поставщика. Лимит по операции - не более 100 операций в сутки.

Создается такое же количество маршрутов, как в поставщике, с которого копируются настройки

Поставщик создается выключенным от сайта. Для его включения по API используйте операцию Изменение статуса поставщика

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
distributorId	ID поставщика, с которого будут скопированы настройки конфига и маршрутов
distributorName	Название для создаваемого поставщика - необязательное поле. Если не задавать наименование, то будет создан поставщик с названием от копируемого поставщика+ постфикса _Copy
withoutConfig	Необязательный параметр. Список принимаемых значений:
1-создастся поставщик со структурой по умолчанию, которую нужно самостоятельно задать/настроить (то есть идентично тому, как в ПУ с нуля создается поставщик)
0-конфигурация будет создана идентичная конфигу копируемого поставщика .
Если не передаётся, то по умолчанию равен 0
Пример запроса

https://demo.public.api.abcp.ru/cp/distributor/copy
Тело POST запроса

userlogin=username&userpsw=md5pass&distributorId=4223356&distributorName=NEWпоставщик
Метод возвращает массив объектов вида:

Параметр	Описание
id	id поставщика
name	Имя поставщика
publicName	Публичное (измененное) имя поставщика
currencyDesignation	Валюта поставщика
isEnabled	Статус поставщика
updateTime	Последнее обновление (у онлайн поставщиков не выводится)
positionsNumber	Позиций в наличии
updateRateInDays	Норма обновления в днях для поставщика
email	email поставщика
firstName	Имя
lastName	Фамилия
city	Город
phone	Телефон
mobile	Мобильный
organizationForm	Правовая форма организации.
organizationOfficialName	Наименование по регистрации (без правовой формы юр. лица)
inn	ИНН
kpp	КПП
organizationOfficialAddress	Юридический адрес организации
bankName	Наименование банка
bik	БИК банка
correspondentAccount	Корреспондентский счет банка
organizationAccount	Расчетный счет организации
description	Описание
contractor	Контрагент поставщика. Содержит поля: id - идентификатор, name - имя. Значение null - если контрагент не прикреплен.
routes	массив созданных по поставщику маршрутов
Узел routes содержит массив объектов вида:

Параметр	Описание
id	id маршрута
deadline	Срок поставки (часов)
deadlineReplace	Текстовое значение для "Срока поставки"
isDeadlineReplaceFranchEnabled	Передавать текстовое значение для "Срока поставки" франчайзи
deadlineMax	Максимальный срок поставки (часов)
normalTimeStart	Начало рабочего времени
normalTimeEnd	Конец рабочего времени
normalDaysOfWeek	Стандартные дни недели
abnormalDeadline	Срок поставки (вне стандартного времени)
abnormalDeadlineMax	Максимальный срок поставки (вне стандартного времени)
p1	P1
p2	P2
pricePerKg	Стоимость 1КГ (в валюте поставщика)
priceUpAdded	Добавочная наценка
с1	C1
priceUpMin	Минимальная наценка
priceUpMax	Максимальная наценка
primaryPriceUpToContractor	Приоритетная (если выше) наценка для клиента
deliveryProbability	Вероятность поставки (в процентах) %
description	Краткое описание маршрута
enableColor	Выделять цветом
color	Цвет
isAbnormalColorEnabled	Выделять цветом в нерабочее время
abnormalColor	Цвет в нерабочее время
noReturn	Без возврата
supplierCodeEnabledList	Ограничить выдачу складами (массив)
supplierCodeDisabledList	Исключить позиции по складам (массив)
normalTimeDisplayOnly	Показывать только в стандартное время (false - Нет, true - Да)
disableOrderAbnormalTime	Блокировать отправку заказа в нестандартное время (false - Нет, true - Да)
notUseOnlineSupplierDeadline	Не использовать срок поставки online-поставщика (false - Нет, true - Да)


Создание маршрута поставщика
Операция: cp/route/create

Метод: POST

Операция позволяет создать маршрут для имеющегося поставщика

ВАЖНО: Для предотвращения ошибок, вледствие которых может быть создано множество маршрутов, существует лимит на создание: 5 маршрутов на1 поставщика. В случае его достижения Вам будет отображена ошибка ""Достигнуто ограничение на создание по API - для одного поставщика не более 5 маршрутов.""

Параметры запроса

Минимально необходимые поля для создания маршрута: логин API-администратора, пароль, Id поставщика для которого требуется создать маршрут. Но можно сразу при создании задавать необходимые параметры.

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
distributorId	ID поставщика, Для которого будет создан новый маршрут
deadline	Срок поставки (часов)
deadlineReplace	Текстовое значение для "Срока поставки"
isDeadlineReplaceFranchEnabled	Передавать текстовое значение для "Срока поставки" франчайзи
deadlineMax	Максимальный срок поставки (часов)
normalTimeStart	Начало рабочего времени
normalTimeEnd	Конец рабочего времени
normalDaysOfWeek	Стандартные дни недели
abnormalDeadline	Срок поставки (вне стандартного времени)
abnormalDeadlineMax	Максимальный срок поставки (вне стандартного времени)
p1	P1
p2	P2
pricePerKg	Стоимость 1КГ (в валюте поставщика)
priceUpAdded	Добавочная наценка
с1	C1
priceUpMin	Минимальная наценка
priceUpMax	Максимальная наценка
primaryPriceUpToContractor	Приоритетная (если выше) наценка для клиента
deliveryProbability	Вероятность поставки (в процентах) %
description	Краткое описание маршрута
enableColor	Выделять цветом
color	Цвет
isAbnormalColorEnabled	Выделять цветом в нерабочее время
abnormalColor	Цвет в нерабочее время
noReturn	Без возврата
supplierCodeEnabledList	Ограничить выдачу складами (массив)
supplierCodeDisabledList	Исключить позиции по складам (массив)
normalTimeDisplayOnly	Показывать только в стандартное время (false - Нет, true - Да)
disableOrderAbnormalTime	Блокировать отправку заказа в нестандартное время (false - Нет, true - Да)
notUseOnlineSupplierDeadline	Не использовать срок поставки online-поставщика (false - Нет, true - Да)
offices	Массив Id офисов, которые нужно привязать к маршруту при создании
Актуально только когда активная опция "Офисы: включить дополнительные настройки"

Пример запроса

https://demo.public.api.abcp.ru/cp/route/create
Параметры POST

userlogin=username&userpsw=md5pass&distributorId=4223356&deadline=24
Метод возвращает массив объектов вида:

Параметр	Описание
id	id маршрута
deadline	Срок поставки (часов)
deadlineReplace	Текстовое значение для "Срока поставки"
isDeadlineReplaceFranchEnabled	Передавать текстовое значение для "Срока поставки" франчайзи
deadlineMax	Максимальный срок поставки (часов)
normalTimeStart	Начало рабочего времени
normalTimeEnd	Конец рабочего времени
normalDaysOfWeek	Стандартные дни недели
abnormalDeadline	Срок поставки (вне стандартного времени)
abnormalDeadlineMax	Максимальный срок поставки (вне стандартного времени)
p1	P1
p2	P2
pricePerKg	Стоимость 1КГ (в валюте поставщика)
priceUpAdded	Добавочная наценка
с1	C1
priceUpMin	Минимальная наценка
priceUpMax	Максимальная наценка
primaryPriceUpToContractor	Приоритетная (если выше) наценка для клиента
deliveryProbability	Вероятность поставки (в процентах) %
description	Краткое описание маршрута
enableColor	Выделять цветом
color	Цвет
isAbnormalColorEnabled	Выделять цветом в нерабочее время
abnormalColor	Цвет в нерабочее время
noReturn	Без возврата
supplierCodeEnabledList	Ограничить выдачу складами (массив)
supplierCodeDisabledList	Исключить позиции по складам (массив)
normalTimeDisplayOnly	Показывать только в стандартное время (false - Нет, true - Да)
disableOrderAbnormalTime	Блокировать отправку заказа в нестандартное время (false - Нет, true - Да)
notUseOnlineSupplierDeadline	Не использовать срок поставки online-поставщика (false - Нет, true - Да)
offices	Массив Id офисов, которые привязаны к маршруту
Актуально только когда активная опция "Офисы: включить дополнительные настройки"


Если в процессе загрузки возникли ошибки, возвращается статус отличный от 200 и объект с полями:

Параметр	Описание
errorCode	Код ошибки
errorMessage	Текст сообщения об ошибке
Получение списка обновлённых автомобилей в гараже
Операция: cp/garage

Метод: GET

Возвращает информацию об автомобилях, в которые были внесены изменения за определённый период времени. Если не переданы параметры dateUpdatedStart и dateUpdatedEnd, то будет предоставлена информация за последний месяц.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
dateUpdatedStart	Начальная дата последнего обновления в формате ГГГГ-ММ-ДД ЧЧ:мм:СС (необязательный)
dateUpdatedEnd	Конечная дата последнего обновления заказа в формате ГГГГ-ММ-ДД ЧЧ:мм:СС (необязательный)
Пример запроса

https://demo.public.api.abcp.ru/cp/garage?userlogin=username&userpsw=md5pass&dateUpdatedStart=2020-02-28%2014:00:24&dateUpdatedEnd=2020-03-20%2023:00:24
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор автомобиля в гараже
userId	Идентификатор пользователя
name	Название автомобиля (пользовательское)
comment	Комментарий (пользовательский)
year	Год выпуска автомобиля
vin	VIN-код автомобиля
frame	Номер кузова автомобиля
mileage	Пробег автомобиля
manufacturerId	Идентификатор марки автомобиля
manufacturer	Название марки автомобиля
modelId	Идентификатор модели автомобиля
model	Название модели автомобиля
modificationId	Идентификатор модификации автомобиля
modification	Название модификации автомобиля
dateUpdated	Дата последнего обновления автомобиля в гараже
vehicleRegPlate	Государственный номер автомобиля
Получение списка настроек платёжных систем
Операция: cp/payments/getPaymentMethodSettings

Метод: GET

Возвращает настройки платёжных систем. Если не указывать доп. параметры, то будут возвращены все существующие настройки для всех платёжных систем (активных и отключенных).

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
onlyEnabled	если true, то будет возвращён список только включенных настроек ПС
onlyDisabled	если true, то будет возвращён список только выключенных настроек ПС
paymentMethodId	id конкретной платёжной системы для которой нужно получить настройки
Возможные id:

2 - RBK Money

4 - Банковский перевод

5 - Газпромбанк

10 - Оплата по счету

11 - Epay Казкоммерцбанк

12 - АПК ПР(ASSIST)

13 - ACQUIRO PAY

14 - ОАО "Сбербанк России"

17 - Arca

18 - RBK Money New

19 - PayPal

20 - Liqpay

21 - Tinkoff Bank

22 - Payguide Acquirer

23 - PayKeeper

24 - CloudPayments

25 - PayOnline

26 - ЮKassa

28 - ОАО "Сбербанк России" - Казахстан

29 - bePaid.by

30 - Idram

31 - Telr

Пример запроса

https://demo.public.api.abcp.ru/cp/payments/getPaymentMethodSettings/?userlogin=username&userpsw=md5pass
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор настроек
paymentMethodId	Идентификатор платёжной системы
resellerId	Идентификатор реселлера
description	Описание настроек
customSettings	Уникальные настройки платёжной системы в формате Json
isEnabled	Активна ли данная настройка
commissionPercentForTransfer	Процент комиссии платежной системы
Получение ссылки на оплату заказа
Операция: cp/payment/token

Метод: GET

Возвращает ссылку для оплаты заказа.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
number	Онлайн-номер заказа
Пример запроса

https://demo.public.api.abcp.ru/cp/payment/token/?userlogin=username&userpsw=md5pass&number=20000
Метод возвращает объект с одним полем.

Поле	Описание
paymentLink	Ссылка на оплату
Получение ссылки на пополнение баланса
Операция: cp/payment/top-balance-link

Метод: GET

Возвращает ссылку для пополнения баланса.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
clientId	Идентификатор клиента
amount	Сумма пополнения баланса
Пример запроса

https://demo.public.api.abcp.ru/cp/payment/top-balance-link/?userlogin=username&userpsw=md5pass&clientId=1000&amount=20000
Метод возвращает объект с одним полем.

Поле	Описание
paymentLink	Ссылка на пополнение баланса
Каталоги в товарных группах
vertical-align:middle;
Внимание!
Каталоги в товарных группах через API - отдельная услуга, для подключения необходимо связаться с отделом продаж ABCP
Общая информация по каталогам и использованию операций
ABCP разрабатывает и поддерживает десятки каталогов в товарных группах. Новые каталоги добавляются регулярно, информация в текущих каталогах тоже обновляется непрерывно. В настоящий момент (19.05.2022) разработано 60 каталогов c 440551 товаром. Все каталоги доступны на сайтах клиентов ABCP, кроме этого, имеется возможность интегрировать каталоги на ваш сайт через API.

RoGxWurZWO.png

На странице каталога в товарной группе на вашем сайте вы используете для запросов в API ABCP идентификатор товарной группы для доступа к информации по каталогу. Полный список идентификаторов каталогов в товарных группах ABCP вы можете посмотреть в этом документе;
По идентификатору запрашиваете информацию о каталоге (например, oils), используя метод /cp/catalog/info (документация ниже). Получаете список фильтров, их типы, значения и отображаете на странице каталога;
Пользователь вашего сайта указывает нужные ему значения, например Motul + 5w40;
При помощи операции /cp/catalog/search (документация ниже) вы отправляете запрос в API ABCP и получаете список арткулов, которые удовлетворяют переданным фильтрам. По списку полученных артикулов вы осуществляете поиск предложений на своих складах (или у ваших поставщиков), формируете результат для клиента и отображаете его в результатах подбора по каталогу. Для отображения результатов поиска используете операцию /cp/articles/info/batch (документация ниже)
Примеры реализации
на платформе ABCP
реализация через API через описанные ниже методы


Получение информации по одному каталогу
Операция: /cp/catalog/info

Метод: GET

Метод позволяет получить информацию по одному каталогу. Передаётся идентификатор каталога, в ответе список фильтров, тип фильтра, возможные значения фильтров.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
goods_group	Идентификатор товарной группы (полный список)
locale	Локаль, по-умолчанию (если значение не передано) - ru_RU
Пример запроса

https://demo.public.api.abcp.ru/cp/catalog/info?goods_group=oils&userlogin=username&userpsw=md5pass
Пример ответа (сокращено для лучшего восприятия)

{
	"goods_group":"oils",
	"descr":"масла ДВС",
	"brands":[
		{
			"brand":"Ravenol",
			"is_popular":true,
			"sort_order":0
		},
		{
			"brand":"Castrol",
			"is_popular":true,
			"sort_order":1
		},
		{
			"brand":"MOTUL",
			"is_popular":true,
			"sort_order":2
		},
		{
			"brand":"Liqui moly",
			"is_popular":true,
			"sort_order":3
		},
		{
			"brand":"Mobil",
			"is_popular":true,
			"sort_order":4
		}
	],
	"criterias":[
		{
			"property":"oil_type",
			"value_type":"list",
			"value_count":"one",
			"descr":"Состав масла",
			"descr_full":"<span>Минеральное масло фактически добывается из земли &ndash; это просто очищенная сырая нефть. Синтетическое масло (полностью синтетическое или полусинтетика) создается в лаборатории.&nbsp;</span>",
			"is_required":true,
			"is_enable":true,
			"is_extended":false,
			"is_minimized":false,
			"allow_multiple":true,
			"sort_order":1,
			"two_column_view":false,
			"values":[
				{
					"key":"fully_synthetic",
					"value":"синтетика",
					"is_popular":false
				},
				{
					"key":"semi_synthetic",
					"value":"полусинтетика",
					"is_popular":false
				},
				{
					"key":"mineral",
					"value":"минеральное",
					"is_popular":false
				}
			]
		},
		{
			"property":"viscosity",
			"value_type":"list",
			"value_count":"one",
			"descr":"Вязкость",
			"descr_full":"<strong><strong><span>Международный уровень классификации&nbsp;</span><strong>SAE J300</strong><span>.</span><br /></strong></strong>\r\n<div id=\"yandex_ad\">&nbsp; &nbsp; Эта классификация подразделяет моторные масла&nbsp;12 классов&nbsp;от 0W до 60:&nbsp;6 зимних&nbsp;(0W, 5W, 10W, 15W, 20W, 25W) и&nbsp;6 летних&nbsp;(10, 20, 30, 40, 50, 60) классов вязкости.&nbsp;</div>\r\n&nbsp;&nbsp;&nbsp;&nbsp;Буква W перед цифрой означает, что масло приспособлено к работе при низкой температуре (Winter - зима). Для этих масел кроме минимальной вязкости при 100&deg;C дополнительно дается температурный предел прокачиваемости масла в холодных условиях. Предельная температура прокачиваемости означает минимальную температуру, при которой насос двигателя в состоянии подавать масло в систему смазки. Это значение температуры можно рассматривать как минимальную температуру, при которой возможен безопасный пуск двигателя.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;Всесезонные масла обозначаются сдвоенным номером, первый из которых указывает максимальные значения динамической вязкости масла при отрицательных температурах и гарантирует пусковые свойства, а второй - определяет характерный для соответствующего класса вязкости летнего масла диапазон кинематической вязкости при 100&deg;С и динамической вязкости при 150&deg;С.&nbsp;<strong><br /></strong>",
			"is_required":true,
			"is_enable":true,
			"is_extended":false,
			"is_minimized":false,
			"allow_multiple":true,
			"sort_order":0,
			"two_column_view":true,
			"values":[
				{
					"key":"5W-30",
					"value":"",
					"is_popular":true
				},
				{
					"key":"10W-40",
					"value":"",
					"is_popular":true
				},
				{
					"key":"5W-40",
					"value":"",
					"is_popular":true
				},
				{
					"key":"15W-40",
					"value":"",
					"is_popular":false
				}
			]
		},
		{
			"property":"acea_spec",
			"value_type":"list",
			"value_count":"many",
			"descr":"Спецификация ACEA",
			"descr_full":"<span>Классификация </span><strong>ACEA - Association des Constructeurs Europeens de L'Automobile</strong><span>(Ассоциация Европейских Производителей Автомобилей). </span><span><br />Классификация \"<strong>ACEA European Oil Sequences for Service Fill Oils 1998</strong>\" состоит из трех классов последовательности испытаний - A, B, E. Каждый класс в свою очередь подразделяется на категории, обозначенные арабскими цифрами. Далее указывается год введения в действие, а также может быть указание на второе, более позднее, издание данной нормы. <br />&nbsp;&nbsp;&nbsp;&nbsp;<strong>А - бензиновые двигатели</strong> (А1, А2, A3 и A5); <br />&nbsp;&nbsp;&nbsp;&nbsp;<strong>В - дизельные двигатели</strong> малой мощности, устанавливаемые на легковые и грузовые автомобили малой мощности (В1, В2, ВЗ, В4 и B5); <br />&nbsp;&nbsp;&nbsp;&nbsp;<strong>Е - дизельные двигатели</strong> для тяжелого транспорта (Е1, Е2, ЕЗ, Е4, Е5 и Е7). <br />&nbsp;&nbsp;&nbsp;&nbsp;Цифра после буквы обозначает уровень требований. Чем больше номер, тем выше требования. Исключениями являются уровни А1 и В1, которые относятся к маслам с малой вязкостью, т. н. \"топливосберегающим\". Класс В4 в основном совпадает с классом В2, но дополнен испытаниями на двигателях с непосредственным впрыском топлива.<br /></span>",
			"is_required":false,
			"is_enable":true,
			"is_extended":false,
			"is_minimized":true,
			"allow_multiple":true,
			"sort_order":3,
			"two_column_view":true,
			"values":[
				{
					"key":"A3",
					"value":"",
					"is_popular":true
				},
				{
					"key":"B4",
					"value":"",
					"is_popular":true
				},
				{
					"key":"C3",
					"value":"",
					"is_popular":true
				},
				{
					"key":"B3",
					"value":"",
					"is_popular":true
				},
				{
					"key":"E7",
					"value":"",
					"is_popular":true
				}
			]
		},
		{
			"property":"liquid_volume",
			"value_type":"range",
			"value_count":"one",
			"values":{
				"min":0,
				"max":1000
			},
			"descr":"Объём, л.",
			"descr_full":"",
			"is_required":true,
			"is_enable":true,
			"is_extended":false,
			"is_minimized":false,
			"allow_multiple":true,
			"sort_order":6,
			"two_column_view":false
		}
	]
}
Описание ответа

Объект	Описание
descr	Локализованное наименование товарной группы
brands	Массив брендов каталога. Описание одного элемента массива:
brand - наименование,
is_popular - признак популярности бренда,
sort_order - порядок сортировки. Список брендов для блока над фильтрами каталога (is_popular:"true" отображаются сразу, остальные после открытия полного списка брендов. На своём сайте вы можете изменить поведение на то, которое считаете лучшим.
goods_group	Идентификатор товарной группы (полный список)
criterias	Массив с фильтрами, их свойствами (которые определяют поведение на фронте) и возможными значениями.

property - идентификатор свойства, используется для запроса через операцию /cp/catalog/search списка артикулов, который удовлетворяет переданным значениям свойств;

value_type - тип значения для отображения в каталоге. Возможны варианты: list - список значений (много "чекбоксов", например, тип масла) или range - диапазон значений (например, объём масла в упаковке);

descr - локализованное описание свойства;

descr_full - расширенное локализованное описание (для пользователей, с описанием фильтра и значений);

is_minimized - нужно ли по-умолчанию отрисовывать фильтр "свёрнутым";

allow_multiple - если true И value_type:"list", то отображаем значения "чекбоксами", иначе "радио";

sort_order - порядок фильтра при отображении в блоке фильтров;

two_column_view - если true, то значения фильтров можно отрисовывать в 2 колонки (короткие, например, вязкость);

values - массив со списком возможных значений, key используется как выбранное значение фильтра в /cp/catalog/search, value - - для отображения пользователю на фронте. Если value_type:"range", то вместо списка значений содержится информация о минимальном и максимальном значении;

is_popular аналогично списку брендов, отображать ли значение сразу или прятать под "спойлер";
Получение списка артикулов по переданным значениям фильтров
Операция: /cp/catalog/search

Метод: POST

Метод возвращает список артикулов, которые удовлетворяют переданным фильтрам (из операции /cp/catalog/info)

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
goods_group	Идентификатор товарной группы (полный список)
properties	Массив передаваемых значений фильтров, properties[key][0]=value, properties[key][0]=value и так далее, где key - идентификатор соответствующего свойства из массива criterias операции /cp/catalog/info, а value - идентификатор значения (которое выбрал пользователь в каталоге в блоке фильтров);
skip, limit	Сколько записей пропустить и сколько вернуть в ответе
locale	Локаль, по-умолчанию (если значение не передано) - ru_RU
Пример запроса

 https://demo.public.api.abcp.ru/cp/catalog/search
Тело POST запроса

 userlogin=username&userpsw=md5pass&goods_group=oils&properties[brands][0]=Shell&properties[viscosity][0]=5W-40
Пример ответа

{
	"articles":[
		{
			"brand":"Shell",
			"number":"550051529",
			"alt_number":"550040295",
			"alt_out_number":"550040295",
			"rating":29884
		},
		{
			"brand":"Shell",
			"number":"550055905",
			"alt_number":null,
			"alt_out_number":null,
			"rating":21322
		},
		{
			"brand":"Shell",
			"number":"550051580",
			"alt_number":null,
			"alt_out_number":null,
			"rating":9775
		},
		{
			"brand":"Shell",
			"number":"550058241",
			"alt_number":null,
			"alt_out_number":null,
			"rating":8084
		},
		{
			"brand":"Shell",
			"number":"550051497",
			"alt_number":null,
			"alt_out_number":null,
			"rating":7795
		}
	],
	"count":118
}
Описание ответа

Объект	Описание
articles	Массив с парами бренд+номер, которые удовлетворяют переданным параметрам фильтрации.
count	Общее количество записей, которые удовлетворяют переданным параметрам фильтрации
Пакетное получение информации об артикулах
Операция: /cp/articles/info/batch

Метод: POST

Возвращает массив локализованных карточек товара (как в методе articles/info)

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
articles	Массив деталей, по которым необходимо получить информацию в формате brand - number. Максимум 100 деталей.
locale	Локаль, по-умолчанию (если значение не передано) - ru_RU
Пример запроса

 https://demo.public.api.abcp.ru/cp/articles/info/batch


Тело POST запроса

 userlogin=username&userpsw=md5pass&articles[0][number]=550051529&articles[0][brand]=Shell&articles[1][number]=3148675&articles[1][brand]=LUKOIL
Пример ответа

[
	{
		"brand":"Shell",
		"descr":"Масло моторное синтетика 5W-40 4 л.",
		"images":[
			{
				"name":"099abad5db73fb63e1a2c04dea3d62ff0b254e0002.jpeg",
				"order":0
			}
		],
		"images_count":1,
		"number":"550051529",
		"properties":{
			"EAN-13":"5011987055711",
			"Высота, мм":"300",
			"Вязкость":"5W-40",
			"Длина, мм":"232",
			"Допуски производителей":[
				"MB 229.3",
				"Renault RN 0700",
				"Renault RN 0710",
				"VW 502 00",
				"VW 505 00"
			],
			"Масса, кг":"3.56",
			"Модель":"Helix HX8 5W-40",
			"Объем упаковки, л":"6.8",
			"Объём, л.":"4",
			"Описание":"Масло моторное синтетика 5W-40 4 л.",
			"Состав масла":"синтетика",
			"Спецификация API":[
				"SN",
				"SN+"
			],
			"Тип ёмкости":"Канистра пластиковая",
			"Товарная группа":"масла ДВС",
			"Ширина, мм":"98"
		}
	},
	{
		"brand":"LUKOIL",
		"descr":"Масло моторное синтетическое 5W-40 4 л.",
		"images":[
			{
				"name":"0952f1108d975488197379b8060fa749c4d2d00002.jpeg",
				"order":0
			}
		],
		"images_count":1,
		"number":"3148675",
		"properties":{
			"EAN-13":"4670027146140",
			"Высота, мм":"318",
			"Вязкость":"5W-40",
			"Длина, мм":"188",
			"Допуски производителей":[
				"BMW Longlife-01",
				"FIAT 9.55535-N2",
				"FIAT 9.55535-Z2",
				"GM-LL-B-025",
				"PORSCHE A40",
				"PSA B71 2296"
			],
			"Масса, кг":"3.68",
			"Модель":"GENESIS ARMORTECH 5W-40",
			"Объем упаковки, л":"7.5",
			"Объём, л.":"4",
			"Описание":"Масло моторное синтетическое 5W-40 4 л.",
			"Состав масла":"синтетика",
			"Спецификация ACEA":[
				"A3",
				"B3",
				"B4"
			],
			"Спецификация API":[
				"CF",
				"SN"
			],
			"Тип ёмкости":"Канистра пластиковая",
			"Товарная группа":"масла ДВС",
			"Ширина, мм":"126"
		}
	}
]
Описание ответа (элементов массива в ответе)

Параметр	Описание
brand	Имя производителя
number	Искомый номер детали
descr	Локализованное описание детали
images	Массив с именами файлов изображений деталей. В массиве указаны имена файлов расположенных по адресу https://pubimg.4mycar.ru/images/
images_count	Количество изображений деталей
properties	Локализованный массив свойств детали: описание, вес, объем и т.п.
Пользовательские каталоги
Загрузка каталога из файла
Операция: /cp/usercatalogs/{catalogId}/upload

Метод: POST

Загружает файл со структурой каталога.

Дополнительно загружает архив с изображениями (необязательно).

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
catalogId	Идентификатор каталога
file	Файл структуры каталога переданный в multipart/form-data
encoding	Необязательный параметр. Кодировка загружаемого файла. Доступно два значения: "windows-1251" и "utf-8". По умолчанию равен "windows-1251".
deleteOldMode	Необязательный параметр. Режим удаления старой структуры. По умолчанию равен 0. Может принимать значения 0 - не удалять, 1 - удалить ранее залитые товары, 2 - удалить ранее залитые ветви и товары.
imageUploadMode	Необязательный параметр. Режим загрузки изображений к каталогу. По умолчанию равен 0. Может принимать значения 0 - не загружать, 1 - загрузить из архива, 2 - загрузка по URL в поле PIC.
imagesArchive	Необязательный параметр. Файл архива изображений переданный в multipart/form-data.
Пример запроса

 curl -i -X POST -H "Content-Type: multipart/form-data" -F "file=@/home/user/mycatalog.txt" https://demo.public.api.abcp.ru/cp/usercatalogs/17334/upload?userlogin=username&userpsw=md5pass

Описание ответа

Метод возвращает статус 200, если файл с каталогом принят на загрузку.

Если в процессе загрузки возникли ошибки, возвращается статус отличный от 200 и объект с полями:

Параметр	Описание
errorCode	Код ошибки
errorMessage	Текст сообщения об ошибке


API.TS.Client
Статья Обсуждение
Главная > API.TS.Client
Содержание
API TS - Общий интерфейс
Приемка
Операция создания приёмки
Операция: ts/goodReceipts/create

Метод: POST

Создаёт приёмку с позициями. Дата создания устанавливается текущая.

Место хранения указывается в панели управления в разделе Настройки склада -> общие.

Для создания приёмки у пользователя должно быть включено право доступа к API "создание приёмки", а так же активный договор поставки.

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента-поставщика
userpsw	md5-хэш пароля контрагента-поставщика
supplierId	Внутренний код контрагента-поставщика
positions	список позиций
supNumber	[необязательный] номер отгрузки поставщика
supShipmentDate	[необязательный] дата и время отгрузки поставщика в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС
Узел positions содержит набор объектов вида:

Поле	Описание
brand	Название производителя (бренд - необзятально, если передан productId)
number	Номер детали (код производителя - необзятально, если передан productId)
productId	ID товара в своем справочнике, необязательно, если переданы brand и number
quantity	Количество
supBuyPrice	Цена позиции в валюте поставщика
manufacturerCountry	[необязательный] Страна производитель - три английские буквы: RUS - Россия, CNH - Китай, DEU - Германия и т.д. ИЛИ цифровой код страны (643 - Россия, 156 - Китай, 276 - Германия)
gtd	[необязательный] Номер ГТД
warrantyPeriod	[необязательный] Срок гарантийного обслуживания с момента продажи в днях
returnPeriod	[необязательный] Срок гарантированного возврата в днях
barcodes	[необязательный] Штрихкоды разделённые пробелами
comment	[необязательный] Комментарий
descr	[необязательный] Описание будущей партии
expectedQuantity	[необязательный] Ожидаемое кол-во товара
soPositionId	[необязательный] Идентификатор позиции заказа поставщику, на основании которой была создана позиция приемки
oldOrderPositionId	[необязательный] Идентификатор позиции старого заказа, на основании которой была создана позиция приемки
wearout	[необязательный] Показатель состояния износа товара (б/у) 0 - новый товар, 10 - отличное, 30 - хорошее, 50 - удовлетворительное, 70 - под восстановление, 90 - ремонтный набор.
Пример запроса

https://demo.public.api.abcp.ru/ts/goodReceipts/create
Параметры POST

userlogin=username&userpsw=md5pass&code=userCode&positions[0][brand]=febi&positions[0][number]=01089&positions[0][quantity]=3&positions[0][supBuyPrice]=100&positions[0][manufacturerCountry]=rus&positions[0][gtd]=123123&positions[0][warrantyPeriod]=30&positions[0][returnPeriod]=14&positions[0][barcodes]=4027816010666%202053000000666&position[0][expectedQuantity]=7.4&position[0][soPositionId]=123456&position[0][oldOrderPositionId]=3832215&positions[1][brand]=PATRON&positions[1][number]=pse40273&positions[1][quantity]=2&positions[1][supBuyPrice]=75&positions[1][manufacturerCountry]=chn&positions[1][gtd]=3432142154&positions[1][warrantyPeriod]=44&positions[1][returnPeriod]=33&positions[1][barcodes]=46000550077%2046000550088&position[1][expectedQuantity]=7.5&position[1][soPositionId]=123457&position[1][oldOrderPositionId]=3832216
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор созданной приёмки


Получение списка операций приёмки
Операция: ts/goodReceipts/get

Метод: GET

Для получения списка приёмок у пользователя должно быть включено право доступа к API "Получение информации из TS"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
output	[необязательный] формат вывода, флаг 'd' - загрузка удалённых операций, 'e' - загрузка дополнительной информации (договора), 's' - суммы по позициям, кол-во позиций
auto	[необязательный] автоопределяемое поле (поиск по частичному номеру операции или идентификатору, если задано число)
creatorId	[необязательный] идентификатор сотрудника-создателя
workerId	[необязательный] идентификатор сотрудника-исполнителя
agreementId	[необязательный] идентификатор договора
statuses	[необязательный] статусы через запятую (1 - новая, 2 - в работе, 3 - завершена)
number	[необязательный] номер операций
dateStart	[необязательный] начальная дата диапазона поиска в формате rfc3339
dateEnd	[необязательный] конечная дата диапазона поиска в формате rfc3339
supNumber	[необязательный] номер отгрузки поставщика
Пример запроса

https://demo.public.api.abcp.ru/ts/goodReceipts/get?userlogin=username&userpsw=md5pass&limit=30&output=sde&statuses=3
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор операции приёмки
number	Номер операции
createDate	Дата создания операции
status	Статус
creatorId	Идентификатор сотрудника-создателя
workerId	Идентификатор сотрудника-исполнителя
isDelete	Признак удаления
supplierId	Идентификатор поставщика
agreementId	Идентификатор соглашения
supNumber	Номер отгрузки поставщика
supShipmentDate	Дата отгрузки поставщика
buyAmount	Сумма приёмки в валюте магазина
supBuyAmount	Сумма приёмки в валюте договора
positionsCount	Количество позиций в операции
sumQuantity	Количество товаров в операции
agreement	Договор
supplier	Поставщик


Получение списка позиций приёмки
Операция: ts/goodReceipts/getPositions

Метод: GET

Для получения списка позиций приёмки у пользователя должно быть включено право доступа к API "Получение информации из TS"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
opId	[обязательный] идентификатор операции
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
output	[необязательный] формат вывода, 'e' - загрузка дополнительной информации (справочные товары)
productId	[необязательный] идентификатор товара справочника
auto	[необязательный][не менее 3х символов] автоопределяемое поле
Пример запроса

https://demo.public.api.abcp.ru/ts/goodReceipts/getPositions?userlogin=username&userpsw=md5pass&limit=30&output=e&opId=3
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции приёмки
productId	Идентификатора товара в справочнике
quantity	Количество
supBuyPrice	Цена закупки в валюте договора
supToResRate	Курс валюты магазина к валюте договора
buyPrice	Цена закупки в валюте магазина
sellPrice	Цена продажи
manufacturerCountry	Страна производитель товара
warrantyPeriod	Гарантийный период в днях
returnPeriod	Срок возврата
attrs	Дополнительные параметры(штрихкоды, комментарий, описание партии)
data	Дополнительные данные о связях позиции приёмки с заказами покупателя и поставщику
locId	Идентификатор места хранения
product	Карточка товара
Отгрузка
Получение списка операций отгрузки (расход)
Операция: ts/orderPickings/get

Метод: GET

Для получения списка операций отгрузки у пользователя должно быть включено право доступа к API "Получение информации из TS"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
output	формат вывода, флаг 'd' - загрузка удалённых операций, 'e' - загрузка дополнительной информации (договора), 's' - суммы по позициям, кол-во позиций
auto	[необязательный] автоопределяемое поле (поиск по частичному номеру операции или идентификатору, если задано число)
creatorId	[необязательный] идентификатор сотрудника-создателя
workerId	[необязательный] идентификатор сотрудника-исполнителя
agreementId	[необязательный] идентификатор договора
status	[необязательный] статусы через запятую (1 - новая, 2 - в работе, 3 - завершена, 4 - аннулирована)
number	[необязательный] номер операций
dateStart	[необязательный] начальная дата диапазона поиска в формате rfc3339
dateEnd	[необязательный] конечная дата диапазона поиска в формате rfc3339
coOldPosIds	[необязательный] список идентификаторов позиций старых заказов
Пример запроса

https://demo.public.api.abcp.ru/ts/orderPickings/get?userlogin=username&userpsw=md5pass&limit=30&output=sde&status=3&coOldPosIds[]=11111&coOldPosIds[]=11112
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор отгрузки
number	Номер операции
createDate	Дата создания операции
status	Статус
creatorId	Идентификатор сотрудника-создателя
workerId	Идентификатор сотрудника-исполнителя
isDelete	Признак удаления
clientId	Идентификатор клиента
agreementId	Идентификатор соглашения
accountDetailsId	Идентификатор реквизитов магазина
agreement	Договор
accountDetails	Реквизиты магазина
client	Клиент
goodSumSellPrice	Стоимость всех товаров операции
goodSumClSellPrice	Стоимость всех товаров операции, отформатированная в соответствии с настройками магазина
goodPositionsCount	Количество позиций товаров в операции
goodSumQuantity	Количество товаров в операции
serviceSumSellPrice	Стоимость всех услуг операции
serviceSumClSellPrice	Стоимость всех услуг операции, отформатированная в соответствии с настройками магазина
servicePositionsCount	Количество позиций услуг в операции
serviceSumQuantity	Количество услуг в операции
Получение списка позиций товаров отгрузки
Операция: ts/orderPickings/getGoods

Метод: GET

Для получения списка позиций товаров отгрузки у пользователя должно быть включено право доступа к API "Получение информации из TS"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
opId	[обязательный, если не заполнен opIds] идентификатор операции
opIds	[обязательный, если не заполнен opId] идентификаторы операции через запятую
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
output	[необязательный] формат вывода, 'e' - загрузка дополнительной информации (справочные товары), 'o' - дополнительно вернуть инфу об операции
productId	[необязательный] идентификатор товара справочника
itemId	[необязательный] идентификатор партии товара
ignoreCanceled	[необязательный] не возвращать позиции аннулированных операций
Пример запроса

https://demo.public.api.abcp.ru/ts/orderPickings/getGoods?userlogin=username&userpsw=md5pass&limit=30&skip=30&output=eo&opId=3&ignoreCanceled=1
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор отгрузки
coPositionId	Идентификатор позиции заказ(в настоящее время не используется)
oldCoPositionId	Идентификатор позиции заказа
quantity	Количество
itemId	Идентификатор партии
clToResRate	Курс валюты договора с покупателем к валюте договора
sellPrice	Цена продажи
сlSellPrice	Цена продажи, отформатированная в соответствии с настройками магазина
product	Карточка товара
operationInfo	Информация об операции
availableQuantityCC	Количество товаров, доступное для возврата
Возвраты покупателя
Получение списка операций возврата покупателя
Операция: ts/customerComplaints/get

Метод: GET

Для получения списка возвратов у пользователя должно быть включено право доступа к API "Получение информации из TS"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
auto	[необязательный] автоопределяемое поле (поиск по частичному номеру операции или идентификатору, если задано число)
creatorId	[необязательный] идентификатор сотрудника-создателя
expertId	[необязательный] идентификатор сотрудника-эксперта
orderPickingId	[необязательный] идентификатор отгрузки
positionStatuses	[необязательный] массив статусов позиций
tagIDs	[необязательный] массив идентификаторов тегов
positionAuto	[необязательный] автоопределяемый параметр для поиска по позициям операции
number	[необязательный] номер операции
dateStart	[необязательный] начальная дата диапазона поиска в формате rfc3339
dateEnd	[необязательный] конечная дата диапазона поиска в формате rfc3339
skip	[необязательный] количество операций в ответе, которое нужно пропустить
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
output	[необязательный] формат вывода, 'e' - загрузка дополнительной информации(операция отгрузки и договор), 's' - будет возвращена дополнительная информация о количестве позиций во всех возможных статусах.
fields	[необязательный] загрузка дополнительной информации. Строка со следующими параметрами через запятую:
orderPicking - операция отгрузки, по которой создан возврат

agreement - договор, по которому выполнена отгрузка

posInfo - информация о количестве позиций во всех возможных статусах

Пример запроса

https://demo.public.api.abcp.ru/ts/customerComplaints/get?userlogin=username&userpsw=md5pass&limit=30&output=e&pickingId=33
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор операции возврата
number	Номер операции
createDate	Дата создания операции
creatorId	Идентификатор сотрудника-создателя
expertId	Идентификатор сотрудника-эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор соглашения
agreement	Договор
orderPickingId	Идентификатор отгрузки, по который сделан возврат
orderPicking	Информация об операции отгрузки
positionCount	Количество позиций в операции
canceledPositionCount	Количество позиций в статусе "Аннулировано"
Получение списка позиций возврата покупателя
Операция: ts/customerComplaints/getPositions

Метод: GET

Для получения списка позиций операции возврата у пользователя должно быть включено право доступа к API "Получение информации из TS"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
opId	[обязательный, если не заполнен opIds] идентификатор операции
opIds	[обязательный, если не заполнен opId] идентификаторы операции через запятую
orderPickingGoodId	[необязательный] идентификатор позиции отгрузки
orderPickingGoodIds	[необязательный] идентификаторы позиций отгрузки через запятую
pickingIds	[необязательный] идентификаторы операции отгрузки через запятую
oldCoPositionIds	[необязательный] идентификаторы позиции старого заказа через запятую
oldItemID	[необязательный] идентификатор партии из отгрузки
itemId	[необязательный] идентификатор созданной партии
locId	[необязательный] идентификатор места хранения
status	[необязательный] статус позиции
dateStart	[необязательный] минимальная дата создания операции
dateEnd	[необязательный] максимальная дата создания операции
status	статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
type	тип возврата (1 - возврат, 2 - отказ, 3 - брак.)
skip	[необязательный] количество операций в ответе, которое нужно пропустить
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
output	[необязательный] формат вывода, 'e' - загрузка дополнительной информации (справочные товары)
fields	[необязательный] Загрузка дополнительной информации. Строка со следующими параметрами через запятую:
product - товар из справочника

orderPickingInfo - операция отгрузки; позиция отгрузки, связанная с возвратом; доступное для возврата количество

operationInfo - информация об операции

supplierReturnPos - связанный возврат поставщику (null, если такого нет)

Пример запроса

https://demo.public.api.abcp.ru/ts/customerComplaints/getPositions?userlogin=username&userpsw=md5pass&limit=30&output=e&opId=3&status=2&type=1
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции возрата
status	Статус
type	Тип возарата
orderPickingGoodId	Идентификатор позиции товара в операции отгрузки
oldItemId	Идентификатор отгруженной партии
itemId	Идентификатор партии, созданной данной позицией возврата
quantity	Количество
attrs	Объект, содержащий ссылки на загруженные документы и фотографии
product	Карточка товара
pickingDate	Дата и время выдачи товара клиенту
comment	Комментарий
orderPickingGood	Информация о позиции операции отгрузки
orderPicking	Информация об операции отгрузки
availableQuantity	Доступное для возврата количество
Создание возврата покупателя
Операция: ts/customerComplaints/create

Метод: POST

Для создания операции возврата у пользователя должно быть включено право доступа к API "Создание возврата покупателя"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
orderPickingId	[обязательный] идентификатор отгрузки из которой возвращается товар
positions	[обязательный] список позиций
Узел positions содержит набор объектов вида:

Поле	Описание
orderPickingPositionId	Идентификатор позиции отгрузки
quantity	Количество
type	Тип возврата(1-возврат, 2-отказ, 3-брак)
comment	Комментарий
Пример запроса

https://demo.public.api.abcp.ru/ts/customerComplaints/create
Параметры POST

userlogin=username&userpsw=md5pass&orderPickingId=100&positions[0][orderPickingPositionId]=1234&positions[0][quantity]=2&positions[0][type]=3&positions[0][comment]=comment%20for%20position0&positions[1][orderPickingPositionId]=1235&positions[1][quantity]=1&positions[1][type]=2&positions[0][comment]=comment%20for%20position1
Метод возвращает объект операции возврата:

Поле	Описание
id	Идентификатор созданной операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
positionCount	Количество позиций в созданной операции
canceledPositionCount	Количество аннулированных позиций
positions	Список позиций
Узел positions содержит набор объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара) Движение возврата
type	Тип возврата(1-возврат, 2-отказ, 3-брак)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по указанной отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе"
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки
Пакетное создание позиций возврата покупателя
Операция: ts/customerComplaints/createPositionMultiple

Метод: POST

Для создания позиций возврата у пользователя должно быть включено право доступа к API "Создание возврата покупателя"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
positions	[обязательный] список позиций
customerComplaintId	[обязательный, если не указан customerComplaintId] ид операции возврата
customerComplaint	[обязательный, если не указан customerComplaint] данные для создания операции возврата
Узел positions содержит набор объектов вида:

Поле	Описание
orderPickingGoodId	[обязательный] Идентификатор позиции отгрузки
quantity	[обязательный] Количество
type	[обязательный] Тип возврата(1-возврат, 2-отказ, 3-брак)
comment	[обязательный] Комментарий
attrs	приложенные файлы
Где attrs содержит следующее:

docs	список приложенных к позиции документов
images	список приложенных к позиции изображений
И docs, и images содержат список объектов приложенных файлов следующего вида:

name	[обязательный] наименование файла
file	[обязательный] сам файл в виде base64-строки
description	описание файла
Узел customerComplaint содержит набор объектов вида:

Поле	Описание
orderPickingId	[обязательный] Идентификатор операции отгрузки
number	Номер операции возврата
Пример запроса

https://demo.public.api.abcp.ru/ts/customerComplaints/createPositionMultiple
Параметры POST

userlogin=username&userpsw=md5pass&customerComplaint[creatorId]=1234&customerComplaint[orderPickingId]=100&positions[0][orderPickingGoodId]=1000&positions[0][type]=1&positions[0][quantity]=1&positions[0][comment]=comment0positions[1][orderPickingGoodId]=1001&positions[1][type]=3&positions[1][quantity]=2&positions[1][comment]=comment1
Метод возвращает объекты созданных позиций возврата и созданной (или существующей) операции возврата:

Поле	Описание
customerComplaint	Объект операции возврата
positions	Список созданных объектов позиций
Объект customerComplaint имеет следующий вид:

Поле	Описание
id	Идентификатор созданной операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
sbisStatus	Статус выгрузки в СБИС
data	Дополнительная информация о возврате
Узел positions же содержит набор объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара) Движение возврата
type	Тип возврата(1-возврат, 2-отказ, 3-брак)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по указанной отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе"
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
Изменение позиции возврата покупателя
Операция: ts/customerComplaints/updatePosition

Метод: POST

Возможно изменение только количества товара позиции. Изменение возможно только в статусе "новый".

Для изменения позиции возврата у пользователя должно быть включено право доступа к API "Создание возврата покупателя"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
id	[обязательный] идентификатор позиции возврата покупателя
quantity	[обязательный] количество
Пример запроса

https://demo.public.api.abcp.ru/ts/customerComplaints/updatePosition
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&quantity=2
Метод возвращает объект позиции возврата:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
type	Тип возврата(1-возврат, 2-отказ, 3-брак)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по указанной отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе"
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки
Отмена позиции возврата покупателя
Операция: ts/customerComplaints/cancelPosition

Метод: POST

Отмена позиции возможна только в статусе "новый". Отмена позиции происходит путём изменения статуса позиции в статус 6 - аннулировано.

Для отмены позиции возврата у пользователя должно быть включено право доступа к API "Создание возврата покупателя"

Параметры запроса

Параметр	Описание
userlogin	Имя контрагента
userpsw	md5-хэш пароля контрагента
id	[обязательный] идентификатор позиции возврата покупателя
Пример запроса

https://demo.public.api.abcp.ru/ts/customerComplaints/cancelPosition
Параметры POST

userlogin=username&userpsw=md5pass&id=1234
Метод возвращает объект позиции возврата:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
type	Тип возврата(1-возврат, 2-отказ, 3-брак)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе"
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки
Заказы клиентов
Создание заказа по позициям корзины
Операция: /ts/orders/createByCart

Метод: POST

В ПУ, для клиента должны быть разрешены Права доступа к API - "Отправка корзины в заказ"

Параметры запроса (* - обязательный параметр)

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
agreementId	идентификатор соглашения (договора), если не указан, будет задан дефолтный или первый
number	номер заказа, если не указан, то сформируется согласно шаблону номеров заказов, если указан, то проверяется на уникальность
createTime	rfc3339 - дата и время создания заказа, если не указан, заполняется автоматически, не может быть из будущего
positions*	список ID позиций корзины
delivery[methodId]*	ID способа доставки
delivery[meetData][address]*	адрес доставки
delivery[meetData][person]*	контактное лицо
delivery[meetData][contact]*	контакт(телефон) получателя
delivery[meetData][comment]	комментарий
delivery[timeInterval][startTime]	Не обязательный. В разработке. Начало интервала доставки.
delivery[timeInterval][endTime]	Не обязательный. в разработке. Конец интервала доставки.
Пример запроса

https://demo.public.api.abcp.ru/ts/orders/createByCart
Параметры POST

userlogin=username&userpsw=md5pass&positions[0]=1001&positions[1]=1002&delivery[meetData][address]=ул.Пушкина дом Кукушкина 42&delivery[meetData][person]=Иванов Ануар
Метод возвращает объект заказа

Получение списка заказов
Операция: /ts/orders/list

Метод: GET

В ПУ, для клиента должны быть разрешены Права доступа к API - "Чтение заказов"

Параметры запроса (* - обязательный параметр)

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
number	номер заказа
agreementId	идентификатор соглашения
managerId	идентификатор менеджера
deliveryId	идентификатор доставки
brand	бренд товара, полное совпадение
message	комментарий к заказу или позиции заказа
dateStart	rfc3339 начальная дата диапазона поиска по дате создания заказа (обязательное, если задан dateEnd)
dateEnd	rfc3339 конечная дата диапазона поиска по дате создания заказа (обязательное, если задан dateStart)
updateDateStart	rfc3339 начальная дата диапазона поиска по дате обновления заказа
updateDateEnd	rfc3339 конечная дата диапазона поиска по дате обновления заказа
deadlineDateStart	rfc3339 начальная дата диапазона поиска по дате ожидаемой поставки позиций заказа
deadlineDateEnd	rfc3339 конечная дата диапазона поиска по дате ожидаемой поставки позиций заказа
orderIds	идентификаторы заказов через запятую
productIds	идентификаторы карточек товаров через запятую
positionStatuses	статусы позиций заказов через запятую
skip	количество заказов в ответе, которое нужно пропустить
limit	максимальное количество заказов, которое должно быть возвращено в ответе
Пример запроса

https://demo.public.api.abcp.ru/ts/orders/list?userlogin=username&userpsw=md5pass&orderIds[]=942
Метод возвращает объект вида:

Поле	Описание
total	число найденных заказов
list	список найденных заказов
Получение одного заказа
Операция: /ts/orders/get

Метод: GET

В ПУ, для клиента должны быть разрешены Права доступа к API - "Чтение заказов"

Параметры запроса (* - обязательный параметр)

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
orderId*	Идентификатор заказа.
Пример запроса

https://demo.public.api.abcp.ru/ts/orders/get?userlogin=username&userpsw=md5pass&orderId=123
Метод возвращает объект заказа

Отказ от заказа
Операция: /ts/orders/refuse

Метод: POST

В ПУ, для клиента должны быть разрешены Права доступа к API - "Отправка корзины в заказ"

Параметры запроса (* - обязательный параметр)

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
orderId*	Идентификатор заказа принадлежащего контрагенту
Пример запроса

https://demo.public.api.abcp.ru/ts/orders/refuse
Параметры POST

userlogin=username&userpsw=md5pass&orderId=1231
Метод не возвращает данные, при успешном выполнении операции.


Стандартный набор полей заказа
id	Идентификатор заказа
number	Номер заказа
agreementId	Идентификатор соглашения
managerId	Идентификатор ответственного менеджера
createTime	Время создания
updateTime	Время изменения
Возможные значения для статусов позиций заказа
new - Новый
reservation - Бронь
finished - Подтверждён/Завершен
prepayment - Требуется предоплата
orderPicking - Отгрузка
delivery - Доставка
canceled - Аннулировано
supOrder - Заказ поставщику
supOrderCanceled - Заказ поставщику Отказ



Работа с Корзиной
Клиентские операции для работы с корзиной.
* - обязательный параметр
Добавление позиции в корзину
Операция: POST /ts/cart/create

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
brand*	бренд
number*	артикул по стандарту ABCP
quantity*	количество товара
supplierCode*	идентификатор маршрута прайс-листа
itemKey*	Код товара, полученный поиском search/articles
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/create
Параметры POST

userlogin=username&userpsw=md5pass&brand=Febi&number=01089&quantity=1&itemKey=###123
Метод возвращает объект позиции добавленной в корзину

Обновление позиции в корзине
Операция: POST /ts/cart/update

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
positionId*	идентификатор позиции в корзине
quantity*	новое количество
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/update
Параметры POST

userlogin=username&userpsw=md5pass&quantity=1&positionId=333
Метод возвращает объект позиции в корзине

Получение списка позиций в корзине
Операция: GET /ts/cart/list

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
positionIds	список идентификаторов позиций в корзине, через запятую
skip	количество позиций корзины в ответе, которое нужно пропустить
limit	максимальное количество позиций корзины, которое должно быть возвращено в ответе
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/list?userlogin=username&userpsw=md5pass&agreementId=1002&positionIds=123,321
Метод возвращает поля:

total	общее кол-во найденных позиций
list	список найденных позиций
Проверка наличия позиции в корзине
Операция: GET /ts/cart/exist

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
brand*	бренд
numberFix*	"Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/exist?userlogin=username&userpsw=md5pass&agreementId=1002&brand=Febi&numberFix=01089
Метод возвращает поля:

quantity - количество найденных позиций в корзине
Получение суммарной информации по позициям корзины
Операция: GET /ts/cart/summary

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/summary?userlogin=username&userpsw=md5pass&agreementId=1002
Метод возвращает поля:

count	количество позиций в корзине
quantity	количество товаров в корзине
cost	сумма позиций в корзине
Очистка корзины
Операция: POST /ts/cart/clear

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/clear
Параметры POST

userlogin=username&userpsw=md5pass&agreementId=100
Метод возвращает пустой ответ

Удаление позиций корзины
Операция: POST /ts/cart/deletePositions

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
positionIds*	массив идентификаторов позиций
Пример запроса

https://demo.public.api.abcp.ru/ts/cart/deletePositions
Параметры POST

userlogin=username&userpsw=md5pass&positionIds[]=1011&positionIds[]=1012
Метод возвращает пустой ответ

Стандартный набор параметров позиции корзины
id	uint - уникальный идентификатор заказа клиента
brand	string - бренд товара
numberFix	string - "Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
quantity	float - количество
price	float - цена одной позиции товара
createDate	datetime - дата и время добавления позиции в корзину
updateDate	datetime - дата и время изменения позиции в корзине
data[description]	string - описание из результатов поиска
data[packing]	uint - кратность (количество товара в упаковке)
data[availability]	int - наличие у поставщика
data[deadline]	uint - срок поступления на склад в часах
data[deadlineMax]	uint - срок поступления на склад максимальный в часах
Позиции заказов клиентов
Операции для работы с позициями заказов клиентов.
* - обязательный параметр
Получение одной позиции
Операция: GET /ts/positions/get

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
positionId*	идентификатор позиции заказа
additionalInfo	string, доп. информация, значения через запятую
Пример запроса

https://demo.public.api.abcp.ru/ts/positions/get?userlogin=username&userpsw=md5pass&positionId=11112
Метод возвращает объект позиции заказа.

Получение списка позиций
Операция: GET /ts/positions/list

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
brand	string, бренд товара, полное совпадение
message	string, комментарий к позиции
agreementId	uint, идентификатор соглашения
managerId	uint, идентификатор менеджера
noManagerAssigned	флаг, добавляющий в выборку позиции без назначенного менеджера; используется с managerId
dateStart	string, минимальная дата создания позиций заказов
dateEnd	string, максимальная дата создания позиций заказов
updateDateStart	string, минимальная дата обновления заказов
updateDateEnd	string, максимальная дата обновления заказов
deadlineDateStart	string, минимальная дата ожидаемая дата поставки на склад
deadlineDateEnd	string, максимальная дата ожидаемая дата поставки на склад
routeIds	[]uint, идентификаторы маршрутов
distributorIds	[]uint, идентификаторы прайс-листов
ids	[]uint, идентификаторы позиций заказов клиентов
orderIds	[]uint, идентификаторы заказов клиентов
productIds	[]uint, идентификаторы карточек товаров через запятую
statuses	[]string, список статусов позиций заказов
tagIds	[]uint, id тегов через запятую
skip	uint, смещение (по умолчанию 0)
limit	uint, ограничение по кол-ву заказов в выдаче
additionalInfo	string, доп. информация, значения через запятую
Пример запроса

https://demo.public.api.abcp.ru/ts/positions/list?userlogin=username&userpsw=md5pass&brand=Febi&dateStart=2022-05-29 14:20:00&productIds[]=142&productIds[]=143
Метод возвращает объект вида:

Поле	Описание
total	число найденных позиций
list	список найденных позиций
Аннулирование позиции
Операция: POST /ts/positions/cancel

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
positionId*	uint, идентификатор позиции заказа
additionalInfo	string, доп. информация, значения через запятую
Пример запроса

https://demo.public.api.abcp.ru/ts/positions/cancel
Параметры POST

userlogin=username&userpsw=md5pass&positionId=3569
Метод возвращает позицию.

Массовое аннулирование позиций
Операция: POST /ts/positions/massCancel

Параметры запроса

Параметр	Описание
userlogin*	Имя контрагента
userpsw*	md5-хэш пароля контрагента
positionIds*	string, идентификаторы позиций через запятую
additionalInfo	string, доп. информация, значения через запятую
Пример запроса

https://demo.public.api.abcp.ru/ts/positions/massCancel
Параметры POST

userlogin=username&userpsw=md5pass&positionIds=252653,25265
Метод возвращает список позиций.

Объект позиции заказа
id	uint, идентификатор
orderId	uint, ID заказа
status	string, Статус позиции
routeId	uint, ID маршрута
distributorId	uint, ID прайс-листа
refusal	Признак желания клиента отказаться от покупки товара
quantity	float, Количество
price	float, Цена одной позиции
prepaymentAmount	float, Сумма предоплаты
createDate	datetime, Время создания
updateDate	datetime, Время изменения
deadlineTime	datetime, дата и время поставки товара на склад, вычисляется в момент создания createTime + deadline (часы)
deadlineTimeMax	datetime, дата и время поставки товара на склад, вычисляется в момент создания createTime + deadlineMax (часы)
product	доп. информация о товаре
product[brand]	string, Бренд (из корзины)
product[number]	string, номер по формату в ответе от поставщика (из результата поиска)
product[description]	string, описание
product[packing]	uint, Кратность
product[availability]	int, Доступно
product[deadline]	uint, Срок поступления на склад в часах (из корзины)
product[deadlineMax]	uint, Срок поступления на склад максимальный в часах (из корзины)
delivery	object, информация о доставке (*если использовался additionalInfo=delivery при получении позиции)
unpaidAmount	float, суммарная неоплаченная стоимость позиций (*если использовался additionalInfo=unpaidAmount при получении позиции)
Список возможных статусов позиции заказа
prepayment	требуется предоплата
canceled	аннулировано
new	новый
supOrder	заказ поставщику
supOrderCanceled	заказ поставщику, отказ
reservation	бронь
orderPicking	отгрузка
delivery	доставка
finished	завершен

Информация о доставке, позиции заказа клиента

status	string, состояние
trackNumber	string, номер для отслеживания
createDate	datetime, дата создания
startTime	datetime, начало интервала доставки
price	float, цена
prepaid	float, сумма предоплаты
volume	float, суммарный объем
address	string, полный адрес
comment	string, дополнительная информация
contact	string, телефон для связи
person	string, контактное лицо
employeePerson	string, имя сотрудника
employeeContact	string, телефон сотрудника
resellerComment	string, комментарий о месте доставки от магазина
Значения параметра additionalInfo

delivery	информация о доставке
unpaidAmount	сумма, которую должен уплатить клиент, либо оставшаяся сумма заказа/отгрузки
statusName	Выводит наименование статуса позиции заказа, как в ЛК. Если позиция заказа клиента находится в заказе поставщику, дополнительно выводится информация о статусе заказа поставщику в параметре statusNameSO.
Договоры
Получение списка договоров
Операция: GET /ts/agreements/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя контрагента
userpsw*	string	md5-хэш пароля контрагента
ids	[]uint	Список идентификаторов договоров
contractorRequisiteIds	[]uint	Список идентификаторов платёжных реквизитов контрагента
shopRequisiteIds	[]uint	Список идентификаторов платёжных реквизитов магазина
isActive	bool	Признак активности
isDelete	bool	Признак логического удаления
isDefault	bool	Признак договора по умолчанию
agreementType	uint8	Тип договора
relationType	uint8	Тип отношений
number	string	Частичный номер
taxNumber	string	Идентификационный номер налогоплательщика (ИНН для РФ)
currency	string	Валюта
dateStart	string	Минимальная дата создания в формате RFC3339
dateEnd	string	Максимальная дата создания в формате RFC3339
creditLimit	float64	Лимит кредита
limit	uint	Максимально количество объектов в выдаче
offset	uint	Пропуск объектов в выдаче
Пример запроса

https://demo.public.api.abcp.ru/ts/agreements/list?userlogin=username&userpsw=md5pass
Метод возвращает объект вида:

Поле	Описание
total	число найденных договоров
list	список найденных договоров
vertical-align:middle;
Информация
Для пользователя API-администратор операция вернет данные всех контрагентов с учетом заданных параметров.
Объект договора
Параметр	Тип	Описание
id	uint	Идентификатор
createDate	datetime	Дата создания
number	string	Номер
name	string	Название договора
currency	string	Валюта
contractorId	uint	Идентификатор контрагента
shopLegalPersonId	uint|null	Идентификатор ЮЛ магазина
contractorLegalPersonId	uint|null	Идентификатор ЮЛ контрагента
shopRequisiteId	uint|null	Идентификатор реквизитов магазина
contractorRequisiteId	uint|null	Идентификатор реквизитов контрагента
balance	float64	Баланс
agreementType	uint8	Тип договора (оферта или обычный)
relationType	uint8	Тип отношений (покупка или продажа)
isActive	bool	Признак активности
isDelete	bool	Признак логического удаления
isDefault	bool	Признак договора по умолчанию
creditLimit	float64	Лимит кредита
repaymentPeriod	uint8	Отсрочка платежа
isPaymentLate	bool	Стоп-лист/запрет отгрузки/платеж просрочен
latePaymentDate	datetime|null	Дата и время начала отсрочки платежей
Заказы поставщикам
Получение списка заказов
Операция: POST /ts/supplierOrders/orders/list

Параметры запроса

Параметр	Тип	Описание
sendStatuses	[]uint	Список статусов отправки заказа. Варианты: 1 - отправляется, 2 - отправлен, 3 - ошибка, 4 - отправка не требуется
createDateStart	string	Начальная дата в диапазоне поиска по дате создания заказа. Форма rfc3339.
createDateEnd	[]uint	Конечная дата в диапазоне поиска по дате создания заказа. Форма rfc3339.
sendDateStart	string	Начальная дата в диапазоне поиска по дате отправки заказа. Форма rfc3339.
sendDateEnd	[]uint	Конечная дата в диапазоне поиска по дате отправки заказа. Форма rfc3339.
limit	uint	Максимально количество объектов в выдаче
skip	uint	Пропуск объектов в выдаче
Получение списка позиций заказов
Операция: POST /ts/supplierOrders/positions/list

Параметры запроса

Параметр	Тип	Описание
statuses	[]uint	Список статусов
orderId	uint	идентификатор заказа
additionalInfo	string	Дополнительная информация: products - добавить инфу о товарах
limit	uint	Максимально количество объектов в выдаче
skip	uint	Пропуск объектов в выдаче
Варианты значения поля Статус:

1 - Готова к созданию заказа

2 - Добавлена в заказ

3 - Подтвержден поставщиком

4 - В пути

5 - Прибыл

6 - Выполнен

7 - Отказ


API.TS.Admin
Статья Обсуждение
Главная > API.TS.Admin
Содержание
API TS - Административный интерфейс
Операция быстрого создания приёмки, брони, отгрузки
Операция: /cp/ts/orderPickings/fastGetOut

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
number	[необязательный] Номер отгрузки, если пустой, то будет заполнен автоматически
date	[необязательный] Дата отгрузки в формате RFC3339, если пустая, то будет заполнена автоматически
executionDate	[необязательный] Дата проведения/выполнения в формате RFC3339, если пустая, то будет заполнена из date
clientId*	Идентификатор клиента
supplierId*	Идентификатор поставщика
locationId*	Идентификатор места хранения.
positions*	Массив объектов позиций отгрузки:
distributorId	[необязательный] Идентификатор прайс-листа
routeId	[необязательный] Идентификатор маршрута.
locale	[необязательный] Локаль. Например ru_RU. Если не передана, то будет взята локаль по-умолчанию для магазина.
orderPickingResellerData	[необязательный] Дополнительная информация в формате json, которая будет сохранена в операцию отгрузки. Например {"checks":["http://example.com/check1","http://example.com/check2"]}
Узел positions содержит набор объектов вида:

Поле	Описание
brand*	Бренд
numberFix*	"Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
code	[необязательный] Код товара в системе учета магазина
description	[необязательный] Описание
quantity*	Количество
supBuyPrice*	Цена закупки в валюте поставщика, обязательный
supToResRate*	Курс валюты магазина к валюте поставщика
buyPrice*	цена закупки в валюте магазина
sellPrice*	Цена продажи в валюте магазина
clSellPrice*	Цена продажи в валюте клиента
clToResRate*	Курс валюты клиента к валюте магазина
manufacturerCountry	[необязательный] Код страны-производителя. Например RUS или CHN
gtd	[необязательный] Номер ГТД
warrantyPeriod	[необязательный] Срок гарантийного обслуживания с момента продажи в днях
externalId	[необязательный] ID позиции для синхронизации с внешней системой, строка до 15 символов
returnPeriod	[необязательный] Срок гарантийного возврата в днях
productCodes	[необязательный] Массив строк, содержащих коды товара
itemCodes	[необязательный] Массив строк, содержащих коды партии товара
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/fastGetOut
Параметры POST

userlogin=username&userpsw=md5pass&clientId=123123&supplierId=321321&distributorId=44444&routeId=555555&locationId=111&locale=ru_RU&positions[0][brand]=Febi&positions[0][numberFix]=01089&positions[0][description]=Качественный антифриз&positions[0][quantity]=22&positions[0][supBuyPrice]=11&positions[0][supToResRate]=11&positions[0][buyPrice]=121&positions[0][sellPrice]=133&positions[0][clSellPrice]=143&positions[0][clToResRate]=1&positions[0][manufacturerCountry]=ALB&positions[0][gtd]=5435236423&positions[0][warrantyPeriod]=22&positions[0][returnPeriod]=14&positions[0][productCodes][]=123123123&positions[0][productCodes][]=456456456&positions[0][itemCodes][]=1212121212&positions[0][itemCodes][]=2121212121
Ответ не содержит данных:

Отгрузка
Получение списка операций отгрузка (расход)
Операция: /cp/ts/orderPickings/get

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[необязательный] Идентификатор операции. При использовании вернётся одна операция, а не список.
clientId	[необязательный] идентификатор клиента.
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
output	[необязательный] формат вывода, флаг 'e' - загрузка дополнительной информации (договора, места хранения, доставки, упаковки), 't' - загрузка информации о тегах, 's' - суммы по позициям, кол-во позиций
Для указания нескольких флагов стоит писать их слитно, например, output=se

auto	[необязательный] автоопределяемое поле (поиск по частичному номеру операции или идентификатору, если задано число)
creatorId	[необязательный] идентификатор сотрудника-создателя
workerId	[необязательный] идентификатор сотрудника-исполнителя
agreementId	[необязательный] идентификатор договора
statuses	[необязательный] список статусов (1 - новая, 2 - сборка, 5 - готов к выдаче, 3 - завершена, 4 - аннулирована.)
number	[необязательный] номер операций
dateStart	[необязательный] начальная дата диапазона поиска по времени создания в формате rfc3339
dateEnd	[необязательный] конечная дата диапазона поиска по времени создания в формате rfc3339
updateDateStart	[необязательный] начальная дата диапазона поиска по времени обновления в формате rfc3339
updateDateEnd	[необязательный] конечная дата диапазона поиска по времени обновления в формате rfc3339
executionDateStart	[необязательный] начальная дата диапазона поиска завершения отгрузки в формате rfc3339
executionDateEnd	[необязательный] конечная дата диапазона поиска завершения отгрузки в формате rfc3339
coOldPosIds	[необязательный] список идентификаторов позиций старых заказов
fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
agreement - договор, по которому выполнена отгрузка

tags - теги

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/get?userlogin=username&userpsw=md5pass&clientId=555&limit=30&output=ste&statuses[]=2&statuses[]=3&coOldPosIds[]=11111&coOldPosIds[]=11112
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор операции отгрузки
number	Номер операции
createDate	Дата создания операции
executionDate	Дата завершения операции
status	Статус
creatorId	Идентификатор сотрудника-создателя
workerId	Идентификатор сотрудника-исполнителя
clientId	Идентификатор клиента
agreementId	Идентификатор соглашения
locId	Идентификатор места сборки товара
sbisStatus	Статус выгрузки в СБИС
data	Дополнительная информация об операции отгрузки
location	Место сборки товара
agreement	Договор
deliveries	Связанные с отгрузкой операции доставки
tags	Теги
packing	Дополнительная информация об этапе упаковки товара, если того требует связанная операция доставки
goodSumSellPrice	Стоимость всех товаров операции
goodSumClSellPrice	Стоимость всех товаров операции, отформатированная в соответствии с настройками магазина
goodPositionsCount	Количество позиций товаров в операции
goodSumQuantity	Количество товаров в операции
serviceSumSellPrice	Стоимость всех услуг операции
serviceSumClSellPrice	Стоимость всех услуг операции, отформатированная в соответствии с настройками магазина
servicePositionsCount	Количество позиций услуг в операции
serviceSumQuantity	Количество услуг в операции


Получение списка позиций товаров операции отгрузки
Операция: /cp/ts/orderPickings/getGoods

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
opId*	[обязательный, если не заполнен opIds] идентификатор операции.
opIds*	[обязательный, если не заполнен opId] идентификаторы операции через запятую
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
productId	[необязательный] идентификатор товара справочника
itemId	[необязательный] идентификатор партии товара
ignoreCanceled	[необязательный] не возвращать позиции аннулированных операций
pickingDateStart	[необязательный] начальная дата диапазона поиска по времени создания отгрузки в формате rfc3339
pickingDateEnd	[необязательный] конечная дата диапазона поиска по времени создания отгрузки в формате rfc3339
updateDateStart	[необязательный] начальная дата диапазона поиска по времени обновления позиции в формате rfc3339
updateDateEnd	[необязательный] конечная дата диапазона поиска по времени обновления позиции в формате rfc3339
fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
item - информация о партии

operationInfo - дополнительная информация об операции отгрузки

location - информация о месте хранения

product - информация о товаре из справочника

co - информация о заказе клиента

tags - теги

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/getGoods?userlogin=username&userpsw=md5pass&opId=3&limit=30&skip=30&ignoreCanceled=1&fields=item,co
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции отгрузки
coPositionId	Идентификатор позиции заказ(в настоящее время не используется)
oldCoPositionId	Идентификатор позиции заказа
quantity	Количество
itemId	Идентификатор партии
clToResRate	Курс валюты договора с покупателем к валюте договора
sellPrice	Цена продажи
сlSellPrice	Цена продажи, отформатированная в соответствии с настройками магазина
product	Карточка товара
operationInfo	Информация об операции
availableQuantityCC	Количество товаров, доступное для возврата


Создание операции отгрузки по клиентскому заказу
Операция: /cp/ts/orderPickings/createByOldPos

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
opId	[необязательный] идентификатор операции для добавления позиций. Если не указан - будет создана новая операция отгрузки.
statusId	[обязательный при указании флага doneRightAway] статус позиции заказа, в который будут переведены указанные позиции в случае успешного добавления в операцию отгрузки. При указании флага doneRightAway статус должен иметь признак списания.
agreementId	Идентификатор договора. Если не передать - будет выбран договор по-умолчанию или любой активный.
accountDetailsId	[обязательный] идентификатор реквизитов магазина
locId	[обязательный] идентификатор места сборки или отгрузки клиентского заказа. Значение "не установлено" - 0.
ppIds	[обязательный] список идентификаторов позиций старых заказов для добавления в отгрузку
createDate	[необязательный] дата и время создания отгрузки в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС (rfc3339), если не указано - используется текущая дата и время
doneRightAway	[необязательный] 1 - сразу завершить операцию после добавления позиций.
output	[необязательный] расширенный формат вывода. 'e' - загрузка дополнительной информации (договора, реквизиты, клиент), 't' - загрузка информации о тегах, 's' - загрузка суммарной информации о позициях
Для указания нескольких флагов стоит писать их слитно, например, output=se

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/createByOldPos
Параметры POST

userlogin=username&userpsw=md5pass&opId=33&statusId=4444&agreementId=1&accountDetailsId=1&locId=33&doneRightAway=1&ppIds[]=123123123&ppIds[]=234234234
Метод возвращает объект вида:

Узел positions содержит набор объектов вида:

Поле	Описание
id	Идентификатор позиции отгрузки
opId	Идентификатор операции
coPositionId	Идентификатор позиции нового заказа(не используется)
oldCoPositionId	Идентификатор позиции старого заказа
quantity	Количество
itemId	Идентификатор партии
clToResRate	Курс валюты клиента к валюте магазина
clSellPrice	Цена продажи в валюте клиента
sellPrice	Цена продажи в валюте магазина
product	Товар
item	Партия
locations	Места хранения
storageZones	Складские зоны
orderPickingGoodLinks	Связи мест хранения позиций
availableQuantityCC	Количество доступное к возврату.
tags	Теги


Изменение статуса операции отгрузка
Операция: /cp/ts/orderPickings/changeStatus

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[обязательный] идентификатор операции отгрузка.
operationStatusId	[обязательный] статус в который требуется перевести отгрузку: 1 - новая, 2 - сборка, 5 - готов к выдаче, 3 - завершена, 4 - аннулирована.
Движение отгрузки

positionsStatusId	[обязательный при смене статуса операции с 5 на 3 и с 3 на 5] идентификатор статуса в который требуется перевести связанные с отгрузкой позиции заказов. При переводе из статуса "готов к выдаче" в статус "завершена" требуется указать статус с признаком "списание товара на складе". При переводе из статуса "завершена" в статус "готов к выдаче" требуется указать статус с признаком "бронирование товара".
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/changeStatus
Параметры POST

userlogin=username&userpsw=md5pass&id=33&operationStatusId=3&positionsStatusId=4444
Ответ не содержит данных:

Изменение операции отгрузка
Операция: /cp/ts/orderPickings/update

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[обязательный] идентификатор операции отгрузки.
number	[необязательный] номер операции
creatorId	[необязательный] идентификатор сотрудника-создателя
workerId	[необязательный] идентификатор сотрудника-исполнителя
clientId	[необязательный] идентификатор клиента
agreementId	[необязательный] идентификатор договора
accountDetailsId	[необязательный] идентификатор реквизитов магазина
locId	[необязательный] идентификатор места хранения
resellerData	[необязательный] Дополнительная информация в формате json, которая будет сохранена в операцию отгрузки. Например {"checks":["http://example.com/check1","http://example.com/check2"]}
executionDate	[необязательный] дата и время выполнения операции, формат rfc3339 (ее можно изменить только для завершенной отгрузки, status=3)
fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
agreement - договор, по которому выполнена отгрузка

tags - теги

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/update
Параметры POST

userlogin=username&userpsw=md5pass&id=33&agreementId=3&accountDetailsId=6&workerId=345&number=otgruzka-33
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор позиции
number	Номер операции
createDate	Дата создания
status	Статус операции: 1 - новая, 2 - сборка, 5 - готов к выдаче, 3 - завершена, 4 - аннулирована.
creatorId	Идентификатор сотрудника-создателя
workerId	Идентификатор сотрудника-исполнителя
clientId	Идентификатор клиента
agrementId	Идентификатор договора
accountDetailsId	Идентификатор реквизитов
locId	Идентификатор места хранения
data	Дополнительная информация об операции отгрузки
agreement	Договор
accountDetails	Реквизиты
client	Клиент
tags	Теги
goodSumSellPrice	Сумма (количество * цена продажи в валюте магазина) по позициям товара
goodSumClSellPrice	сумма (количество * цена продажи в валюте клиента) по позициям товара
goodPositionsCount	Количество позиций товара
goodSumQuantity	Суммарное количество товара по позициям
serviceSumSellPrice	Сумма (количество * цена продажи в валюте магазина) по позициям услуг
serviceSumClSellPrice	Сумма (количество * цена продажи в валюте клиента) по позициям услуг
servicePositionsCount	Количество позиций услуг
serviceSumQuantity	Суммарное количество услуг по позициям


Удаление позиции товара из операции отгрузки
Операция: /cp/ts/orderPickings/deletePosition

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[обязательный] идентификатор позиции операции отгрузки.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orderPickings/deletePosition
Параметры POST

userlogin=username&userpsw=md5pass&id=33
Ответ не содержит данных:

Возврат покупателя
Получение списка возвратов покупателя
Операция: /cp/ts/customerComplaints/get

Метод: GET

Возвращает список операций возврата покупателя

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	[необязательный] Идентификатор операции. При использовании вернётся одна операция, а не список.
clientId	[необязательный] Идентификатор клиента для фильтра операций.
creatorId	[необязательный] Идентификатор сотрудника-создателя.
expertId	[необязательный] Идентификатор сотрудника-эксперта.
auto	[необязательный] Автоопределяемый параметр для поиска по операции.
number	[необязательный] Номер операции.
orderPickingId	[необязательный] Идентификатор операции отгрузки по выдаче клиенту.
positionStatuses	[необязательный] Поиск операций, которые содержат позиции в указанных статусах. Параметр указывается цифрами через запятую:
1 - Новая

2 - В работе

3 - Отказ

4 - Завершено

5 - Возвращено клиенту

6 - Аннулировано

7 - Отклонено

8 - Ожидаем возврат товара

Движение возврата

positionType	[необязательный] поиск операций, которые содержат позиции указанного типа(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
positionAuto	[необязательный] - автоопределяемый параметр для поиска по позициям операции.
dateStart	[необязательный] Начальная дата диапазона поиска по времени создания (rfc3339, например, 2021-01-17T19:00:00.000Z).
dateEnd	[необязательный] Конечная дата диапазона поиска по времени создания (rfc3339, например, 2021-01-17T19:00:00.000Z).
updateDateStart	[необязательный] Начальная дата диапазона поиска по времени обновления (rfc3339, например, 2021-01-17T19:00:00.000Z).
updateDateEnd	[необязательный] Конечная дата диапазона поиска по времени обновления (rfc3339, например, 2021-01-17T19:00:00.000Z).
skip	[необязательный] Количество операций в ответе, которое нужно пропустить.
limit	[необязательный] Количество операций, которое нужно получить.
output	[устарело] Расширенный формат вывода. 'e' - загрузка дополнительной информации (операции выдачи клиенту, договора), 't' - загрузка информации о тегах, 's' - загрузка суммарной информации о позициях.
Для указания нескольких флагов стоит писать их слитно, например, output=se

fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
orderPicking - операция отгрузки, по которой создан возврат

agreement - договор, по которому выполнена отгрузка

tags - теги

posInfo - загрузка суммарной информации о позициях

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/get?userlogin=username&userpsw=md5pass&clietnId=5555&output=e&limit=10
Метод возвращает список операций возврата покупателя:

Поле	Описание
id	Идентификатор операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
positionCount	Количество позиций в созданной операции
canceledPositionCount	Количество аннулированных позиций
tags	Список тегов, назначенных операции


Получение списка позиций операции возврата покупателя
Операция: /cp/ts/customerComplaints/getPositions

Метод: GET

Возвращает список позиций операции возврата покупателя

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
opId	[необязательный] Идентификатор операции
opIds	[необязательный] Идентификаторы операций через запятую.
orderPickingGoodId	[необязательный] Идентификатор позиции отгрузки по выдаче клиенту.
orderPickingGoodIds	[необязательный] Идентификаторы позиций отгрузки через запятую.
executionDateStart	[необязательный] начальная дата диапазона поиска завершения позиции в формате rfc3339
executionDateEnd	[необязательный] конечная дата диапазона поиска завершения позиции в формате rfc3339
pickingIds	[необязательный] Идентификаторы операции отгрузки.
oldCoPositionIds	[необязательный] Идентификаторы позиции заказа через запятую.
clientId	[необязательный] Идентификатор клиента.
oldItemID	[необязательный] Идентификатор старой партии.
itemId	[необязательный] Числовой идентификатор партии.
tagIds	[необязательный] Идентификаторы тегов через запятую.
locId	[необязательный] Идентификатор места хранения.
status	[необязательный] Статус позиции.
1 - Новая

2 - В работе

3 - Отказ

4 - Завершено

5 - Возвращено клиенту

6 - Аннулировано

7 - Отклонено

8 - Ожидаем возврат товара

type	[необязательный] Тип возврата (1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт).
dateStart	[необязательный] Минимальная дата создания операции в формате по времени создания (rfc3339, например, 2021-01-17T19:00:00.000Z).
dateEnd	[необязательный] Максимальная дата создания операции в формате по времени создания rfc3339 (rfc3339, например, 2021-01-17T19:00:00.000Z).
updateDateStart	[необязательный] Начальная дата диапазона поиска по времени обновления (rfc3339, например, 2021-01-17T19:00:00.000Z).
updateDateEnd	[необязательный] Конечная дата диапазона поиска по времени обновления (rfc3339, например, 2021-01-17T19:00:00.000Z).
skip	[необязательный] Количество операций в ответе, которое нужно пропустить.
limit	[необязательный] Максимальное количество позиций, которое дожно быть возвращено в ответе.
sort	[необязательный] Как сортировать позиции: status - по статусу, createDate - по дате создания операции.
output	[необязательный] Расширенный формат вывода. 'e' - загрузка дополнительной информации (карточки товаров, партия, позиции и операции отгрузки, доступное количество для возврата), t - загрузка информации о тегах.
Для указания нескольких флагов стоит писать их слитно, например, output=te

fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
item - товар на складе

product - товар из справочника

location - место хранения

orderPickingInfo - операция отгрузки; позиция отгрузки, связанная с возвратом; доступное для возврата количество

tags - теги

operationInfo - информация- Дополнительная информация. Воз об операции

supplierReturnPos - связанный возврат поставщику (null, если такого нет)

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/getPositions?userlogin=username&userpsw=md5pass&opId=100&output=et
Метод возвращает список позиций операции возврата покупателя:

id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по операции отгрузки
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе")
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
executionDate	Дата завершения позиции
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект операции отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки
tags	Список тегов, назначенных позиции


Создание возврата покупателя
Операция: /cp/ts/customerComplaints/create

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderPickingId	[обязательный] идентификатор операции отгрузки из которой возвращается товар
createDate	[необязательный] дата и время создания отгрузки в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС (rfc3339), если не указано - используется текущая дата и время
positions	[обязательный] список позиций
Узел positions содержит набор объектов вида:

Поле	Описание
orderPickingPositionId	Идентификатор позиции отгрузки
quantity	Количество
type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
comment	Комментарий
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/create
Параметры POST

userlogin=username&userpsw=md5pass&orderPickingId=100&positions[0][orderPickingPositionId]=1234&positions[0][quantity]=2&positions[0][type]=3&positions[0][comment]=comment%20for%20position0&positions[1][orderPickingPositionId]=1235&positions[1][quantity]=1&positions[1][type]=2&positions[0][comment]=comment%20for%20position1
Метод возвращает объект операции возврата:

Поле	Описание
id	Идентификатор созданной операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
positionCount	Количество позиций в созданной операции
canceledPositionCount	Количество аннулированных позиций
positions	Список позиций
Узел positions содержит набор объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
Движение возврата

type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по операции отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе")
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект операции отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки


Создание позиции возврата покупателя
Операция: /cp/ts/customerComplaints/createPosition

Метод: POST

Параметры запроса

userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
opId	[обязательный] идентификатор операции возврата
orderPickingPositionId	[обязательный] идентификатор позиции отгрузки
quantity	[обязательный] количество к возврату
type	[обязательный] тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
comment	[обязательный] комментарий
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/createPosition
Параметры POST

userlogin=username&userpsw=md5pass&opId=123&orderPickingPositionId=1234=&quantity=2&type=3&comment=Comment%20for%20position
Метод возвращает объект позиции возврата:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
Движение возврата

type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по операции отгрузка
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе")
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект операции отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки


Пакетное создание позиций возврата покупателя
Операция: /cp/ts/customerComplaints/createPositionMultiple

Метод: POST

Параметры запроса

userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positions	[обязательный] список позиций
customerComplaintId	[обязательный, если не указан customerComplaintId] ид операции возврата
customerComplaint	[обязательный, если не указан customerComplaint] данные для создания операции возврата
customComplaintFile	кастомный файл заявки на возврат в виде строки в формате base64

Узел positions содержит набор объектов вида:

Поле	Описание
orderPickingGoodId	[обязательный] Идентификатор позиции отгрузки
quantity	[обязательный] Количество
type	[обязательный] Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
comment	[обязательный] Комментарий
attrs	приложенные файлы
Где attrs содержит следующее:

docs	список приложенных к позиции документов
images	список приложенных к позиции изображений
И docs, и images содержат список объектов приложенных файлов следующего вида:

name	[обязательный] наименование файла
file	[обязательный] сам файл в виде base64-строки
description	описание файла

Узел customerComplaint содержит набор объектов вида:

Поле	Описание
orderPickingId	[обязательный] Идентификатор операции отгрузки
creatorId	[обязательный] Идентификатор создателя возврата
expertId	Идентификатор эксперта
number	Номер операции возврата
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/createPositionMultiple
Параметры POST

userlogin=username&userpsw=md5pass&customerComplaint[creatorId]=1234&customerComplaint[orderPickingId]=100&positions[0][orderPickingGoodId]=1000&positions[0][type]=1&positions[0][quantity]=1&positions[0][comment]=comment&positions[1][orderPickingGoodId]=1001&positions[1][type]=3&positions[1][quantity]=2&positions[1][comment]=comment1
Метод возвращает объекты созданных позиций возврата и созданной (или существующей) операции возврата:

Поле	Описание
customerComplaint	Объект операции возврата
positions	Список созданных объектов позиций
Объект customerComplaint имеет следующий вид:

Поле	Описание
id	Идентификатор созданной операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
sbisStatus	Статус выгрузки в СБИС
data	Дополнительная информация о возврате
Узел positions же содержит набор объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара) Движение возврата
type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по указанной отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе")
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий


Изменение позиции возврата покупателя
Операция: /cp/ts/customerComplaints/updatePosition

Метод: POST

Изменение возможно только в статусе "новый".

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[обязательный] идентификатор позиции возврата покупателя
quantity	[необязательный] количество
type	[необязательный] тип возврата
comment	[необязательный] комментарий
executionDate	[необязательный] дата и время выполнения, формат RFC3399, (можно изменять только если позиция находится в статусе "Завершен", status=4)
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/updatePosition
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&quantity=2&type=3&comment=Comment%20for%20position
Метод возвращает объект позиции возврата:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
Движение возврата

type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по указанной отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе")
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект операции отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки


Изменение статуса позиции возврата покупателя
Операция: /cp/ts/customerComplaints/changeStatusPosition

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[обязательный] идентификатор позиции возврата покупателя
status	[обязательный] статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
Движение возврата

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/changeStatusPosition
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&status=8
Метод возвращает объект позиции возврата:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции
status	Статус позиции (1-новая, 2-в работе, 3-отказ, 4-завершёно, 5-возвращено клиенту, 6-аннулировано, 7-отклонено, 8-ожидаем возврат товара)
type	Тип возврата(1-возврат, 2-отказ, 3-брак, 4-недовоз, 5-пересорт)
orderPickingGoodId	Идентификатор позиции отгрузки
oldItemId	Идентификатор партии, отгруженной по указанной отгрузке
itemId	Идентификатор партии, созданной операцией возврат(назначается при переводе позиции в статус "в работе")
locId	Идентификатор места хранения принятого товара
quantity	Количество
attrs	Список добавленных к позиции документов и изображений
pickingDate	Дата и время выдачи товара обратно клиенту
comment	Комментарий
product	Карточка товара
orderPickingGood	Объект позиции отгрузки
orderPicking	Объект операции отгрузки
availableQuantity	Количество товара, доступное к возврату по позиции отгрузки
Обновление информации в возврате покупателя
Операция: /cp/ts/customerComplaints/update

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id	[обязательный] идентификатор операции возврата покупателя
number	[обязательный если не задан expertId] уникальный номер операции
expertId	[обязательный если не задан number] идентификатор сотрудника-эксперта
customComplaintFile	[необязательный] - форма "Заявка на возврат", файл, передавать строкой в формате base64. Для удаления файла - указать пустое значение.
fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
orderPicking - операция отгрузки, по которой создан возврат

agreement - договор, по которому выполнена отгрузка

posInfo - загрузка суммарной информации о позициях

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/update
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&number=123&expertId=111
Метод возвращает объект операции возврата:

Поле	Описание
id	Идентификатор операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
orderPicking	Объект операции отгрузки
agreement	Объект договора
posInfo	Объект суммарной информации о позициях


Обновление файла в возврате покупателя
Операция: /cp/ts/customerComplaints/updateCustomFile

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
id*	идентификатор операции возврата покупателя
customComplaintFile*	форма "Заявка на возврат", файл, передавать строкой в формате base64. Для удаления файла - указать пустое значение.
fields	[необязательный] Расширенный формат вывода. Набор из следующих строк через запятую:
orderPicking - операция отгрузки, по которой создан возврат

agreement - договор, по которому выполнена отгрузка

posInfo - загрузка суммарной информации о позициях

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/customerComplaints/update
Параметры POST

userlogin=username&userpsw=md5pass&id=1234
Метод возвращает объект операции возврата:

Поле	Описание
id	Идентификатор операции
number	Номер операции
createDate	Дата создания
creatorId	Идентификатор пользователя, создавшего опреацию
expertId	Идентификатор пользователя, назначенного в качестве эксперта
clientId	Идентификатор клиента
agreementId	Идентификатор договора с клиентом
orderPickingId	Идентификатор отгрузки
orderPicking	Объект операции отгрузки
data.customComplaintFile	Не пустое значение означает что для возврата загружена форма "Заявка на возврат"
agreement	Объект договора
posInfo	Объект суммарной информации о позициях


Возврат поставщику
Получение списка возвратов поставщику
Операция: GET /cp/ts/supplierReturns/operations/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
creatorId	uint	Идентификатор пользователя, создавший возврат
supplierId	uint	Идентификатор контрагента
goodsReceiptId	uint	Идентификатор приемки
agreementIds	[]uint	Идентификаторы договоров
tagIds	[]uint	Идентификаторы тегов через запятую
sbisStatuses	[]string	Список статусов СБИС
dateStart	string	Минимальная дата создания в формате RFC3399
dateEnd	string	Максимальная дата создания в формате RFC3399
updateDateStart	string	Минимальная дата обновления в формате RFC3399
updateDateEnd	string	Максимальная дата обновления в формате RFC3399
skip	uint	Пропуск записей
limit	uint	Ограничение количества записей в выборке
fields	string	Дополнительная информация (значения через запятую)
Параметр fields

Параметр	Описание
goodsReceipt	информация по приемке
agreement	информация о договоре
tags	идентификаторы тегов
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/operations/list?userlogin=username&userpsw=md5pass
Метод возвращает набор объектов возвратов.



Получение сумм возвратов поставщику
Операция: GET /cp/ts/supplierReturns/operations/sum

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
creatorId	uint	Идентификатор пользователя, создавший возврат
supplierId	uint	Идентификатор контрагента
goodsReceiptId	uint	Идентификатор приемки
agreementIds	[]uint	Идентификаторы договоров
tagIds	[]uint	Идентификаторы тегов через запятую
sbisStatuses	[]string	Список статусов СБИС
dateStart	string	Минимальная дата создания в формате RFC3399
dateEnd	string	Максимальная дата создания в формате RFC3399
updateDateStart	string	Минимальная дата обновления в формате RFC3399
updateDateEnd	string	Максимальная дата обновления в формате RFC3399
skip	uint	Пропуск записей
limit	uint	Ограничение количества записей в выборке
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/operations/sum?userlogin=username&userpsw=md5pass
Метод возвращает объект сумм возвратов.



Просмотр объекта возврата поставщику
Операция: GET /cp/ts/supplierReturns/operations/get

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор возврата
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/operations/get?userlogin=username&userpsw=md5pass?id=1234
Метод возвращает объект возврата.



Создание возврата поставщику
Операция: POST /cp/ts/supplierReturns/operations/create

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
creatorId*	uint	Идентификатор пользователя, создавший возврат
supplierId*	uint	Идентификатор контрагента
goodsReceiptId*	uint	Идентификатор приемки
agreementId*	uint	Идентификатор договора
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/operations/create
Параметры POST

userlogin=username&userpsw=md5pass&creatorId=1234&supplierId=1234&goodsReceiptId=1234&agreementId=1234
Метод возвращает объект возврата.



Обновление возврата поставщику
Операция: POST /cp/ts/supplierReturns/operations/update

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор возврата
number	string	Номер возврата
fields	string	Дополнительная информация в выдаче объекта (значения через запятую)
Параметр fields

Параметр	Описание
goodsReceipt	информация по приемке
agreement	информация о договоре
tags	идентификаторы тегов
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/operations/update
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&number=someNumber&fields=goodsReceipt,tags
Метод возвращает объект возврата.



Удаление возврата поставщику
Операция: POST /cp/ts/supplierReturns/operations/delete

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор возврата
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/operations/delete
Параметры POST

userlogin=username&userpsw=md5pass&id=1234
Метод ничего не возвращает.

Получение списка позиций возврата поставщику
Операция: GET /cp/ts/supplierReturns/positions/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
opId	uint	Идентификатор возврата
opIds	string	Идентификаторы возврата (через запятую)
status	uint8	Статус позиции.
1 - Новый

2 - Заявка отправлена

3 - Заявка подтверждена

4 - В работе

5 - Завершен

6 - Аннулирован

7 - Заявка отклонена

8 - Отказ (у поставщика)

9 - Отказ (получен)

type	uint8	Тип возврата
goodsReceiptPosIds	string	Идентификаторы позиций приемок (через запятую)
itemIds	string	Идентификаторы партий (через запятую)
supplierId	string	Идентификатор поставщика
goodsReceiptIds	string	Идентификаторы приемки (через запятую)
dateStart	string	Минимальная дата создания в формате RFC3399
dateEnd	string	Максимальная дата создания в формате RFC3399
updateDateStart	string	Минимальная дата обновления в формате RFC3399
updateDateEnd	string	Максимальная дата обновления в формате RFC3399
skip	uint	Пропуск записей
limit	uint	Ограничение количества записей в выборке
fields	string	Дополнительная информация (значения через запятую)
Параметр fields

Параметр	Описание
product	информация о товаре из справочника
item	информация по партии товара
location	расширяет список позиций возврата МХ
operationInfo	информация об операции возврата
tags	информация о тегах
goodsReceiptPos	информация о позициях приемки
availableQuantity	информация об остатках
customerComplaintPos	информация о возврата покупателю
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/list?userlogin=username&userpsw=md5pass
Метод возвращает набор объектов позиций возврата.

Получение сумм позиций возврата поставщику
Операция: GET /cp/ts/supplierReturns/positions/sum

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
opId	uint	Идентификатор возврата
status	uint8	Статус позиции.
1 - Новый

2 - Заявка отправлена

3 - Заявка подтверждена

4 - В работе

5 - Завершен

6 - Аннулирован

7 - Заявка отклонена

8 - Отказ (у поставщика)

9 - Отказ (получен)

type	uint8	Тип возврата
goodsReceiptPosIds	string	Идентификаторы позиций приемок (через запятую)
itemIds	string	Идентификаторы партий (через запятую)
supplierId	string	Идентификатор контрагента
goodsReceiptIds	string	Идентификаторы приемки (через запятую)
dateStart	string	Минимальная дата создания в формате RFC3399
dateEnd	string	Максимальная дата создания в формате RFC3399
updateDateStart	string	Минимальная дата обновления в формате RFC3399
updateDateEnd	string	Максимальная дата обновления в формате RFC3399
skip	uint	Пропуск записей
limit	uint	Ограничение количества записей в выборке
fields	string	Дополнительная информация (значения через запятую)
Параметр fields

Параметр	Описание
item	информация по партии товара
location	расширяет список позиций возврата МХ
operationInfo	информация об операции возврата
tags	информация о тегах
goodsReceiptPos	информация о позициях приемки
availableQuantity	информация об остатках
customerComplaintPos	информация о возврата покупателю
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/sum?userlogin=username&userpsw=md5pass
Метод возвращает набор объектов сумм позиций возврата.

Получение данных о количестве позиций, находящихся в не конечных статусах
Операция: GET /cp/ts/supplierReturns/positions/status

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/status?userlogin=username&userpsw=md5pass
Метод возвращает объект счетчиков позиций в не конечных статусах.

Просмотр объекта позиции возврата поставщику
Операция: GET /cp/ts/supplierReturns/positions/get

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор позиции
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/get?userlogin=username&userpsw=md5pass?id=1234
Метод возвращает объект позиции возврата.

Создание позиций возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/createMultiple

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
opId*	uint	Идентификатор возврата
posesData*	[]posesData	Информация о позициях
Объект posesData

Параметр	Тип	Описание
type*	uint8	Тип возврата
goodsReceiptPosId*	uint	Идентификатор позиции приемки
locId*	uint	Идентификатор МХ, где лежит товар для возврата
quantity*	float64	Количество
customerComplaintPosId	uint	Идентификатор позиции возврата от клиента
itemId	uint	Идентификатор партии товара
comment	string	Комментарий
В запросе необходимо объявить минимум один из параметров customerComplaintPosId или itemId

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/createMultiple
Параметры POST

userlogin=username&userpsw=md5pass&type=1&goodsReceiptPosId=123&locId=123&quantity=2.0&itemId=123
Метод возвращает набор объектов позиций возврата.

Разделение позиции возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/split

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор позиции товара
quantity*	float64	Количество
fields	string	Поля для загрузки в расширенной структуре (через запятую)
Параметр fields

Параметр	Описание
item	информация по партии товара
location	расширяет список позиций возврата МХ
operationInfo	информация об операции возврата
tags	информация о тегах
goodsReceiptPos	информация о позициях приемки
availableQuantity	информация об остатках
customerComplaintPos	информация о возврата покупателю
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/split
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&quantity=2.0
Метод возвращает набор объектов позиций возврата.

Обновление позиции возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/update

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор партии товара
type	uint8	Тип возврата
locId	uint	МХ, где лежит товар для возврата
quantity*	float64	Количество
comment	string	Комментарий к позиции
fields	string	Поля для загрузки в расширенной структуре (через запятую)
executionDate	datetime	Дата и время выполнения операции, формат rfc3339, изменение возможно только для позиции в конечном статусе, status=5 - завершен
Параметр fields

Параметр	Описание
item	информация по партии товара
location	расширяет список позиций возврата МХ
operationInfo	информация об операции возврата
tags	информация о тегах
goodsReceiptPos	информация о позициях приемки
availableQuantity	информация об остатках
customerComplaintPos	информация о возврата покупателю
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/update
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&type=2&quantity=2.0
Метод возвращает объект позиции возврата.

Изменение статуса позиции возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/changeStatus

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор позиции
status	uint8	Статус позиции.
1 - Новый

2 - Заявка отправлена

3 - Заявка подтверждена

4 - В работе

5 - Завершен

6 - Аннулирован

7 - Заявка отклонена

8 - Отказ (у поставщика)

9 - Отказ (получен)

fields	string	Поля для загрузки в расширенной структуре (через запятую)
Параметр fields

Параметр	Описание
item	информация по партии товара
location	расширяет список позиций возврата МХ
operationInfo	информация об операции возврата
tags	информация о тегах
goodsReceiptPos	информация о позициях приемки
availableQuantity	информация об остатках
customerComplaintPos	информация о возврата покупателю
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/changeStatus
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&status=2
Метод возвращает объект позиции возврата.

Создание атрибута позиции возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/attr/create

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор позиции
attr*	Attribute	Объект атрибута
Объект Attrubute

Параметр	Тип	Описание
name*	string	Название
file*	string	Содержимое файла в кодировке Base64
creatorId	uint	Идентификатор инициатора
description	string	Описание
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/attr/create
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&attr[name]=договор&attr[file]=aGVsbG8gd29ybGQ=
Метод возвращает объект атрибута позиции возврата.

Обновление атрибута позиции возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/attr/update

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор позиции
oldName*	string	Прежнее название атрибута
newName*	string	Новое название атрибута
description*	string	Описание атрибута
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/attr/update
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&oldName=договор&newName=заявление&description=заявление+на+возврат
Метод возвращает объект атрибута позиции возврата.

Удаление атрибута позиции возврата поставщику
Операция: POST /cp/ts/supplierReturns/positions/attr/delete

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
id*	uint	Идентификатор позиции
name*	string	Название атрибута
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/supplierReturns/positions/attr/delete
Параметры POST

userlogin=username&userpsw=md5pass&id=1234&name=договор
Метод ничего не возвращает.

Объект возврата поставщику
Параметр	Тип	Описание
id	uint	Идентификатор
number	string	Номер возврата
createDate	string	Дата создания
creatorId	uint	Идентификатор создателя возврата
supplierId	uint	Идентификатор контрагента
agreementId	uint	Идентификатор договора
goodsReceiptId	uint	Идентификатор приемки
sbisStatus	string	Статус СБИС
tags	[]uint	Теги
Объект сумм возвратов поставщикам
Параметр	Тип	Описание
positionsTotalSum	float64	сумма закупки (из позиции приемки) в валюте магазина
operationsCount	uint	количество возвратов
positionsCount	uint	количество позиций
goodsQuantity	uint	суммарное количество товара по позициям
countPositionsByStatus	positionsByStatus	кол-во позиций сгруппированных по статусу
Объект positionsByStatus

Параметр	Тип	Описание
new	uint	в статусе "Новый"
requestSent	uint	в статусе "Заявка отправлена"
requestAccepted	uint	в статусе "Заявка принята"
inWork	uint	в статусе "В работе"
finished	uint	в статусе "Завершен"
canceled	uint	в статусе "Аннулирован"
requestCanceled	uint	в статусе "Заявка отклонена"
supplierRejected	uint	в статусе "Отказ (у поставщика)"
supplierReturned	uint	в статусе "Отказ (получен)"
Объект позиции возврата поставщику
Параметр	Тип	Описание
id	uint	Идентификатор
opId	uint	Идентификатор операции (возврата)
status	uint8	Статус позиции.
1 - Новый

2 - Заявка отправлена

3 - Заявка подтверждена

4 - В работе

5 - Завершен

6 - Аннулирован

7 - Заявка отклонена

8 - Отказ (у поставщика)

9 - Отказ (получен)

type	uint8	Тип возврата
goodsReceiptPosId	uint|null	Идентификатор позиции приемки
customerComplaintPosId	uint|null	Идентификатор позиции возврата от клиента
itemId	uint|null	Идентификатор партии товара
locId	uint|null	Идентификатор МХ, где лежит товар для возврата
quantity	float64	Количество
attrs	[]SupplierReturnPositionAttrs	Дополнительные свойства: фотографии, описания, документы
issueDate	datetime|null	Дата и время передачи товара от магазина поставщику
executionDate	datetime|null	Дата и время выполнения
acceptanceBackDate	datetime|null	Дата и время приемки товара на склад при передаче его от поставщика магазину
comment	datetime|null	Комментарий к позиции
Объект SupplierReturnPositionAttrs

Параметр	Тип	Описание
name	string	Название
contentType	string	Тип контента
fileAPIName	string	Имя файла в fileAPI
description	string	Описание
creatorId	string	Идентификатор автора
uploadDate	datetime	Дата загрузки
Объект сумм позиций возврата поставщику
Параметр	Тип	Описание
positionsTotalSum	float64	Сумма закупки (из позиции приемки) в валюте магазина
positionsCount	uint	Количество позиций
goodsQuantity	uint	Суммарное количество товара по позициям
countPositionsByStatus	positionsByStatus	кол-во позиций сгруппированных по статусу
Объект positionsByStatus

Параметр	Тип	Описание
new	uint	В статусе "Новый"
requestSent	uint	В статусе "Заявка отправлена"
requestAccepted	uint	В статусе "Заявка принята"
inWork	uint	В статусе "В работе"
finished	uint	В статусе "Завершен"
canceled	uint	В статусе "Аннулирован"
requestCanceled	uint	В статусе "Заявка отклонена"
supplierRejected	uint	В статусе "Отказ (у поставщика)"
supplierReturned	uint	В статусе "Отказ (получен)"


Объект счетчиков позиций в не конечных статусах
Параметр	Тип	Описание
1	uint	В статусе "Новый"
2	uint	В статусе "Заявка отправлена"
3	uint	В статусе "Заявка принята"
4	uint	В статусе "В работе"
8	uint	В статусе "Отказ (у поставщика)"
Объект атрибута позиции возврата поставщику
Параметр	Тип	Описание
name	uint	Название
contentType	string	Тип контента
fileAPIName	string	Название файла в fileAPI
description	string	Описание
creatorId	uint	Идентификатор инициатора
uploadDate	datetime	Дата загрузки атрибута


Поставщики
Получение привязанного контрагента
Операция: /cp/ts/distributorOwners

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
distributorId	Идентификатор поставщика.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/distributorOwners?userlogin=username&userpsw=md5pass&distributorId=11112
Метод возвращает массив объектов вида:

Поле	Описание
userId	Идентификатор контрагента
name	Полное имя контрагента
email	Адрес электронной почты
city	Город
mobile	Мобильный номер телефона
Заказы клиентов
Административные операции для работы с заказами клиентов.
* - обязательный параметр
Создание заказа
Операция: /cp/ts/orders/create

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
number	номер заказа клиента, если не указан, то сформируется согласно шаблону номеров заказов, если указан, то проверяется на уникальность
clientId*	идентификатор клиента
agreementId	идентификатор соглашения (договора)
createTime	rfc3339 - дата и время создания заказа, если не указан, заполняется автоматически, не может быть из будущего
managerId	идентификатор сотрудника, ответственного за заказ
fields	дополнительная информация, поля
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/create
Параметры POST

userlogin=username&userpsw=md5pass&agreementId=1002&managerId=33&fields=agreement
Метод возвращает объект заказа

Создание заказа по позициям корзины
Операция: /cp/ts/orders/createByCart

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
number	номер заказа клиента, если не указан, то сформируется согласно шаблону номеров заказов, если указан, то проверяется на уникальность
clientId*	идентификатор клиента
agreementId*	идентификатор соглашения (договора)
createTime	rfc3339 - дата и время создания заказа, если не указан, заполняется автоматически, не может быть из будущего
managerId	идентификатор сотрудника, ответственного за заказ
positions*	список ID позиций корзины
delivery[methodId]	ID способа доставки
delivery[meetData][address]*	string - адрес доставки
delivery[meetData][person]*	string - контактное лицо
delivery[meetData][contact]*	string - контакт(телефон) получателя
delivery[meetData][comment]	комментарий
delivery[meetData][employeePerson]	string - контактный сотрудник
delivery[meetData][employeeContact]	string - контакт сотрудника
delivery[meetData][resellerComment]	string - комментарий от магазина
delivery[timeInterval][startTime]	rfc3339 - время начала интервала доставки
delivery[timeInterval][endTime]	rfc3339 - время конца интервала доставки
locale	string - локаль для сохранения описаний товаров
fields	дополнительная информация, поля
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/createByCart
Параметры POST

userlogin=username&userpsw=md5pass&positions[0]=1001&positions[1]=1002&delivery[meetData][address]=ул.Пушкина дом Кукушкина 42&delivery[meetData][person]=Иванов Ануар
Метод возвращает массив заказов

Получение списка заказов
Операция: /cp/ts/orders/list

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
number	номер заказа
agreementId	идентификатор соглашения
managerId	идентификатор менеджера
deliveryId	идентификатор доставки
message	комментарий к заказу или позиции заказа
dateStart	rfc3339 начальная дата диапазона поиска по дате создания заказа(обязательное, если задан dateEnd)
dateEnd	rfc3339 конечная дата диапазона поиска по дате создания заказа(обязательное, если задан dateStart)
updateDateStart	rfc3339 начальная дата диапазона поиска по дате обновления заказа
updateDateEnd	rfc3339 конечная дата диапазона поиска по дате обновления заказа
deadlineDateStart	rfc3339 начальная дата диапазона поиска по дате ожидаемой поставки позиций заказа
deadlineDateEnd	rfc3339 конечная дата диапазона поиска по дате ожидаемой поставки позиций заказа
orderIds	идентификаторы заказов через запятую
productIds	идентификаторы карточек товаров через запятую
positionStatuses	статусы позиций заказов через запятую
skip	количество заказов в ответе, которое нужно пропустить
limit	максимальное количество заказов, которое должно быть возвращено в ответе
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/list?userlogin=username&userpsw=md5pass&agreementId=256
Метод возвращает объект вида:

Поле	Описание
total	число найденных заказов
list	список найденных заказов
Получение одного заказа
Операция: /cp/ts/orders/get

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	Идентификатор заказа.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/get?userlogin=username&userpsw=md5pass&orderId=123
Метод возвращает объект заказа

Отказ от заказа
Операция: /cp/ts/orders/refuse

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	Идентификатор заказа
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/refuse
Параметры POST

userlogin=username&userpsw=md5pass&orderId=1231
Метод не возвращает данные, при успешном выполнении операции.

Обновление заказа
Операция: /cp/ts/orders/update

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	числовой идентификатор заказа
number	номер заказа клиента, если не указан, то сформируется согласно шаблону номеров заказов, если указан, то проверяется на уникальность
clientId	идентификатор клиента
agreementId	идентификатор соглашения (договора)
managerId	идентификатор сотрудника, ответственного за заказ
fields	дополнительная информация, поля
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/update
Параметры POST

userlogin=username&userpsw=md5pass&orderId=1002&number=newOrderNumber&fields=agreement
Метод возвращает объект заказа

Объединение заказов
Операция: /cp/ts/orders/merge

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
mainOrderId*	идентификатор главного заказа объединения
mergeOrdersIds	массив, идентификаторы остальных заказов объединения
fields	дополнительная информация, поля
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/merge
Параметры POST

userlogin=username&userpsw=md5pass&mainOrderId=1002&mergeOrdersIds[]=1003
Метод возвращает объект заказа

Разделение заказа
Операция: /cp/ts/orders/split

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	идентификатор заказа разделения
positionIds	массив, идентификаторы отделяемых позиций заказа
fields	дополнительная информация, поля
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/split
Параметры POST

userlogin=username&userpsw=md5pass&orderId=1002&positionIds[]=3003&positionIds[]=3004
Метод возвращает объект:

order	объект исходного заказа с полями
newOrder	объект нового заказа с полями


Изменение суммы заказа
Операция: /cp/ts/orders/reprice

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	идентификатор заказа клиента
newSum	новая сумма заказа
fields	дополнительная информация, поля
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/reprice
Параметры POST

userlogin=username&userpsw=md5pass&orderId=1002&newSum=442.42
Метод возвращает объект заказа

Сообщения по заказам
Создание сообщения
Операция: /cp/ts/orders/messages/create

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	идентификатор заказа клиента
message	текст сообщения
employeeId	идентификатор сотрудника (если не указано, то будет использоваться API-администратор)
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/messages/create
Параметры POST

userlogin=username&userpsw=md5pass&orderId=1002&message=text for message
Метод возвращает объект сообщения

Получение одного сообщения
Операция: /cp/ts/orders/messages/get

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
messageId*	идентификатор сообщения
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/messages/get?userlogin=username&userpsw=md5pass&messageId=1002

Метод возвращает объект сообщения

Получение списка сообщений
Операция: /cp/ts/orders/messages/list

Метод: GET

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	идентификатор заказа
skip	количество сообщений в ответе, которое нужно пропустить
limit	максимальное количество сообщений в ответе
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/messages/list?userlogin=username&userpsw=md5pass&orderId=1002&skip=3&limit=5

Метод возвращает объект:

total	количество сообщений без учета параметров skip и limit
list	список сообщений
Редактирование сообщения
Операция: /cp/ts/orders/messages/update

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
messageId*	идентификатор сообщения
message	текст сообщения
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/messages/update
Параметры POST

userlogin=username&userpsw=md5pass&messageId=1002&message=the text
Метод возвращает объект сообщения



Удаление сообщения
Операция: /cp/ts/orders/messages/delete

Метод: POST

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
messageId*	идентификатор сообщения
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/orders/messages/delete
Параметры POST

userlogin=username&userpsw=md5pass&messageId=1002
Метод не возвращает данных в случае успешного выполнения операции.



Значения параметра fields
agreement	информация о соглашении
tags	теги заказов и их позиций
posInfo	информация о позициях
deliveries	получить карту операций доставки, связанных с позициями заказа, карта будет добавлена в элемент posInfo
amounts	возвращает fullAmount - полная стоимость заказа, unpaidAmount - суммарная неоплаченная стоимость позиций
Стандартный набор полей заказа

id	uint - уникальный идентификатор заказа клиента
number	uint - номер заказа клиента
clientId	uint - идентификатор клиента
agreementId	uint - идентификатор соглашения
managerId	uint - Идентификатор ответственного менеджера
createTime	datetime - Время создания
updateTime	datetime - Время изменения
data[clToResRate]	float64 - Курс между валютой магазина и валютой договора с клиентом
data[discountPercent]	Скидка (процент)
Объект сообщения в заказе

id	уникальный идентификатор сообщения
orderId	идентификатор заказа клиента
employeeId	идентификатор сотрудника
date	datetime - дата и время
message	текст сообщения
Возможные значения для статусов позиций заказа
new - Новый
reservation - Бронь
finished - Подтверждён/Завершен
prepayment - Требуется предоплата
orderPicking - Отгрузка
delivery - Доставка
canceled - Аннулировано
supOrder - Заказ поставщику
supOrderCanceled - Заказ поставщику Отказ

Работа с Корзиной
Административные операции для работы с корзиной.
* - обязательный параметр
Добавление позиции в корзину
Операция: POST /cp/ts/cart/create

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId*	идентификатор клиента
agreementId	идентификатор договора, если не указан, то используется активный договор с клиентом по умолчанию
brand*	бренд
number*	артикул товара
numberFix*	"Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
itemId	идентификатор партии на складе
quantity*	количество товара
distributorRouteId*	идентификатор маршрута прайс-листа
itemKey*	Код товара, полученный поиском search/articles
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/create
Параметры POST

userlogin=username&userpsw=md5pass&clientId=1002&brand=Febi&number=01089&quantity=1&itemKey=###123
Метод возвращает объект позиции корзины

Обновление позиции в корзине
Операция: POST /cp/ts/cart/update

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	идентификатор позиции в корзине
clientId*	идентификатор клиента
guestId	идентификатор гостя, обязательный, если не задан clientId
quantity*	новое количество
sellPrice	цена продаже в валюте магазина
clToResRate	курс между валютой договора с клиентом и валютой магазина
clSellPrice	цена продаже в валюте договора с клиентом
availability	новое наличие в прайс-листе
packing	новая кратность в прайс-листе
deadline	новый срок поставки
deadlineMax	новый максимальный срок поставки
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/update
Параметры POST

userlogin=username&userpsw=md5pass&clientId=1002&quantity=1
Метод возвращает объект позиции корзины

Получение списка позиций в корзине
Операция: GET /cp/ts/cart/list

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId	идентификатор клиента
guestId	идентификатор гостя
positionIds	список идентификаторов позиций в корзине, через запятую
agreementId	идентификатор договора, если не указан, то используется активный договор с клиентом по умолчанию
skip	количество позиций корзины в ответе, которое нужно пропустить
limit	максимальное количество позиций корзины, которое должно быть возвращено в ответе
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/list?userlogin=username&userpsw=md5pass&agreementId=1002&clientId=33&positionIds=123,321
Метод возвращает поля:

total	общее кол-во найденных позиций
list	список найденных позиций
Проверка наличия позиции в корзине
Операция: GET /cp/ts/cart/exist

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId*	идентификатор клиента
agreementId*	идентификатор договора
brand*	бренд
numberFix*	"Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/exist?userlogin=username&userpsw=md5pass&agreementId=1002&clientId=33&brand=Febi&numberFix=01089
Метод возвращает поля:

quantity - количество найденных позиций в корзине
Получение суммарной информации по позициям корзины
Операция: GET /cp/ts/cart/summary

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId*	идентификатор клиента
guestId	идентификатор гостя, обязательный, если не задан clientId
agreementId	идентификатор договора, если не указан, то используется активный договор с клиентом по умолчанию
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/summary?userlogin=username&userpsw=md5pass&agreementId=1002&clientId=33
Метод возвращает поля:

count	количество позиций в корзине
quantity	количество товаров в корзине
cost	сумма позиций в корзине
Очистка корзины
Операция: POST /cp/ts/cart/clear

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId*	идентификатор клиента
guestId	идентификатор гостя, обязательный, если не задан clientId
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/clear
Параметры POST

userlogin=username&userpsw=md5pass&clientId=1002
Метод возвращает пустой ответ

Удаление позиций корзины
Операция: POST /cp/ts/cart/deletePositions

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId*	идентификатор клиента
guestId	идентификатор гостя, обязательный, если не задан clientId
positionIds*	массив идентификаторов позиций
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/deletePositions
Параметры POST

userlogin=username&userpsw=md5pass&clientId=1002&positionIds[]=1011&positionIds[]=1012
Метод возвращает пустой ответ

Передача позиций корзины гостя клиенту
Операция: POST /cp/ts/cart/transfer

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
clientId*	идентификатор клиента
guestId*	идентификатор гостя
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/cart/transfer
Параметры POST

userlogin=username&userpsw=md5pass&clientId=1002&guestId=4242 
Метод возвращает пустой ответ

Стандартный набор параметров позиции корзины
id	uint - уникальный идентификатор заказа клиента
clientId	uint - идентификатор клиента
agreementId	uint - идентификатор соглашения
guestId	string - идентификатор гостя
routeId	uint - идентификатор маршрута прайс-листа
brand	string - бренд товара
numberFix	string - "Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
itemId	uint - идентификатор партии на складе
quantity	float - количество
sellPrice	float - цена одной единицы товара в валюте магазина
clSellPrice	float - цена одной позиции в валюте договора с клиентом
createDate	datetime - дата и время добавления позиции в корзину
updateDate	datetime - дата и время изменения позиции в корзине
data[number]	string - номер по формату в ответе от поставщика (из результата поиска)
data[description]	string - описание из результатов поиска
data[wearout]	uint - износ б/у
data[distributorId]	uint - идентификатор прайс-листа
data[goodCode]	string - код товара
data[supplierCode]	string - код поставщика
data[packing]	uint - кратность (количество товара в упаковке)
data[availability]	int - наличие у поставщика
data[distCurrency]	string - валюта прайс-листа (ISO код)
data[distPrice]	float64 - цена из прайс-листа в валюте прайс-листа
data[distBuyPrice]	float64 - цена закупки в валюте прайс-листа
data[distSellPrice]	float64 - цена продажи в валюте прайс-листа
data[distToResRate]	float64 - курс конвертации из валюты прайс-листа в валюту магазина
data[buyPrice]	float64 - цена закупки в валюте магазина
data[clToResRate]	float64 - float, Курс между валютой магазина и валютой договора с клиентом
data[deadline]	uint - срок поступления на склад в часах
data[deadlineMax]	uint - срок поступления на склад максимальный в часах
data[itemKey]	string - строка с зашифрованными данными из результата поиска (dsItemKey)
data[onlineData]	json string - данные полученные из WH Online во время поиска товара, содержит поля
data[onlineData][meta]	ассоциативный массив - дополнительные параметры от online-поставщика
data[onlineData][params]	ассоциативный массив строк - параметры, с которыми позиция была получена из WH Online


Позиции заказов клиентов
Административные операции для работы с позициями заказов клиентов.
* - обязательный параметр
Получение одной позиции
Операция: GET /cp/ts/positions/get

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	идентификатор позиции заказа
additionalInfo	string, доп. информация позиции, значения через запятую
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/get?userlogin=username&userpsw=md5pass&positionId=11112
Метод возвращает объект позиции заказа.

Получение списка позиций
Операция: GET /cp/ts/positions/list

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
brand	string, бренд товара, полное совпадение
message	string, комментарий к позиции
agreementId	uint, идентификатор соглашения
clientId	uint, идентификатор клиента
managerId	uint, идентификатор менеджера
noManagerAssigned	флаг, добавляющий в выборку позиции без назначенного менеджера; используется с managerId
deliveryId	uint, идентификатор операции доставки
dateStart	string, минимальная дата создания позиций заказов
dateEnd	string, максимальная дата создания позиций заказов
updateDateStart	string, минимальная дата обновления заказов
updateDateEnd	string, максимальная дата обновления заказов
deadlineDateStart	string, минимальная дата ожидаемая дата поставки на склад
deadlineDateEnd	string, максимальная дата ожидаемая дата поставки на склад
orderPickingDateStart	string, минимальная дата связанной отгрузки
orderPickingDateEnd	string, максимальная дата связанной отгрузки
orderPickingGoodIds	[]uint, идентификаторы позиций отгрузки
customerComplaintPositionIds	[]uint, идентификаторы позиций возврата
productIds	[]uint, идентификаторы карточек товаров
soPositionIds	[]uint, идентификаторы позиций заказов поставщикам
routeIds	[]uint, идентификаторы маршрутов
distributorIds	[]uint, идентификаторы прайс-листов
ids	[]uint, идентификаторы позиций заказов клиентов
orderIds	[]uint, идентификаторы заказов клиентов
statuses	[]string, список статусов позиций заказов
tagIds	[]uint, id тегов через запятую
skip	uint, смещение (по умолчанию 0)
limit	uint, ограничение по кол-ву заказов в выдаче
additionalInfo	Дополнительная информация о позициях (можно через запятую указать несколько):
unpaidAmount - суммарная неоплаченная стоимость позиций;
delivery - информация о доставке;
product - информация о продукте.
clientNote - информация о заметках клиентов к позициям
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/list?userlogin=username&userpsw=md5pass&brand=Febi&dateStart=2022-05-29 14:20:00&productIds[]=142&productIds[]=143
Метод возвращает объект вида:

Поле	Описание
total	число найденных позиций
list	список найденных позиций
Создание позиции
Операция: POST /cp/ts/positions/create

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
orderId*	uint, идентификатор заказа клиента
clientId*	uint, идентификатор клиента
routeId*	uint, идентификатор маршрута прайс-листа
distributorId*	uint, идентификатор прайс-листа
itemKey*	string, код товара, полученный поиском search/articles
quantity*	float, количество
sellPrice*	float, цена продаже в валюте магазина
brand*	string, бренд
numberFix*	string, "Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
number*	string, номер по формату в ответе от поставщика (из результата поиска)
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/create
Параметры POST

userlogin=username&userpsw=md5pass&orderId=3342&clientId=1002&quantity=1&brand=Febi&itemKey=#$@#!$
Метод возвращает объект позиции

Создание нескольких позиций и добавление их в новый или существующий заказ
Операция: POST /cp/ts/positions/createMultiple

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	MD5-хэш пароля API-администратора
positions*	Список позиций. Параметры каждой позиции аналогичны параметрам операции создания позиции заказа.
newOrder*	[обязательный если не указан existOrderId] Данные нового заказа. Параметры аналогичны операции создания заказа.
existOrderId*	[обязательный если не указан newOrder] Идентификатор существующего заказа для добавления в него позиций.
fields	Расширенный формат вывода позиций заказа. Возможные значения.
orderFields	Расширенный формат вывода заказа. Возможные значения.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/createMultiple
Параметры POST

userlogin=username&userpsw=md5pass&newOrder[clientId]=123&newOrder[agreementId]=234&positions[0]routeId=111&positions[0]distributorId=222&....
Метод возвращает объект из двух полей: order - заказ, positions - позиции.

Обновление позиции
Операция: POST /cp/ts/positions/update

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	uint, идентификатор позиции заказа
routeId	uint, идентификатор маршрута прайс-листа
distributorId	uint, идентификатор прайс-листа
quantity	float, количество
sellPrice	float, цена продажи в валюте магазина
clToResRate	float, курс между валютой договора с клиентом и валютой магазина
clSellPrice	float, цена продаже в валюте договора с клиентом
priceDataSellPrice	float, стоимость товара при проценке
prepaymentAmount	float, сумма предоплаты, при 0 будет рассчитана автоматически
deadlineTime	string, срок поставки на склад в формате RFC3339
deadlineTimeMax	string, максимальный поставки на склад в формате RFC3339
clientRefusal	bool, признак желания клиента отказаться от покупки товара
deliveryId	uint, идентификатор операции доставки
status	string, статус позиции, Новый или Предоплата
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/update
Параметры POST

userlogin=username&userpsw=md5pass&orderId=3342&quantity=1&deadlineTime=2022-05-31 14:20:00
Метод возвращает объект позиции

Аннулирование позиции
Операция: POST /cp/ts/positions/cancel

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	uint, идентификатор позиции заказа
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/cancel
Параметры POST

userlogin=username&userpsw=md5pass&positionId=3569
Метод возвращает позицию.

Массовое аннулирование позиций
Операция: POST /cp/ts/positions/massCancel

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionIds*	string, идентификаторы позиций через запятую
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/massCancel
Параметры POST

userlogin=username&userpsw=md5pass&positionIds=252653,25265
Метод возвращает список позиций.

Массовая смена статуса позиций
Операция: POST /cp/ts/positions/changeStatus

Данным способом можно менять статусы только с "Новый" на "Предоплата" и наоборот.
Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionIds*	string, идентификатор позиций через запятую
status*	string, принимает значения: new, prepayment
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/changeStatus
Параметры POST

userlogin=username&userpsw=md5pass&positionIds=3569,3242&status=prepayment
Метод возвращает список позиций.

Разделение позиции
Операция: POST /cp/ts/positions/split

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	uint, числовой идентификатор позиции заказа клиента
quantity*	float, количество, которое требуется отделить
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/split
Параметры POST

userlogin=username&userpsw=md5pass&positionId=3242&quantity=1
Метод возвращает поля:

position	обновлённая позиция заказа клиента
createdPosition	созданная позиция заказа клиента
Объединение позиций
Операция: POST /cp/ts/positions/merge

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
mainPositionId*	uint, позиция, в которую будут объединены остальные позиции
mergePositionsIds*	позиции через запятую, которые будут объединены в главную позицию
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/merge
Параметры POST

userlogin=username&userpsw=md5pass&mainPositionId=3242&mergePositionsIds=3243
Метод возвращает объект обновлённой позиции заказа

Сообщения по позициям заказа
Получение списка сообщений
Операция: GET /cp/ts/positions/message/list

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	uint - числовой идентификатор позиции заказа клиента
skip	количество сообщений в ответе, которое нужно пропустить
limit	максимальное количество сообщений, которое должно быть возвращено в ответе
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/message/list?positionId=112233
Метод возвращает набор полей:

total	количество без учета параметров skip и limit
list	массив из json-объектов сообщений
Получение одного сообщения
Операция: GET /cp/ts/positions/message/get

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
messageId*	uint, числовой идентификатор сообщения
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/message/get?messageId=112233
Метод возвращает объект сообщения

Создание сообщения
Операция: POST /cp/ts/positions/message/create

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
positionId*	uint, идентификатор позиции
message*	string, текст сообщения
employeeId	uint, идентификатор сотрудника
date	datetime, дата и время
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/message/create
Параметры POST

userlogin=username&userpsw=md5pass&positionId=3242&date=2022-05-31 14:20:00&message=comment
Метод возвращает объект сообщения

Редактирование сообщения
Операция: POST /cp/ts/positions/message/update

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
messageId*	uint, идентификатор сообщения
message*	string, текст сообщения
employeeId	uint, идентификатор сотрудника
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/message/update
Параметры POST

userlogin=username&userpsw=md5pass&messageId=3242&message=comment
Метод возвращает объект сообщения

Удаление сообщения
Операция: POST /cp/ts/positions/message/delete

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
messageId*	uint, идентификатор сообщения
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/positions/message/delete
Параметры POST

userlogin=username&userpsw=md5pass&messageId=3242
Метод не возвращает данных


Набор полей сообщения позиции заказа

id	uint, уникальный идентификатор сообщения
positionId	uint, идентификатор позиции
employeeId	uint, идентификатор сотрудника
createDate	datetime, дата и время
message	string, текст сообщения
Объект позиции заказа
id	uint, идентификатор
orderId	uint, ID заказа
clientId	uint, ID контрагента
productId	uint, ID товара
status	string, Статус позиции
routeId	uint, ID маршрута
distributorId	uint, ID прайс-листа
itemId	uint, Идентификатор партии на складе
soPositionId	uint, Идентификатор позиции SO
deliveryId	uint, Идентификатор операции доставки
clientRefusal	Признак желания клиента отказаться от покупки товара
quantity	float, Количество
sellPrice	float, Цена одной единицы товара в валюте магазина
clSellPrice	float, Цена одной позиции в валюте договора с клиентом
prepaymentAmount	float, Сумма предоплаты в валюте договора с клиентом
createTime	datetime, Время создания
updateTime	datetime, Время изменения
deadlineTime	datetime, дата и время поставки товара на склад, вычисляется в момент создания createTime + deadline (часы)
deadlineTimeMax	datetime, дата и время поставки товара на склад, вычисляется в момент создания createTime + deadlineMax (часы)
data	доп. информация о товаре в корзине в формате JSON
data[clToResRate]	float, Курс между валютой магазина и валютой договора с клиентом
data[discountPercent]	float, Скидка (процент)
data[beforeCancel]	object, сохраненные значения колонок перед их очисткой во время аннулирования позиции
data[beforeCancel][itemId]	uint, Идентификатор партии на складе
data[beforeCancel][soPositionId]	uint, Идентификатор позиции SO
priceData	доп. информация о товаре из результатов поиска в формате JSON
priceData[brand]	string, Бренд (из корзины)
priceData[numberFix]	string, "Очищенный" артикул товара, содержащий только алфавитные и цифровые символы (из корзины)
priceData[number]	string, номер по формату в ответе от поставщика (из результата поиска)
priceData[description]	string, описание
priceData[wearout]	uint, износ б/у
priceData[goodCode]	string, Код товара
priceData[supplierCode]	string, Код поставщика
priceData[packing]	uint, Кратность
priceData[availability]	int, Доступно
priceData[distCurrency]	string, Валюта прайс-листа (ISO код)
priceData[distPrice]	float, Цена из прайс-листа в валюте прайс-листа
priceData[distBuyPrice]	float, Цена закупки в валюте прайс-листа
priceData[distSellPrice]	float, Цена продажи в валюте прайс-листа
priceData[distToResRate]	float, Курс конвертации из валюты прайс-листа в валюту магазина
priceData[buyPrice]	float, Цена закупки в валюте магазина
priceData[sellPrice]	float, Стоимость товара при проценке
priceData[deadline]	uint, Срок поступления на склад в часах (из корзины)
priceData[deadlineMax]	uint, Срок поступления на склад максимальный в часах (из корзины)
priceData[itemKey]	string, Зашифрованная информация из результата поиска
priceData[onlineData]	object, Доп. инфа из прайс-листа (обычно, онлайн)
priceData[onlineData][meta]	object, дополнительные параметры от online-поставщика
priceData[onlineData][params]	object, параметры, с которыми позиция была получена со склада
delivery	object, информация о доставке (*если использовался additionalInfo=delivery при получении позиции)
product	object, информация о продукте (*если использовался additionalInfo=product при получении позиции)
unpaidAmount	float, суммарная неоплаченная стоимость позиций (*если использовался additionalInfo=unpaidAmount при получении позиции)
Список возможных статусов позиции заказа
prepayment	требуется предоплата
canceled	аннулировано
new	новый
supOrder	заказ поставщику
supOrderCanceled	заказ поставщику, отказ
reservation	бронь
orderPicking	отгрузка
delivery	доставка
finished	завершен
Значения параметра additionalInfo
reserv	информация о резервировании товара из партии на складе
product	информация о товаре из справочника
orderPicking	информация об отгрузке и её позиции
customerComplaintPoses	информация о позициях возврата от клиента
supplierOrder	информация о заказе и позиции заказа поставщику
grPosition	информация о связанной с партией позицией приёмки
order	сокращенная информация о заказе клиента
delivery	информация об операции доставки
tags	теги
unpaidAmount	сумма, которую должен уплатить клиент в зависимости от статуса позиции и точки возникновения долга - либо предоплата, либо оставшаяся сумма заказа/отгрузки
clientNote	Заметка клиента для позиции заказа
Информация о доставке, позиции заказа клиента
id	uint, идентификатор
contractorId	uint, ID клиента
creatorId	uint, ID сотрудника-создателя операции
agreementId	uint, ID договора
methodId	uint, ID способа доставки
status	string, состояние
trackNumber	string, номер для отслеживания
createDate	datetime, дата создания
startTime	datetime, начало интервала доставки
endTime	datetime, конец интервала доставки
price	float, цена в валюте магазина
clToResRate	float, курс между валютой магазина и валютой договора
clPrice	float, цена в валюте договра с клиентом
volume	float, суммарный объем
data	object, дополнительные сведения в сериализованном виде
data[maxSize]	float, максимальный размер в мм
data[maxSizesSum]	float, максимальная сумма измерений товара в мм
data[weight]	float, суммарная масса
data[contractorInfo]	object - информация об адресате
data[contractorInfo][address]	string, Полный адрес
data[contractorInfo][comment]	string, дополнительная информация
data[contractorInfo][contact]	string, телефон для связи
data[contractorInfo][person]	string, контактное лицо
data[contractorInfo][employeePerson]	string, имя сотрудника
data[contractorInfo][employeeContact]	string, телефон сотрудника
data[contractorInfo][resellerComment]	string, комментарий о месте доставки от магазина
data[contractorInfo][officeId]	uint, офис самовывоза
Информация о продукте, позиции заказа клиента
id	uint, уникальный идентификатор товара в справочнике
brand	string, бренд товара
number	string, артикул товара
numberFix	string, "Очищенный" артикул товара, содержащий только алфавитные и цифровые символы
code	string, код товара в системе учета реселлера
customsCode	string, таможенный код товара
brandGroup	string, группа товара от производителя
unitId	uint, ссылка на единицу измерения
packing	uint, кратность
priceup	float, наценка на товар в процентах
description	локализованная строка - описание товара
extDescription	локализованная строка - расширенное описание товара
shelfLife	int, срок годности товара в днях
forSale	bool, в продаже (да/нет)
availabilityNorm	float, норма наличия
orderPoint	uint, процент нормы наличия (при котором нужно заказывать товар)
createdTime	datetime, время создания записи
updateTime	datetime, время обновления записи
attrs	json string, дополнительный набор атрибутов в json-формате
attrs[weight]	float, вес товара
attrs[volume]	float, объем товара
attrs[length]	uint, длина в мм
attrs[width]	uint, ширина в мм
attrs[height]	uint, высота в мм
attrs[excise]	string, акциз
attrs[isDelete]	bool, признак логического удаления
История добавления, изменения, удаления данных
Административная операция для для получения истории изменения данных в модуле складского учёта. Получить информацию можно только за последние 180 дней.
* - обязательный параметр
Получение списка действий
Операция: GET /cp/ts/logs/read

Параметры запроса

Параметр	Описание
userlogin*	Имя API-администратора
userpsw*	md5-хэш пароля API-администратора
dateStart*	Дата начала диапазона поиска в формате RFC3339
dateEnd*	Дата конца диапазона поиска в формате RFC3339
type*	тип требуемых записей. Возможные значения:
all - записи всех типов. Дополнительные фильтры не применяются.

clientOrder - заказы клиентов

clientOrderPosition - позиции заказов клиентов

orderPicking - операции отгрузки

orderPickingPosition - позиции отгрузки

customerComplaintPosition - позиции возвратов от покупателей

delivery - доставки

package - упаковки

goodsReceipt - операции приёмки

goodsReceiptPosition - позиции приёмки

payment - платежи

productHandling - операции перемещения

productHandlingPosition - позиции перемещения

supplierOrder - заказы поставщикам

supplierOrderPosition - позиции заказов поставщикам

supplierReturnPosition - позиции возвратов поставщикам

limit*	Требуемое количество записей. Максимальное значение - 1000.
offset	Количество записей, которые нужно пропустить
employeeIds	идентификаторы сотрудников, осуществивших действие
ips	ip-адреса пользователей, осуществивших действие
locations	Места внесения изменений. Возможные значения:
service - автоматическое изменение данных

public-api - запрос был выполнен

cp - панель управления

site - сайт

Дополнительные фильтры заказов клиентов

Параметр	Описание
orderIds	Идентификаторы заказов
clientIds	Идентификаторы клиента
agreementIds	Идентификаторы договора
events	Типы событий. Возможные значения:
create - создание

update - обновление

split - разделение заказа

merge - объединение заказов

reprice - изменение цены

Дополнительные фильтры позиций заказов клиентов

Параметр	Описание
positionIds	Идентификаторы позиций
orderIds	Идентификаторы заказов
clientIds	Идентификаторы клиентов
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

split - разделение

reservationCreate - создание бронирования

reservationDelete - уделение бронирования

orderPickingPosCreate - создание позиции отгрузки

supplierOrderPosCreate - создание позиции заказа поставщику

prepaymentTake - изменение статуса с предоплата на новый

prepaymentReturn - изменение статуса с новый на предоплата

clientRefusalSet - отказ

clientRefusalRemove - отмена отказа

Дополнительные фильтры операций отгрузки

Параметр	Описание
orderPickingGoodIds	Идентификаторы операций отгрузки
clientIds	Идентификаторы клиентов
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

Дополнительные фильтры позиций отгрузки

Параметр	Описание
positionIds	Идентификаторы позиций
orderPickingGoodIds	Идентификаторы операций отгрузки
events	Типы событий. Возможные значения:
create - создание

update - изменение

split - разделение

delete - удаление

Дополнительные фильтры позиций возвратов от покупателей

Параметр	Описание
positionIds	Идентификаторы позиций
customerComplaintIds	Идентификаторы операций возвратов
clientIds	Идентификаторы клиентов
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

delete - удаление

Дополнительные фильтры операций доставки

Параметр	Описание
deliveryIds	Идентификаторы операций доставки
clientIds	Идентификаторы клиентов
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

coPositionAdd - добавление позиции заказа

coPositionRemove - удаление позиции заказа

Дополнительные фильтры упаковки

Параметр	Описание
packageIds	Идентификаторы упаковок
deliveryIds	Идентификаторы операций доставки
events	Типы событий. Возможные значения:
create - создание

update - изменение

delete - удаление

Дополнительные фильтры операций приёмки

Параметр	Описание
goodsReceiptIds	Идентификаторы операций приёмки
supplierIds	Идентификаторы поставщиков
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

delete - удаление

Дополнительные фильтры позиций приёмки

Параметр	Описание
positionIds	Идентификаторы позиций
goodsReceiptIds	Идентификаторы операций приёмки
events	Типы событий. Возможные значения:
create - создание

update - изменение

delete - удаление

Дополнительные фильтры платежей

Параметр	Описание
paymentIds	Идентификаторы платежей
contractorIds	Идентификаторы контрагентов
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

Дополнительные фильтры операций перемещения

Параметр	Описание
productHandlingIds	Идентификаторы операций перемещения
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

delete - удаление

Дополнительные фильтры позиций перемещения

Параметр	Описание
positionIds	Идентификаторы позиций
productHandlingIds	Идентификаторы операций перемещения
events	Типы событий. Возможные значения:
create - создание

update - изменение

delete - удаление

Дополнительные фильтры заказов поставщикам

Параметр	Описание
orderIds	Идентификаторы заказов поставщикам
supplierIds	Идентификаторы поставщиков
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

send - отправка

delete - удаление

Дополнительные фильтры позиций заказов поставщикам

Параметр	Описание
positionIds	Идентификаторы позиций
orderIds	Идентификаторы заказов поставщикам
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

split - разделение

syncEnable - включение синхронизации

syncDisable - отключение синхронизации

delete - удаление

Дополнительные фильтры позиций возвратов поставщикам

Параметр	Описание
positionIds	Идентификаторы позиций
supplierReturnIds	Идентификаторы операций возвратов поставщикам
supplierIds	Идентификаторы поставщиков
agreementIds	Идентификаторы договоров
events	Типы событий. Возможные значения:
create - создание

update - изменение

statusChange - изменение статуса

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/logs/read
Параметры get
userlogin=username&userpsw=md5pass&dateStart=2022-05-01T00:00:00&dateEnd=2022-05-25T23:59:59&type=clientOrder&orderIds[]=123&orderIds[]=124&events[]=create&events[]=update&events[]=merge&limit=100
Метод возвращает объекты записей истории действий

Операции приемки
fields приёмки
Во все операции, возвращающие объект приёмки, можно передать дополнительный параметр fields, по которому объект приёмки будет дополнен соответствующей информацией. Несколько параметров необходимо указывать через запятую.

Значение	Описание
agreement	информация о договоре с поставщиком
tags	теги
posInfo	суммарная информация о позициях


Операция создания приёмки
Операция: /cp/ts/goodReceipts/create

Метод: POST

Создаёт приёмку с позициями. Дата создания устанавливается текущая.

Место хранения указывается в панели управления в разделе Настройки склада -> общие.

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
positions	список позиций
supplierId	Идентификатор контрагента, имеющего активный договор типа "поставка на склад"
agreementId	[необязательный] Идентификатор активного договора поставки. Если не передан, то будет задан договор с признаком "по умолчанию"
supNumber	[необязательный] номер отгрузки поставщика
supShipmentDate	[необязательный] дата и время отгрузки поставщика в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС
createDate	[необязательный] дата и время создания отгрузки в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС (rfc3339), если не указано - используется текущая дата и время
Узел positions содержит набор объектов вида:

Поле	Описание
brand	Название производителя (бренд - необзятально, если передан productId)
number	Номер детали (код производителя - необзятально, если передан productId)
productId	ID товара в своем справочнике, необязательно, если переданы brand и number
quantity	Количество
supBuyPrice	Цена позиции в валюте поставщика
manufacturerCountry	[необязательный] Страна производитель - три английские буквы: RUS - Россия, CNH - Китай, DEU - Германия и т.д. ИЛИ цифровой код страны (643 - Россия, 156 - Китай, 276 - Германия)
gtd	[необязательный] Номер ГТД
warrantyPeriod	[необязательный] Срок гарантийного обслуживания с момента продажи в днях
returnPeriod	[необязательный] Срок гарантированного возврата в днях
barcodes	[необязательный] Штрихкоды разделённые пробелами
comment	[необязательный] Комментарий
descr	[необязательный] Описание будущей партии
expectedQuantity	[необязательный] Ожидаемое кол-во товара
soPositionId	[необязательный] Идентификатор позиции заказа поставщику, на основании которой была создана позиция приемки
oldOrderPositionId	[необязательный] Идентификатор позиции старого заказа, на основании которой была создана позиция приемки. Используется при печати стикера приёмки для заполнения информации о заказе клиента.
wearout	[необязательный] Показатель состояния износа товара (б/у) 0 - новый товар, 10 - отличное, 30 - хорошее, 50 - удовлетворительное, 70 - под восстановление, 90 - ремонтный набор.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/create
Параметры POST
userlogin=username&userpsw=md5pass&positions[0][brand]=febi&positions[0][number]=01089&positions[0][quantity]=3&positions[0][supBuyPrice]=100&positions[0][manufacturerCountry]=rus&positions[0][gtd]=123123&positions[0][warrantyPeriod]=30&positions[0][returnPeriod]=14&positions[0][barcodes]=4027816010666%202053000000666&position[0][expectedQuantity]=7.4&position[0][soPositionId]=123456&position[0][oldOrderPositionId]=3832215&positions[1][brand]=PATRON&positions[1][number]=pse40273&positions[1][quantity]=2&positions[1][supBuyPrice]=75&positions[1][manufacturerCountry]=chn&positions[1][gtd]=3432142154&positions[1][warrantyPeriod]=44&positions[1][returnPeriod]=33&positions[1][barcodes]=46000550077%2046000550088&position[1][expectedQuantity]=7.5&position[1][soPositionId]=123457&position[1][oldOrderPositionId]=3832216
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор созданной приёмки


Получение списка операций приёмка
Операция: /cp/ts/goodReceipts/get

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
auto	[необязательный] автоопределяемое поле (поиск по частичному номеру операции или идентификатору, если задано число)
creatorId	[необязательный] идентификатор сотрудника-создателя
workerId	[необязательный] идентификатор сотрудника-исполнителя
agreementId	[необязательный] идентификатор договора
statuses	[необязательный] статусы через запятую (1 - новая, 2 - в работе, 3 - завершена)
number	[необязательный] номер операций
ids	[необязательный] идентификаторы операций через запятую
isDelete	[необязательный] при значении равном 1, будут отобраны только удаленные приемки
dateStart	[необязательный] начальная дата диапазона поиска по времени создания в формате rfc3339
dateEnd	[необязательный] конечная дата диапазона поиска по времени создания в формате rfc3339
updateDateStart	[необязательный] начальная дата диапазона поиска по времени обновления в формате rfc3339
updateDateEnd	[необязательный] конечная дата диапазона поиска по времени обновления в формате rfc3339
supShipmentDateStart	[необязательный] начальная дата диапазона поиска отгрузки поставщика в формате rfc3339
supShipmentDateEnd	[необязательный] конечная дата диапазона поиска отгрузки поставщика в формате rfc3339
supNumber	[необязательный] номер отгрузки поставщика
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/get?userlogin=username&userpsw=md5pass&limit=30&statuses=3
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор операции приёмки
number	Номер операции
createDate	Дата создания операции
status	Статус
creatorId	Идентификатор сотрудника-создателя
workerId	Идентификатор сотрудника-исполнителя
isDelete	Признак удаления
supplierId	Идентификатор поставщика
agreementId	Идентификатор соглашения
supNumber	Номер отгрузки поставщика
supShipmentDate	Дата отгрузки поставщика
buyAmount	Сумма приёмки в валюте магазина
supBuyAmount	Сумма приёмки в валюте договора
positionsCount	Количество позиций в операции
sumQuantity	Количество товаров в операции
agreement	Договор
supplier	Поставщик


Получение списка позиций приёмки
Операция: /cp/ts/goodReceipts/getPositions

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
opId	[обязательный, если не заполнен opIds] идентификатор операции
opIds	[обязательный, если не заполнен opId] идентификаторы операции через запятую
limit	[необязательный] максимальное количество операций, которое должно быть возвращено в ответе. Максимально возможное значение 1000. Если не указан будет установлено максимально возможное значение.
skip	[необязательный] количество операций в ответе, которое нужно пропустить
productId	[необязательный] идентификатор товара справочника
updateDateStart	[необязательный] начальная дата диапазона поиска по времени обновления в формате rfc3339
updateDateEnd	[необязательный] конечная дата диапазона поиска по времени обновления в формате rfc3339
auto	[необязательный] автоопределяемое поле
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/getPositions?userlogin=username&userpsw=md5pass&limit=30&opId=3
Метод возвращает массив объектов вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции приёмки
productId	Идентификатора товара в справочнике
quantity	Количество
supBuyPrice	Цена закупки в валюте договора
supToResRate	Курс валюты магазина к валюте договора
buyPrice	Цена закупки в валюте магазина
sellPrice	Цена продажи
manufacturerCountry	Страна производитель товара
warrantyPeriod	Гарантийный период в днях
returnPeriod	Срок возврата
attrs	Дополнительные параметры(штрихкоды, комментарий, описание партии)
data	Дополнительные данные о связях позиции приёмки с заказами покупателя и поставщику
locId	Идентификатор места хранения
product	Карточка товара


Операция изменения приёмки
Операция: /cp/ts/goodReceipts/update

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор операции приёмки
supNumber	[необязательный] номер отгрузки поставщика
supShipmentDate	[необязательный] дата и время отгрузки поставщика в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/update
Параметры POST

userlogin=username&userpsw=md5pass&id=12&supNumber=5555&supShipmentDate=2021-05-27 10:27:30
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор операции приёмки
number	Номер операции
createDate	Дата создания операции
status	Статус
creatorId	Идентификатор сотрудника-создателя
workerId	Идентификатор сотрудника-исполнителя
isDelete	Признак удаления
supplierId	Идентификатор поставщика
agreementId	Идентификатор соглашения
supNumber	Номер отгрузки поставщика
supShipmentDate	Дата отгрузки поставщика
buyAmount	Сумма приёмки в валюте магазина
supBuyAmount	Сумма приёмки в валюте договора
positionsCount	Количество позиций в операции
sumQuantity	Количество товаров в операции
agreement	Договор
supplier	Поставщик


Операция изменения статуса приёмки
Операция: /cp/ts/goodReceipts/changeStatus

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор операции приёмки
status	id нового статуса приёмки
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/changeStatus
Параметры POST

userlogin=username&userpsw=md5pass&id=1&status=2
Метод возвращает объект вида:

Поле	Описание
createItems	Значение будет null
При этом, если для параметра status передано значение 3 (приемка завершена), то метод вернет список id позиций приемки в формате - id позиции приемки : id партии

Операция удаления приёмки
Операция: /cp/ts/goodReceipts/delete

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор операции приёмки
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/delete
Параметры POST

userlogin=username&userpsw=md5pass&id=1


Операции позиций приемки
fields позиции приёмки
Во все операции, возвращающие объект позиции приёмки, можно передать дополнительный параметр fields, по которому объект позиции приёмки будет дополнен соответствующей информацией. Несколько параметров необходимо указывать через запятую.

Значение	Описание
product	информация о товаре
location	информация о месте хранения
item	информация о партии
tags	теги
operationInfo	краткая информация об операции приёмки


Операция создания позиции приёмки
Операция: /cp/ts/goodReceipts/createPosition

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
opId	идентификатор приёмки
locId	идентификатор места хранения
productId	идентификатор товара в справочнике
brand	Название производителя.
number	Номер детали (код производителя)
quantity	Количество
supBuyPrice	Цена позиции в валюте поставщика
manufacturerCountry	[необязательный] Страна производитель - три английские буквы: RUS - Россия, CNH - Китай, DEU - Германия и т.д. ИЛИ цифровой код страны (643 - Россия, 156 - Китай, 276 - Германия)
gtd	[необязательный] Номер ГТД
warrantyPeriod	[необязательный] Срок гарантийного обслуживания с момента продажи в днях
returnPeriod	[необязательный] Срок гарантированного возврата в днях
barcodes	[необязательный] Штрихкоды разделённые пробелами
comment	[необязательный] Комментарий
descr	[необязательный] Описание будущей партии
soPositionId	[необязательный] Идентификатор позиции заказа поставщику, на основании которой была создана позиция приемки
soQuantity	[необязательный] Ожидаемое кол-во товара
oldOrderPositionId	[необязательный] Идентификатор позиции старого заказа, на основании которой была создана позиция приемки. Используется при печати стикера приёмки для заполнения информации о заказе клиента.
wearout	[необязательный] Показатель состояния износа товара (б/у) 0 - новый товар, 10 - отличное, 30 - хорошее, 50 - удовлетворительное, 70 - под восстановление, 90 - ремонтный набор.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/createPosition
Параметры POST

userlogin=username&userpsw=md5pass&brand=febi&number=01089&quantity=3&supBuyPrice=100&manufacturerCountry=rus&gtd=123123&warrantyPeriod=30&returnPeriod=14&barcodes=4027816010666%202053000000666&expectedQuantity=7.4&soPositionId=123456&oldOrderPositionId=3832215
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор созданной позиции приёмки


Операция удаления позиции приёмки
Операция: /cp/ts/goodReceipts/deletePosition

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор позиции приёмки
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/deletePosition
Параметры POST

userlogin=username&userpsw=md5pass&id=1


Операция получения позиции приёмки
Операция: /cp/ts/goodReceipts/getPosition

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор позиции приёмки
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/getPosition
Параметры GET
userlogin=username&userpsw=md5pass&id=1
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции приёмки
productId	Идентификатора товара в справочнике
quantity	Количество
supBuyPrice	Цена закупки в валюте договора
supToResRate	Курс валюты магазина к валюте договора
buyPrice	Цена закупки в валюте магазина
sellPrice	Цена продажи
manufacturerCountry	Страна производитель товара
warrantyPeriod	Гарантийный период в днях
returnPeriod	Срок возврата
attrs	Дополнительные параметры(штрихкоды, комментарий, описание партии)
data	Дополнительные данные о связях позиции приёмки с заказами покупателя и поставщику, ожидаемом количестве и износе(б/у).
locId	Идентификатор места хранения
product	Карточка товара


Операция изменения позиции приёмки
Операция: /cp/ts/goodReceipts/updatePosition

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор позиции приёмки
brand	Название производителя.
number	Номер детали (код производителя)
quantity	Количество
supBuyPrice	Цена позиции в валюте поставщика
manufacturerCountry	[необязательный] Страна производитель - три английские буквы: RUS - Россия, CNH - Китай, DEU - Германия и т.д. ИЛИ цифровой код страны (643 - Россия, 156 - Китай, 276 - Германия)
gtd	[необязательный] Номер ГТД
warrantyPeriod	[необязательный] Срок гарантийного обслуживания с момента продажи в днях
returnPeriod	[необязательный] Срок гарантированного возврата в днях
barcodes	[необязательный] Штрихкоды разделённые пробелами
comment	[необязательный] Комментарий
descr	[необязательный] Описание будущей партии
expectedQuantity	[необязательный] Ожидаемое кол-во товара
soPositionId	[необязательный] Идентификатор позиции заказа поставщику, на основании которой была создана позиция приемки
oldOrderPositionId	[необязательный] Идентификатор позиции старого заказа, на основании которой была создана позиция приемки
wearout	[необязательный] Показатель состояния износа товара (б/у) 0 - новый товар, 10 - отличное, 30 - хорошее, 50 - удовлетворительное, 70 - под восстановление, 90 - ремонтный набор.
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/updatePosition
Параметры POST

userlogin=username&userpsw=md5pass&brand=febi&number=01089&quantity=3&supBuyPrice=100&manufacturerCountry=rus&gtd=123123&warrantyPeriod=30&returnPeriod=14&barcodes=4027816010666%202053000000666&expectedQuantity=7.4&soPositionId=123456&oldOrderPositionId=3832215
Метод возвращает объект вида:

Поле	Описание
id	Идентификатор позиции
opId	Идентификатор операции приёмки
productId	Идентификатора товара в справочнике
quantity	Количество
supBuyPrice	Цена закупки в валюте договора
supToResRate	Курс валюты магазина к валюте договора
buyPrice	Цена закупки в валюте магазина
sellPrice	Цена продажи
manufacturerCountry	Страна производитель товара
warrantyPeriod	Гарантийный период в днях
returnPeriod	Срок возврата
attrs	Дополнительные параметры(штрихкоды, комментарий, описание партии)
data	Дополнительные данные о связях позиции приёмки с заказами покупателя и поставщику
locId	Идентификатор места хранения
product	Карточка товара


Добавление изображения к позиции с износом (б/у)
Операция: /cp/ts/goodReceipts/createPositionBuImage

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор позиции приёмки
buImage	массив данных вида
   [
       "creatorId": 123,
       "files": [
           "содержимое файла1 в кодировке Base64",
           "содержимое файла2 в кодировке Base64"
       ]
   ]
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/createPositionBuImage
Параметры POST

userlogin=username&userpsw=md5pass&id=123&buImage[files][]=base64file1&buImage[files][]=base64file2
Метод возвращает массив объектов вида:

Поле	Описание
publicName	url загруженного изображения
publicPreviewName	url предпросмотра загруженного изображения
imageAPIName	имя файла
creatorId	ид сотрудника
uploadDate	дата загрузки


Удаление изображения позиции с износом (б/у)
Операция: /cp/ts/goodReceipts/deletePositionBuImage

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
id	Идентификатор позиции приёмки
name	имя ранее загруженного файла
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/goodReceipts/deletePositionBuImage
Параметры POST

userlogin=username&userpsw=md5pass&id=123&name=fileName.png
Метод ничего не возвращает

Теги
Операция получения списка тегов
Операция: /cp/ts/tags/list

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
ids	Идентификаторы тегов через запятую
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/tags/list?userlogin=api@user.abcp.ru&userpsw=123&ids=1,2,3
Метод возвращает объект вида:

Поле	Описание
total	Найдено записей
list	Массив тегов
Структура тега:

Поле	Описание
id	Идентификатор тега
name	Массив тегов
color	Цвет тега
fontColor	Цвет шрифта
goodsReceiptCount	Используется в приёмках
orderPickingCount	Используется в отгрузках
deliveryCount	Используется в доставках
deliveryPackageCount	Используется в упаковках
customerComplaintCount	Используется в возвратах
supplierReturnCount	Используется в возвратах поставщику
clientOrderCount	Используется в заказах
clientCount	Используется в клиентах
goodsReceiptPosCount	Используется в позициях приёмок
orderPickingPosCount	Используется в позициях отгрузок
customerComplaintPosCount	Используется в позициях возвратов
supplierReturnPosCount	Используется в позициях возвратов поставщику
clientOrderPosCount	Используется в позициях заказов
maxUsageCount	Максимум использований
Операция создания тега
Операция: /cp/ts/tags/create

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Параметры POST

Поле	Описание
name	Имя тега
color	Цвет тега
В ответе приходит массив с полями:

Поле	Описание
id	Идентификатор созданного тега


Операция удаления тега
Операция: /cp/ts/tags/delete

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Параметры POST

Поле	Описание
id	Идентификатор удаляемого тега
Ответ возвращает пустой массив

Связи тегов
Под "объектом" понимается тот объект, к которому осуществляется привязка тега.

Типы объектов перечислены в таблице.

Например, если objectId = 123, а objectType = 4, то объект - Клиент с id 123.

Операция получения списка связей тегов
Операция: /cp/ts/tagsRelationships/list

Метод: GET

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
objectIds	Необязателен. Идентификаторы объектов через запятую
objectType	Необязателен. Тип объекта
groupByObjectId	Необязателен. Группировать теги по id объекта
withAllTags	Необязателен. оставит только объекты, на которых есть все теги из tagIds
tagIds	Необязателен. Идентификаторы тегов через запятую
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/tagsRelationships/list?userlogin=api@user.abcp.ru&userpsw=123&limit=20&objectIds=1,2,3&objectType=1&groupByObjectId=0&withAllTags=0&tagIds=24,25
Метод возвращает объект вида:

Поле	Описание
total	Найдено записей
list	Массив связей тегов
Структура связей тегов:

Поле	Описание
tagId	Идентификатор тега
objectId	Идентификатор объекта
objectType	Тип объекта


Операция создания связи тега
Операция: /cp/ts/tagsRelationships/create

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Параметры POST

Поле	Описание
tagId	Идентификатор тега
objectId	Идентификатор объекта
objectType	Тип объекта
В ответе приходит массив с полями:

Поле	Описание
tagId	Идентификатор тега
objectId	Идентификатор объекта
objectType	Тип объекта


Операция удаления тега
Операция: /cp/ts/tagsRelationships/delete

Метод: POST

Параметры запроса

Параметр	Описание
userlogin	Имя API-администратора
userpsw	md5-хэш пароля API-администратора
Параметры POST

Поле	Описание
tagId	Идентификатор тега
objectId	Идентификатор объекта
objectType	Тип объекта
Ответ возвращает пустой массив

Типы объектов тегов
код	объект
1	операция приемка
2	операция отгрузка
3	операция возврат от клиента
4	клиент
5	позиция приемки
6	позиция отгрузки
7	позиция возврата от клиента
8	операция возврата поставщику
9	позиция возврата поставщику
10	операция заказа клиента
11	позиция заказа клиента
12	операция доставки
13	место доставки


Платежи
Административные операции для работы с платежами.
* - обязательный параметр
Получение списка платежей
Операция: GET /cp/ts/payments/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
contractorId	uint	Идентификатор клиента
agreementId	uint	Идентификатор договора
amountStart	float	Минимальная сумма
amountEnd	float	Максимальная сумма
status[]	string[]	Список статусов
number	string	Номер платежа
requisiteId	uint	Идентификатор платежных реквизитов
skip	uint	Пропуск записей
limit	uint	Ограничение количества записей в выборке
paymentType	string	Типы оплаты платежа (строковые значения через запятую)
paymentMethodIds[]	uint[]	Список идентификаторов способов оплаты платежа
dateStart	string	Минимальная дата платежа в формате RFC3339
dateEnd	string	Максимальная дата платежа в формате RFC3339
updateDateStart	string	начальная дата диапазона поиска по времени обновления в формате rfc3339
updateDateEnd	string	конечная дата диапазона поиска по времени обновления в формате rfc3339
fields	string	Дополнительная информация (значения через запятую)
Параметр status

Параметр status

Значение	Описание
new	Новый
inProcess	В процессе
accepted	Подтвержден
rejected	Отклонен
canceled	Аннулирован
Параметр paymentType

Значение	Описание	Применение
customerPayment	Выручка от покупателя	Для поступлений (положительные суммы)
supplierReturn	Возврат средств от поставщика	Для поступлений (положительные суммы)
supplierPayment	Оплата поставщику	Для списаний (отрицательные суммы)
customerReturn	Возврат средств покупателю	Для списаний (отрицательные суммы)
Параметр paymentMethodIds
Для получения списка идентификаторов способов оплаты воспользуйтесь операцией получения списка способов оплаты.

Параметр fields
Во все методы для работы с платежами, которые возвращают модель операции, в запрос можно передать поле fields, которое подгрузит дополнительные данные. Поля перечислять через запятую.

Значение	Описание
agreement	Информация о соглашении
maxAvailableReturnPaymentSum	Максимально возможная сумма возврата
paymentMethod	Способ оплаты
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/payments/list?userlogin=username&userpsw=md5pass
Операция возвращает поля

Поле	Описание
list	Список объектов платежей.
totalCount	Общее кол-во платежей соответствующих фильтру


Создание платежа
Операция: POST /cp/ts/payments/create

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
paymentType*	string	Тип платежа
paymentMethodId*	uint	Идентификатор способа платежа
agreementId*	uint	Идентификатор договора
authorId*	uint	Идентификатор инициатора платежа (сотрудник)
amount*	float	Сумма платежа (в валюте магазина)
date*	string	Пользовательская дата платежа в формате rfc3339
status	string	Нужно передать - accepted, чтобы платеж был сразу завершен
paymentOrder	string	Номер платежного поручения
linkedPaymentId	uint	Номер связанного платежа на основе которого делается возврат. Обязательный параметр, если paymentType = supplierReturn или customerReturn
contractorId	uint	Идентификатор клиента
commission	float	Комиссия платежной системы (в валюте магазина)
comment	string	Комментарий заполняемый магазином, при создании платежа
fields	string	Дополнительная информация (значения через запятую)
Параметр paymentType
Описание параметра.

Параметр paymentMethodId
Для получения списка идентификаторов способов оплаты воспользуйтесь операцией получения списка способов оплаты.

Параметр fields
Описание параметра.

Пример запроса

https://demo.public.api.abcp.ru/cp/ts/payments/create
Параметры POST

userlogin=username&userpsw=md5pass&paymentType=customerPayment&paymentMethodId=1&contractorId=1&agreementId=123&authorId=1&amount=123&date=1669972252
Метод возвращает объект платежа.

Обновление платежа
Операция: POST /cp/ts/payments/update

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
paymentId*	float	Номер платежа
agreementId	uint	Идентификатор договора. Можно изменить, если платеж в статусе new
amount	float	Сумма платежа (в валюте магазина). Можно изменить, если платеж в статусе new
date	string	Пользовательская дата платежа в формате rfc3339. Нельзя изменить, если платеж в статусе rejected или canceled
status	string	Статус платежа. Доступные изменения из new в inProcess ,accepted и canceled, из inProcess в accepted и canceled, из accepted в canceled
paymentOrder	string	Номер платежного поручения. Нельзя изменить, если платеж в статусе rejected или canceled
commission	float	Комиссия платежной системы (в валюте магазина). Нельзя изменить, если платеж в статусе rejected или canceled
comment	string	Комментарий заполняемый магазином, при создании платежа. Нельзя изменить, если платеж в статусе rejected или canceled
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/payments/update
Параметры POST

userlogin=username&userpsw=md5pass&paymentId=100&amount=1000&status=accepted
Метод возвращает объект платежа.

Объект платежа
Параметр	Тип	Описание
id	uint	Идентификатор
number	string	Номер платежа сгенерированный по шаблону
date	string	Пользовательская дата платежа
amount	float	Сумма платежа (в валюте магазина)
paymentMethodId	uint	Идентификатор способа оплаты
status	string	Статус платежа
type	string	Тип платежа
paymentOrder	string	Номер платежного поручения
commission	float	Комиссия платежной системы (в валюте магазина)
contractorId	uint	Идентификатор контрагента
agreementId	uint	Идентификатор договора
shopRequisiteId	uint	Идентификатор платежных реквизитов магазина
contractorRequisiteId	uint	Идентификатор платежных реквизитов получателя
createdTime	datetime	Дата создания платежа
updateTime	datetime	Дата обновления платежа
authorId	uint	Идентификатор инициатора платежа (сотрудник)
linkedPaymentId	uint	Идентификатор связанного платежа
data	json	Дополнительная информация
comment	string	Комментарий к платежу
Способы оплаты
Административные операции для работы со способами оплаты.
* - обязательный параметр
Получение списка способов оплаты
Операция: GET /cp/ts/paymentMethods/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя API-администратора
userpsw*	string	md5-хэш пароля API-администратора
paymentType	string	Тип оплаты
allowChangePayment	string	Вариант доступности изменения платежа
states	string	Состояние
Параметр paymentType

Значение	Описание
cash	Наличный расчет
terminal	Оплата через терминал
cashless	Безналичный расчет
sber	Сбербанк Онлайн
tinkoff	Тинькофф
yooKassa	YooKassa
Параметр allowChangePayment

Значение	Описание
yes	Можно изменять платежи в ПУ (используется по умолчанию)
paymentInterfaceOnly	Только в интерфейсе платежа
editOnly	Только редактирование
no	Нельзя изменять платежи в ПУ
Параметр states

Значение	Описание
available	Доступен (используется по умолчанию)
notForClient	Не для клиентов
notForManager	Не для менеджера
unableToFinish	Невозможно завершить
Метод возвращает список объектов способов оплаты.

Объект способа оплаты
Параметр	Тип	Описание
id	uint	Идентификатор
name	string	Название
paymentType	string	Тип оплаты
requisiteID	uint	Идентификатор реквизитов в Contractor Legal API
state	string	Состояние
numberTemplate	string	Шаблон с плейсхолдером {id}
allowChangePayment	string	Доступно ли изменение платежей в ПУ
profilesData	uint[]	Список профилей для которых доступно в json
Договоры
Административные операции для работы с договорами.
* - обязательный параметр
Получение списка договоров
Операция: GET /cp/ts/agreements/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя api-администратора
userpsw*	string	md5-хэш пароля api-администратора
ids	[]uint	Список идентификаторов договоров
contractorIds	[]uint	Список идентификаторов контрагента
contractorRequisiteIds	[]uint	Список идентификаторов платёжных реквизитов контрагента
shopRequisiteIds	[]uint	Список идентификаторов платёжных реквизитов магазина
isActive	bool	Признак активности
isDefault	bool	Признак договора по умолчанию
agreementType	uint8	Тип договора
relationType	uint8	Тип отношений
number	string	Частичный номер
taxNumber	string	Идентификационный номер налогоплательщика (ИНН для РФ)
currency	string	Валюта
dateStart	string	Минимальная дата создания в формате RFC3339
dateEnd	string	Максимальная дата создания в формате RFC3339
creditLimit	float64	Лимит кредита
limit	uint	Максимальное количество объектов в выдаче
offset	uint	Пропуск объектов в выдаче
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/agreements/list?userlogin=username&userpsw=md5pass
Метод возвращает объект вида:

Поле	Описание
total	число найденных договоров
list	список найденных договоров
Объект договора
Параметр	Тип	Описание
id	uint	Идентификатор
createDate	datetime	Дата создания
number	string	Номер
name	string	Название договора
currency	string	Валюта
contractorId	uint	Идентификатор контрагента
shopLegalPersonId	uint|null	Идентификатор ЮЛ магазина
contractorLegalPersonId	uint|null	Идентификатор ЮЛ контрагента
shopRequisiteId	uint|null	Идентификатор реквизитов магазина
contractorRequisiteId	uint|null	Идентификатор реквизитов контрагента
balance	float64	Баланс
agreementType	uint8	Тип договора (оферта или обычный)
relationType	uint8	Тип отношений (покупка или продажа)
isActive	bool	Признак активности
isDelete	bool	Признак логического удаления
isDefault	bool	Признак договора по умолчанию
creditLimit	float64	Лимит кредита
repaymentPeriod	uint8	Отсрочка платежа
isPaymentLate	bool	Стоп-лист/запрет отгрузки/платеж просрочен
latePaymentDate	datetime|null	Дата и время начала отсрочки платежей
Юридические лица
Административные операции для работы с юридическими лицами.
* - обязательный параметр
Получение списка юридических лиц
Операция: GET /cp/ts/legalPersons/list

Параметры запроса

Параметр	Тип	Описание
userlogin*	string	Имя api-администратора
userpsw*	string	md5-хэш пароля api-администратора
ids	string	Идентификаторы ЮЛ через запятую и без пробелов
contractorId	uint	Идентификатор контрагента
contractorIds	string	Идентификаторы контрагента через запятую
form	uint	Организационно-правовая форма
type	uint	Тип организационно-правовой формы
agreementWithIndividualsRequired	uint8	Признак обязательности договора м/у ЮЛ и физ. лицами
withTaxSystems	uint8	Добавить в ответ СНО
limit	uint	Максимальное количество объектов в выдаче, но не более 50-ти
skip	uint	Пропуск объектов в выдаче
Пример запроса

https://demo.public.api.abcp.ru/cp/ts/legalPersons/list?userlogin=username&userpsw=md5pass
Метод возвращает набор объектов юридических лиц.

vertical-align:middle;
Внимание!
Если в запросе не передан contractorId в ответе будут список всех юридических лиц магазина
Объект юридического лица
Параметр	Тип	Описание
id	uint	Идентификатор ЮЛ
contractorId	uint	Идентификатор контрагента
vatPercent	float64	НДС в процентах
form	uint	Организационно-правовая форма
type	string	Тип организационно-правовой формы
name	string	Полное наименование
shortName	string	Краткое наименование
legalAddress	string	Юридический адрес
factAddress	string	Фактический адрес
amenableName	string	ФИО ответственного
amenablePosition	string	Должность ответственного
accountantName	string	Бухгалтер
agreementWithIndividualsRequired	bool	Признак обязательности договора м/у этим ЮЛ и физ.лицами
taxSystems	null	СНО юридического лица
properties	map[string]Property	Свойства юридического лица. Проиндексированы по кодам свойств
Объект свойств юридического лица
Параметр	Тип	Описание
name	string	Идентификаторы описания основного реквизита
type	string	Тип юридического лица
searchType	uint	Поисковой тип
validation	string	Регулярное выражение для валидации
placeholder	string	Пример заполненного поля
nameHV	string	Локализованное название свойства
value	string	Заполненное значение
vertical-align:middle;
Внимание!
Поле value может отсутствовать в объекте ответа по причине его незаполненности.


Коды свойств юридических лиц по странам
Российская Федерация

Параметр	Описание
300	Основной государственный регистрационный номер ИП
301	Индивидуальный налоговый номер ИП
302	Код причины постановки на учёт
303	Основной государственный регистрационный номер юр.лица
304	Индивидуальный налоговый номер юр.лица
305	Сертификат индивидуального предпринимателя
Беларусь

Параметр	Описание
300	Основной государственный регистрационный номер ИП
301	Учётный номер плательщика (юр.лицо)
Украина

Параметр	Описание
300	Регистрационный номер в едином государственном реестре предприятий и организаций Украины
301	Индивидуальный налоговый номер
Казахстан

Параметр	Описание
300	Бизнес-идентификационный номер BG
301	Индивидуальный налоговый номер
302	Бизнес-идентификационный номер юр.лица
Латвия

Параметр	Описание
300	Реестровый номер предприятия (ИП)
301	Номер плательщика НДС (ИП)
302	Реестровый номер предприятия (компания)
303	Номер плательщика НДС (компания)
Литва

Параметр	Описание
300	Реестровый номер предприятия (ИП)
301	Номер плательщика НДС (ИП)
302	Реестровый номер предприятия (ИП)
303	Номер плательщика НДС (ИП)
Армения

Параметр	Описание
300	Учетный номер налогоплательщика, ИП
301	Учетный номер налогоплательщика, организация
Турция

Параметр	Описание
300	Налоговый номер (ИП)
301	Номер в центральной регистрационной системе (ИП)
302	Номер лицензии (юр.лицо)
303	Орган и дата выдачи лицензии (юр.лицо)
304	Налоговый номер (юрлицо)
Объединенные Арабские Эмираты (ОАЭ)

Параметр	Описание
300	Номер лицензии (ИП)
301	Орган и дата выдачи лицензии (ИП)
302	Номер лицензии (юр.лицо)
303	Орган и дата выдачи лицензии (юр.лицо)
Заказы поставщикам
Получение списка заказов
Операция: POST /cp/ts/supplierOrders/orders/list

Параметры запроса

Параметр	Тип	Описание
orderIds	[]uint	Список идентификаторов заказов
distributorIds	[]uint	Список идентификаторов прайс-листов
supplierIds	[]uint	Список идентификаторов контрагентов-поставщиков
sendStatuses	[]uint	Список статусов отправки заказа. Варианты: 1 - отправляется, 2 - отправлен, 3 - ошибка, 4 - отправка не требуется
createDateStart	string	Начальная дата в диапазоне поиска по дате создания заказа. Формат rfc3339.
createDateEnd	[]uint	Конечная дата в диапазоне поиска по дате создания заказа. Формат rfc3339.
sendDateStart	string	Начальная дата в диапазоне поиска по дате отправки заказа. Формат rfc3339.
sendDateEnd	[]uint	Конечная дата в диапазоне поиска по дате отправки заказа. Формат rfc3339.
clientOrderId	uint	Идентификатор заказа клиента
clientOrderNumber	string	Номер заказа клиента
limit	uint	Максимально количество объектов в выдаче
skip	uint	Пропуск объектов в выдаче
Получение списка позиций заказов
Операция: POST /cp/ts/supplierOrders/positions/list

Параметры запроса

Параметр	Тип	Описание
statuses	[]uint	Список статусов
orderId	uint	идентификатор заказа
distributorIds	[]uint	Список идентификаторов прайс-листов
supplierIds	[]uint	Список идентификаторов контрагентов-поставщиков
positionIds	[]uint	Список идентификаторов позиций
grPositionIds	[]uint	Список идентификаторов операций приемки
clientOrderId	uint	Идентификатор заказа клиента
clientOrderNumber	string	Номер заказа клиента
withoutOrder	bool	Только позиции без созданного заказа
withOrder	bool	Только позиции с созданным заказов
additionalInfo	string	Дополнительная информация: products - добавить инфу о товарах, coIds - добавить ссылки на связанные позции заказов клиентов
limit	uint	Максимально количество объектов в выдаче
skip	uint	Пропуск объектов в выдаче
Варианты значения поля Статус:

1 - Готова к созданию заказа

2 - Добавлена в заказ

3 - Подтвержден поставщиком

4 - В пути

5 - Прибыл

6 - Выполнен

7 - Отказ

Склад
Получение информации о ячейках склада
Операция: GET /cp/ts/wmsLocations/list

Параметры запроса

Параметр	Тип	Описание
userlogin	string	Имя api-администратора
userpsw	string	md5-хэш пароля api-администратора
Метод возвращает объект вида:

Поле	Описание
total	число найденных ячеек
list	список найденных ячеек



APIVINQU
Статья Обсуждение
Главная > APIVINQU
vertical-align:middle;
Внимание!
Данная статья предназначена для технических специалистов, обладающих, как минимум, начальными знаниями о принципах работы протокола HTTPS. Консультации по вопросам относящимся к стандартам HTTPS осуществляться не будут.
Содержание


API VINQU
Авторизация запросов
Значения параметров siteHash и accessHash вы можете взять в настройках интеграции своей учетной записи.

Поиск одного вин запроса
Операция: vinquery/info/:id
Метод: GET

id - Идентификатор запроса (Обязательный параметр)

Осуществляет поиск вин запроса по переданным параметрам.

Параметры запроса

Параметр	Описание
siteHash	хэш сайта, с которого был отправлен вин запрос (Обязательный).
accessHash	хэш доступа к API (Обязательный).
Пример запроса

https://publicapi.vinqu.com/vinquery/info/518346?siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&accessHash=12345
Поля ответа

Поле	Описание
_id	id запроса.
resellerId	id реселлера.
siteId	id сайта.
clientId	id клиента.
guestInfo	Информация о госте.
Информация о госте

Поле	Описание
name	имя.
phone	номер телефона.
email	почта.
Поле	Описание
expertId	id эксперта.
carInfo	информация о авто.
Информация о авто

Поле	Описание
brand	бренд.
model	модель.
modificationId	id модификации.
modification	модификация.
vin	вин номер.
frame	фрейм номер.
hp	лошадиные силы.
year	год выпуска.
extraParams	дополнительные параметры.
Поле	Описание
parts	массив с информацией о запрашиваемых запчастях следующего вида.
Информация о part

Поле	Описание
partId	уникальный id.
query	запрос пользователя для поиска.
offers	массив структур предложений, полученных от экспертов в следующем виде.
массив структур предложений, полученных от экспертов

Поле	Описание
offerId	уникальный id.
brand	бренд.
number	номер запчасти.
descr	описание.
quantity	количество.
expertId	id эксперта.
createdDateTime	timestamp создания предложения.
updatedDateTime	timestamp обновления предложения.
deletedDateTime	timestamp удаления предложения.
deleted	флаг удалено ли предложение.
Поле	Описание
createdDateTime	timestamp создания запроса.
updatedDateTime	timestamp обновления запроса.
assignedDateTime	timestamp назначения запроса на эксперта.
acceptedDateTime	timestamp принятия запроса экспертом.
completedDateTime	timestamp завершения запроса.
processingTime	время в секундах на выполнение запроса.
clientComment	комментарий клиента.
chat	массив структур с сообщениями в следующем виде.
массив структур с сообщениями

Поле	Описание
timestamp	отметка времени.
userId	глобальный id юзера в системе.
expertId	id эксперта, обрабатывающего запрос.
roleState	состояние запроса.
roleState_loc	состояние запроса в локализации (по умолчанию ru_RU - русская).
comment	текст сообщения.
Поле	Описание
images	массив строк с названием изображений.
status	статус запроса.
state	текущее состояние запроса.
Поиск новых сообщений во всех чатах клиента
Операция: vinquery/chatList
Метод: GET

Осуществляет поиск всех новых сообщений, максимум за последние 15 минут по всем чатам клиента. В случае отсутствия сообщений вернётся ошибка со статусом 404 и текстом `messages not found`

Параметры запроса

Параметр	Описание
siteHash	хэш сайта (Обязательный параметр)
accessHash	хэш доступа к API (Обязательный).
timestamp	отметка времени, начиная с которой показывать сообщения
locale	локализация (про умолчанию ru_RU) возможные значения (ru_RU , en_US)
Пример запроса

https://publicapi.vinqu.com/vinquery/chatList?siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&accessHash=123456&timestamp=1533642418
Поля ответа в случае успешно выполненного запроса

Поле	Описание
chatList	массив, у которого ключ - номер запроса, значение - массив структур chatItem.
структура chatItem

Поле	Описание
timestamp	отметка времени.
userId	id клиента.
expertId	id эксперта, обрабатывающего запрос.
roleState	состояние запроса.
roleState_loc	состояние запроса локализованное.
comment	текст сообщения.
Поля ответа в случае ошибки

Поле	Описание
Error	текст ошибки.
Поиск списка вин запросов
Операция: vinquery/list
Метод: GET

Осуществляет поиск списка вин запросов по переданным параметрам.

Параметры запроса

Параметр	Описание
siteHash	хэш сайта (Обязательный параметр)
accessHash	хэш доступа к API (Обязательный).
skip	начало выборки, по умолчанию 0
limit	сколько максимум выбрать. По умолчанию 30

Пример запроса https://publicapi.vinqu.com/vinquery/list?siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&accessHash=123456

Поля ответа

Поле	Описание
vinquery	Массив структур вин запроса (пример выше в vinquery/info).
total	Количество найденных запросов.
Добавить сообщение в чат
Операция: vinquery/addComment
Метод: POST

Осуществляет добавление нового сообщения в чат

Параметры запроса

Параметр	Описание
siteHash	хэш сайта (Обязательный)
accessHash	хэш доступа к API (Обязательный).
userId	id клиента
id	id запроса
comment	Текст сообщения
Пример запроса https://publicapi.vinqu.com/vinquery/addComment

POST параметры

userId=123&id=321&comment=Test query&siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&accessHash=123456
Поля ответа в случае успеха

Поле	Описание
Status	true или false
Поля ответа в случае ошибки

Поле	Описание
Error	Текст ошибки
Создание запроса
Операция: vinquery/add

Метод: POST

Осуществляет создание нового вин запроса

Параметры запроса

Параметр	Описание
siteHash	хэш сайта (Обязательный)
accessHash	хэш доступа к API (Обязательный).
clientId	id клиента
file	Прикрепленный файл изображения. В curl запросе file=@"/path_to_image/image.jpg". Формат изображения: jpg/png
carInfo	Информация об автомобиле. Ассоциативный массив следующего вида
Информация об автомобиле

Поле	Описание
brand	бренд.
model	модель.
modificationId	id модификации.
modification	модификация.
vin	вин номер.
frame	фрейм номер.
hp	лошадиные силы.
year	год выпуска.
Параметр	Описание
clientComment	Комментарий клиента.
parts	Массив запчастей из запроса клиента.
stockEnable	флаг 1 или 0, отправлять ли запрос на биржу.
guestInfo	Информация о госте.
Информация о госте

Поле	Описание
name	имя.
phone	номер телефона.
email	почта.
Пример запроса https://publicapi.vinqu.com/vinquery/add

POST параметры

clientId=123&carInfo[brand]=Luxgen&carInfo[vin]=222AAA11111111111&parts[]=test&parts[]=test1&clientComment=Test query&siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&stockEnable=1&accessHash=123456
Поля ответа в случае успеха

Поле	Описание
QueryId	id запроса
Поля ответа в случае ошибки

Поле	Описание
Error	Текст ошибки
Получение марок
Операция: brands/get

Метод: GET

Осуществляет поиск марок, подключённых сайту.

Параметры запроса

Параметр	Описание
hash	хэш сайта (Обязательный)
accessHash	хэш доступа к API (Обязательный).
Пример запроса https://publicapi.vinqu.com/brands/get?hash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&accessHash=123456

Поля ответа

Получает массив структур следующего вида

Поле	Описание
brand	Бренд.
price	Цена
enabled	включен или нет on или off
Выставить вин запрос на биржу
Операция: vinquery/on

Метод: POST

Осуществляет выставление вин запроса на биржу.

Параметры запроса

Параметр	Описание
id	id запроса
siteHash	хэш сайта (Обязательный)
accessHash	хэш доступа к API (Обязательный).
Пример запроса https://publicapi.vinqu.com/vinquery/on

POST параметры

id=999999999&siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea12&accessHash=123456
Поля ответа

Получает массив структур следующего вида

Поле	Описание
status	false.
Снять вин запрос с биржи
Операция: vinquery/off

Метод: POST

Осуществляет снятие вин запроса с биржи.

Параметры запроса

Параметр	Описание
id	id запроса
siteHash	хэш сайта (Обязательный)
accessHash	хэш доступа к API (Обязательный).
Пример запроса https://publicapi.vinqu.com/vinquery/off

POST параметры

id=123&siteHash=fa9839689336b1fc63c0e86a7cbeb558ce51ea2a&accessHash=123456
Поля ответа Получает массив структур следующего вида

Поле	Описание
status	false.





